<!DOCTYPE html>
<html lang="el" class="scroll-smooth">\n<!-- Admin build: set window.USE_SERVER_AI=true in production server -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VITRO CANVAS | Stained Glass Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        lead: '#1a1a1a',
                        ruby: '#b71c1c',
                        royal: '#0d47a1',
                        amber: 'var(--color-primary)', /* Dynamic Primary Color */
                        emerald: '#1b5e20',
                        glass: 'rgba(30, 30, 30, var(--glass-opacity))', /* Dynamic Opacity */
                    },
                    fontFamily: {
                        serif: ['Cinzel', 'serif'],
                        sans: ['Montserrat', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <script>window.USE_SERVER_AI = true;</script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --color-primary: #fbc02d;
            --glass-opacity: 0.6;
            --glow-start: #fbc02d;
            --glow-end: #b71c1c;
            --spin-speed: 60s;
        }

        body {
            background-color: #0f0f0f;
            color: #e0e0e0;
            font-family: 'Montserrat', sans-serif;
        }
        h1, h2, h3, .nav-link {
            font-family: 'Cinzel', serif;
        }
        .stained-glass-bg {
            background-image: radial-gradient(circle at 50% 50%, #2a2a2a 0%, #0f0f0f 100%);
        }
        .glass-card {
            background: rgba(30, 30, 30, var(--glass-opacity));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-color: color-mix(in srgb, var(--color-primary) 30%, transparent);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            border-color: var(--color-primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        /* Dynamic Animation for "Î¦Ï‰Ï„ÏŒÏ‚" */
        @keyframes glowing-text {
            0% { color: var(--glow-start); text-shadow: 0 0 10px var(--glow-start); } 
            100% { color: var(--glow-end); text-shadow: 0 0 20px var(--glow-end); } 
        }
        .glowing-letter {
            display: inline-block;
            animation: glowing-text 3s ease-in-out infinite alternate;
        }

        .hero-overlay {
            background: linear-gradient(to bottom, rgba(26,26,26,0.3), rgba(15,15,15,1));
        }

        /* --- SEAL ANIMATIONS --- */
        @keyframes draw-seal-lines {
            from { stroke-dashoffset: 2000; }
            to { stroke-dashoffset: 0; }
        }
        @keyframes fade-seal-content {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .seal-stroke {
            stroke-dasharray: 2000;
            stroke-dashoffset: 2000;
            animation: draw-seal-lines 5s cubic-bezier(0.33, 1, 0.68, 1) forwards;
        }
        
        .seal-content {
            opacity: 0;
            animation: fade-seal-content 3s ease-out 1.5s forwards; /* Delayed fade in */
        }

        /* NEW ANIMATION: 3D Spin on Vertical Axis */
        @keyframes spin-vertical {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        .animate-spin-vertical {
            animation: spin-vertical 4s linear infinite;
        }

        /* NEW ANIMATION: Random Glass Flickering */
        @keyframes glass-flicker {
            0%, 100% { opacity: 0.6; filter: brightness(1); }
            50% { opacity: 1; filter: brightness(1.5) saturate(1.2); }
        }

        /* NEW ANIMATION: V Logo Color Wave */
        @keyframes wave-gradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        .v-wave {
            background: linear-gradient(to right, #ffffff 20%, var(--color-primary) 50%, #ffffff 80%);
            background-size: 200% auto;
            color: #fff; /* Fallback */
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: wave-gradient 1.5s linear infinite;
        }

        /* Dynamic Seal Spin */
        .dynamic-spin {
            animation: spin var(--spin-speed) linear infinite;
        }
        /* SEAL ROTATION KEYFRAMES */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ADMIN EDITABLE STYLE UPDATED - SOLID GREEN BORDER */
        .admin-editable-img {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        
        /* GLOBAL ADMIN HOVER EFFECT FOR IMAGES */
        body.admin-mode img.admin-editable-img:hover {
            outline: 6px solid #10b981; /* Solid green border */
            outline-offset: -6px;
            opacity: 0.9;
            cursor: pointer;
            filter: brightness(1.1);
            z-index: 50; 
        }
        
        body.admin-mode .admin-editable-bg:hover {
            outline: 6px solid #10b981;
            outline-offset: -6px;
            cursor: pointer;
        }

        /* Visual cue for drag over - HIGH PRIORITY */
        .drag-over {
            outline: 8px solid var(--color-primary) !important;
            outline-offset: -8px !important;
            filter: brightness(1.2) sepia(0.2) !important;
            transform: scale(1.02);
            z-index: 100;
            transition: all 0.1s;
        }

        /* Modal scroll (Safari-friendly) */
        .modal-scroll {
            -webkit-overflow-scrolling: touch;
        }

        /* Statistics Bars */
        .stat-bar {
            transition: width 1s ease-out;
            width: 0%;
        }

        /* AI Loading Animation */
        .ai-loading {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        /* Maintenance View Styles */
        .maintenance-bg {
            background: #000;
            background-image: 
                linear-gradient(rgba(251, 192, 45, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(251, 192, 45, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        @keyframes hammer-swing {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-45deg); }
        }
        .animate-hammer {
            animation: hammer-swing 1s ease-in-out infinite;
            transform-origin: bottom left;
        }
        
        /* Marquee Animation */
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .animate-marquee {
            animation: marquee 25s linear infinite;
            white-space: nowrap;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1a1a; 
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-primary); 
            border-radius: 4px;
        }
        
        /* Line Clamp for Blog Excerpts */
        .line-clamp-6 {
            display: -webkit-box;
            -webkit-line-clamp: 6;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="stained-glass-bg relative">

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-5 right-5 bg-amber text-lead px-6 py-4 rounded-lg shadow-[0_0_20px_rgba(251,192,45,0.4)] transform translate-y-20 opacity-0 transition-all duration-300 z-[100] font-bold hidden flex items-center gap-3">
        <i class="fas fa-check-circle text-xl"></i>
        <span id="toast-message"></span>
    </div>

    <!-- AI Generating Toast (Special) -->
    <div id="ai-toast" class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-indigo-900/90 text-white px-8 py-4 rounded-full shadow-[0_0_30px_rgba(99,102,241,0.6)] z-[120] font-bold hidden flex items-center gap-3 border border-indigo-500/50 backdrop-blur-md">
        <i class="fas fa-sparkles text-yellow-300 ai-loading"></i>
        <span>Î¤Î¿ AI Î³ÏÎ¬Ï†ÎµÎ¹ Î½Î­Î¿ Î¬ÏÎ¸ÏÎ¿...</span>
    </div>
    
    <!-- Maintenance Banner for Admin -->
    <div id="maintenance-banner" class="hidden fixed top-0 left-0 w-full bg-red-600 text-white text-xs font-bold text-center py-1 z-[200]">
        <i class="fas fa-tools mr-2"></i> WEBSITE IN MAINTENANCE MODE (Visible only to Admin)
    </div>

    <!-- CONTACT MODAL POPUP -->
    <div id="contact-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="relative bg-[#1a1a1a] border border-amber/30 p-8 rounded-2xl w-full max-w-lg shadow-[0_0_50px_rgba(251,192,45,0.2)] animate-[fade-seal-content_0.3s_ease-out_forwards]">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-amber transition text-2xl"><i class="fas fa-times"></i></button>
            <div class="text-center mb-6">
                <i class="fas fa-envelope-open-text text-amber text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white" id="modal-quote-title">Î¦ÏŒÏÎ¼Î± Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬Ï‚</h2>
                <p class="text-gray-400 text-sm mt-2" id="modal-quote-sub">Î£Ï…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏƒÎ±Ï‚ ÎºÎ±Î¹ Î¸Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎ¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ±.</p>
            </div>
            <form id="quote-form" onsubmit="event.preventDefault(); submitContactForm(this, {closeModal:true});">
                <div class="space-y-4">
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1" id="q-label-name">ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿</label><input id="q-input-name" name="name" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="Ï€.Ï‡. Î“Î¹Î¬Î½Î½Î·Ï‚ Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1" id="q-label-email">Email</label><input id="q-input-email" name="email" type="email" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="email@example.com"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1" id="q-label-phone">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label><input id="q-input-phone" name="phone" type="tel" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="+30 69XX XXX XXX"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1" id="q-label-interest">Î•Î½Î´Î¹Î±Ï†Î­ÏÎ¿Î¼Î±Î¹ Î³Î¹Î±</label><select id="q-select-interest" name="interest" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"><option>Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ</option><option>Custom ÎšÏŒÏƒÎ¼Î·Î¼Î±</option><option>Î•Ï€Î¹ÏƒÎºÎµÏ…Î® / Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·</option><option>Î†Î»Î»Î¿</option></select></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1" id="q-label-message">ÎœÎ®Î½Ï…Î¼Î±</label><textarea id="q-textarea-message" name="message" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition h-24" placeholder="Î ÎµÏÎ¹Î³ÏÎ¬ÏˆÏ„Îµ Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ..."></textarea></div>
                    <button type="submit" class="w-full bg-amber text-lead font-bold py-3 rounded-lg hover:bg-white transition duration-300" id="q-submit">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î‘Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ADMIN LOGIN MODAL -->
    <div id="admin-login-modal" class="fixed inset-0 z-[210] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity" onclick="closeAdminLogin()"></div>
        <div class="relative bg-[#1a1a1a] border border-red-900/50 p-8 rounded-2xl w-full max-w-md shadow-2xl">
            <button onclick="closeAdminLogin()" class="absolute top-4 right-4 text-gray-400 hover:text-white transition text-xl"><i class="fas fa-times"></i></button>
            
            <!-- Login Form -->
            <div id="admin-login-form">
                <div class="text-center mb-6">
                    <i class="fas fa-user-lock text-ruby text-4xl mb-3"></i>
                    <h2 class="text-2xl font-serif font-bold text-white">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®</h2>
                </div>
                <form onsubmit="event.preventDefault(); attemptAdminLogin();">
                    <div class="mb-6">
                        <label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Î ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚</label>
                        <input id="admin-password" type="password" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-ruby transition text-center tracking-widest text-xl">
                    </div>
                    <button type="submit" class="w-full bg-ruby text-white font-bold py-3 rounded-lg hover:bg-red-800 transition duration-300">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚</button>
                </form>
            </div>

            <!-- Logout View -->
            <div id="admin-logout-view" class="hidden text-center">
                <i class="fas fa-user-check text-emerald text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white mb-2">Î£Ï…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Ï‚</h2>
                <p class="text-gray-400 mb-6">ÎˆÏ‡ÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®.</p>
                <div class="space-y-3">
                    <button onclick="closeAdminLogin()" class="w-full bg-black/40 border border-gray-600 text-white font-bold py-2 rounded-lg hover:bg-gray-800 transition duration-300">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
                    <button onclick="adminLogout()" class="w-full bg-ruby text-white font-bold py-2 rounded-lg hover:bg-red-800 transition duration-300">Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ADD/EDIT PRODUCT MODAL -->
    <div id="add-product-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity" onclick="closeAddProductModal()"></div>
        <div class="relative bg-[#1a1a1a] border border-amber/30 p-8 rounded-2xl w-full max-w-2xl shadow-[0_0_50px_rgba(251,192,45,0.2)] modal-scroll max-h-[90vh] overflow-y-auto">
            <button onclick="closeAddProductModal()" class="absolute top-4 right-4 text-gray-400 hover:text-amber transition text-2xl"><i class="fas fa-times"></i></button>
            <div class="text-center mb-6">
                <i class="fas fa-plus-circle text-amber text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white" id="modal-product-title">ÎÎ­Î¿ Î ÏÎ¿ÏŠÏŒÎ½</h2>
            </div>
            <form onsubmit="event.preventDefault(); handleAddProduct();">
                <input type="hidden" id="prod-id"> <!-- Hidden ID field for edits -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎŒÎ½Î¿Î¼Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚ (EL)</label><input id="prod-name" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Product Name (EN)</label><input id="prod-name-en" type="text" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="English name"></div>
                    <div class="col-span-1 md:col-span-2 flex items-center justify-end">
                        <button type="button" id="btn-prod-auto-en" onclick="autoTranslateProductToEn()" class="inline-flex items-center gap-2 text-xs font-bold uppercase tracking-wider px-3 py-2 rounded-full border border-amber/40 bg-amber/10 text-amber hover:bg-amber/20 transition">
                            <i class="fas fa-language"></i> Auto-translate to EN
                        </button>
                    </div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î¹Î¼Î® (â‚¬)</label><input id="prod-price" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="Ï€.Ï‡. 120.00"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label><select id="prod-category" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"><option value="stained-glass">Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ</option><option value="jewelry">ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±</option><option value="decor">Î”Î¹Î±ÎºÏŒÏƒÎ¼Î·ÏƒÎ·</option></select></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î”Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±</label><select id="prod-stock" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"><option value="in-stock">Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿</option><option value="made-to-order">ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚</option><option value="sold">Î Ï‰Î»Î®Î¸Î·ÎºÎµ</option></select></div>
                    <!-- NEW DISCOUNT FIELD -->
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎˆÎºÏ€Ï„Ï‰ÏƒÎ· (%)</label><input id="prod-discount" type="number" min="0" max="100" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="0"></div>
                    
                    <div class="col-span-1 md:col-span-2"><label class="block text-gray-400 text-xs uppercase font-bold mb-1">URL Î•Î¹ÎºÏŒÎ½Î±Ï‚</label><input id="prod-image" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="https://example.com/image.jpg"></div>

<div class="col-span-1 md:col-span-2">
  <label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Î•Î¹ÎºÏŒÎ½Î±Ï‚ (Drag & Drop)</label>
  <div id="prod-image-drop" class="w-full bg-black/30 border border-amber/30 rounded-lg p-4 text-center cursor-pointer hover:bg-black/40 transition">
    <input id="prod-image-file" type="file" accept="image/jpeg,image/png,image/webp" class="hidden">
    <div class="text-gray-400 text-sm">Î£ÏÏÎµ ÎµÎ´Ï Î¼Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î± Î® ÎºÎ¬Î½Îµ click Î³Î¹Î± ÎµÏ€Î¹Î»Î¿Î³Î® Î±ÏÏ‡ÎµÎ¯Î¿Ï…</div>
    <img id="prod-image-preview" src="" alt="" class="hidden mt-4 w-full max-h-56 object-contain rounded-lg border border-white/10 bg-black/20">
  </div>
</div>

                    <div class="col-span-1 md:col-span-2"><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® (EL)</label><textarea id="prod-desc" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition h-24"></textarea></div>
                    <div class="col-span-1 md:col-span-2"><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Description (EN)</label><textarea id="prod-desc-en" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition h-24" placeholder="English description"></textarea></div>
                </div>
                <button type="submit" class="w-full bg-amber text-lead font-bold py-3 rounded-lg hover:bg-white transition duration-300">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
            </form>
        </div>
    </div>

    <!-- ADD BLOG POST MODAL -->
    <div id="add-blog-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity" onclick="closeAddBlogModal()"></div>
        <div class="relative bg-[#1a1a1a] border border-emerald/30 p-8 rounded-2xl w-full max-w-3xl shadow-[0_0_50px_rgba(27,94,32,0.2)] modal-scroll max-h-[90vh] overflow-y-auto">
            <button onclick="closeAddBlogModal()" class="absolute top-4 right-4 text-gray-400 hover:text-emerald transition text-2xl"><i class="fas fa-times"></i></button>
            <div class="text-center mb-6">
                <i class="fas fa-pen-nib text-emerald text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white">ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿ Blog</h2>
            </div>
            <form onsubmit="event.preventDefault(); handleAddBlogPost();">
                <input type="hidden" id="blog-id">
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î¯Ï„Î»Î¿Ï‚ Î†ÏÎ¸ÏÎ¿Ï… (EL)</label><input id="blog-title" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition"></div>
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Post Title (EN)</label><input id="blog-title-en" type="text" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition" placeholder="English title"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± (EL)</label><input id="blog-date" type="text" placeholder="Ï€.Ï‡. 25 ÎœÎ±Ï 2026" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition"></div>
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Date (EN)</label><input id="blog-date-en" type="text" placeholder="e.g. Mar 25, 2026" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition"></div>
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">URL Î•Î¹ÎºÏŒÎ½Î±Ï‚</label><input id="blog-image" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition" placeholder="https://..."></div>

<div class="col-span-1 md:col-span-2">
  <label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Î•Î¹ÎºÏŒÎ½Î±Ï‚ (Drag & Drop)</label>
  <div id="blog-image-drop" class="w-full bg-black/30 border border-emerald/30 rounded-lg p-4 text-center cursor-pointer hover:bg-black/40 transition">
    <input id="blog-image-file" type="file" accept="image/jpeg,image/png,image/webp" class="hidden">
    <div class="text-gray-400 text-sm">Î£ÏÏÎµ ÎµÎ´Ï Î¼Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î± Î® ÎºÎ¬Î½Îµ click Î³Î¹Î± ÎµÏ€Î¹Î»Î¿Î³Î® Î±ÏÏ‡ÎµÎ¯Î¿Ï…</div>
    <img id="blog-image-preview" src="" alt="" class="hidden mt-4 w-full max-h-56 object-contain rounded-lg border border-white/10 bg-black/20">
  </div>
</div>

                    </div>
                    <div class="flex items-center justify-end mt-1">
                        <button type="button" id="btn-blog-auto-en" onclick="autoTranslateBlogToEn()" class="inline-flex items-center gap-2 text-xs font-bold uppercase tracking-wider px-3 py-2 rounded-full border border-emerald/40 bg-emerald/10 text-emerald hover:bg-emerald/20 transition">
                            <i class="fas fa-language"></i> Auto-translate to EN
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ (EL, HTML ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹)</label><textarea id="blog-content" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition h-48" placeholder="<p>Î“ÏÎ¬ÏˆÏ„Îµ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½ÏŒ ÏƒÎ±Ï‚ ÎµÎ´Ï...</p>"></textarea></div>
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Content (EN, HTML allowed)</label><textarea id="blog-content-en" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition h-48" placeholder="<p>Write your text here...</p>"></textarea></div>
                    </div>
                </div>
                <button type="submit" class="w-full bg-emerald text-white font-bold py-3 mt-6 rounded-lg hover:bg-emerald-700 transition duration-300">Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ· Î†ÏÎ¸ÏÎ¿Ï…</button>
            </form>
        </div>
    </div>

    <!-- UNDER CONSTRUCTION VIEW -->
    <div id="view-maintenance" class="hidden fixed inset-0 z-[200] maintenance-bg flex flex-col justify-between text-center">
        <div class="flex-grow flex flex-col items-center justify-center px-4">
            <div class="mb-8">
                <i class="fas fa-tools text-6xl text-amber animate-hammer"></i>
            </div>
            <h1 class="text-5xl md:text-7xl font-serif font-bold text-white mb-4 tracking-wider">UNDER CONSTRUCTION</h1>
            <p class="text-xl text-gray-400 font-sans max-w-2xl">
                We are crafting something beautiful. Our website is currently undergoing maintenance. Please check back soon.
            </p>
            <div class="mt-12">
                <div class="w-16 h-1 bg-amber mx-auto"></div>
            </div>
        </div>
        
        <!-- Footer for Maintenance Mode (Same as Main) -->
        <footer class="bg-transparent py-10 w-full">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <p class="text-gray-500 text-sm">
                    &copy; 2024 VITRO CANVAS. All rights reserved. | Created by Harris Eleftheriou
                    <span onclick="openAdminLogin()" class="cursor-pointer opacity-0 hover:opacity-100 ml-2 transition-opacity" title="Admin Login"><i class="fas fa-key text-gray-700"></i></span>
                </p>
            </div>
        </footer>
    </div>

    <!-- Navigation -->
    <nav id="main-nav" class="fixed w-full z-50 bg-lead/90 backdrop-blur-md border-b border-white/10 transition-transform duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="javascript:void(0)" onclick="navigateToSection(event, 'home')" class="flex-shrink-0 flex items-center gap-3 group cursor-pointer">
                    <div class="w-10 h-10 rounded-full border-2 border-amber flex items-center justify-center bg-lead relative overflow-hidden group-hover:border-white transition-colors">
                        <div class="absolute inset-0 bg-gradient-to-tr from-ruby via-amber to-royal opacity-50 group-hover:opacity-80 transition"></div>
                        <span class="relative font-serif font-bold text-xl v-wave">V</span>
                    </div>
                    <span class="text-xl font-bold tracking-widest text-white group-hover:text-amber transition-colors">VITRO <span class="text-amber group-hover:text-white transition-colors">CANVAS</span><span class="text-sm font-normal text-white ml-0.5">.gr</span></span>
                </a>
                
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center space-x-2 lg:space-x-6 whitespace-nowrap">
                        <a href="#home" onclick="navigateToSection(event, 'home')" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition" id="nav-home">Î‘ÏÏ‡Î¹ÎºÎ®</a>
                        <a href="#about" onclick="navigateToSection(event, 'about')" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition" id="nav-about">Î¤Î¿ Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿</a>
                        <a href="javascript:void(0)" onclick="showCatalog(event)" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition" id="nav-products">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</a>
                        <a href="javascript:void(0)" onclick="showBlog(event)" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition" id="nav-blog">Blog</a>
                        <a href="#workshops" onclick="navigateToSection(event, 'workshops')" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition" id="nav-workshops">Workshops</a>
                        <!-- Admin Link -->
                        <a href="javascript:void(0)" onclick="showAdminDashboard(event)" id="nav-admin-link" class="hidden text-emerald hover:text-white px-2 py-2 rounded-md text-sm font-bold transition border border-emerald/50 bg-emerald/10"><i class="fas fa-cogs mr-1"></i> Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·</a>
                        <!-- Logout Link -->
                        <a href="javascript:void(0)" onclick="adminLogout(event)" id="nav-logout-link" class="hidden text-ruby hover:text-white px-2 py-2 rounded-md text-sm font-bold transition"><i class="fas fa-sign-out-alt"></i></a>

                        <button type="button" id="lang-toggle" class="lang-flag-btn border border-white/10 bg-black/20 hover:bg-white/10 transition" aria-label="Î“Î»ÏÏƒÏƒÎ±" title="Language">
                            <span id="lang-flag" class="lang-flag" aria-hidden="true">ğŸ‡¬ğŸ‡·</span>
                        </button>

                        
                        <button onclick="openModal()" class="mr-64 bg-amber text-lead hover:bg-white px-4 py-2 rounded-md text-sm font-bold transition shadow-lg border border-amber/20" id="nav-contact-btn">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</button>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="-mr-2 flex md:hidden">
                    <button type="button" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div class="hidden md:hidden bg-lead border-t border-white/10" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#home" onclick="navigateToSection(event, 'home'); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium" id="mnav-home">Î‘ÏÏ‡Î¹ÎºÎ®</a>
                <a href="#about" onclick="navigateToSection(event, 'about'); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium" id="mnav-about">Î¤Î¿ Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿</a>
                <a href="javascript:void(0)" onclick="showCatalog(event); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium" id="mnav-products">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</a>
                <a href="javascript:void(0)" onclick="showBlog(event); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium" id="mnav-blog">Blog</a>
                <a href="#workshops" onclick="navigateToSection(event, 'workshops'); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium" id="mnav-workshops">Workshops</a>
                
                <a href="javascript:void(0)" onclick="showAdminDashboard(event); document.getElementById('mobile-menu').classList.add('hidden');" id="mobile-nav-admin-link" class="hidden block text-emerald px-3 py-2 rounded-md text-base font-bold">Î Î¯Î½Î±ÎºÎ±Ï‚ Î•Î»Î­Î³Ï‡Î¿Ï…</a>
                <a href="javascript:void(0)" onclick="adminLogout(event); document.getElementById('mobile-menu').classList.add('hidden');" id="mobile-nav-logout-link" class="hidden block text-ruby px-3 py-2 rounded-md text-base font-bold">ÎˆÎ¾Î¿Î´Î¿Ï‚</a>

                <div class="flex items-center gap-3 px-3 py-2">
                    <button type="button" id="m-lang-toggle" class="lang-flag-btn border border-white/10 bg-black/20 hover:bg-white/10 transition" aria-label="Î“Î»ÏÏƒÏƒÎ±" title="Language">
                        <span id="m-lang-flag" class="lang-flag" aria-hidden="true">ğŸ‡¬ğŸ‡·</span>
                    </button>
                    <span id="m-lang-caption" class="text-white/70 text-sm font-bold select-none">Î•Î»Î»Î·Î½Î¹ÎºÎ¬</span>
                </div>

                <button onclick="openModal()" class="block w-full text-left text-amber px-3 py-2 rounded-md text-base font-medium" id="mnav-contact-btn">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</button>
            </div>
        </div>
    </nav>

    <!-- WRAPPER FOR LANDING PAGE SECTIONS -->
    <div id="view-landing">
        <!-- Hero Section -->
        <section id="home" class="relative h-screen flex items-center justify-center overflow-hidden bg-lead pt-20">
            <!-- Background -->
            <div class="absolute inset-0 z-0">
                <svg class="w-full h-full object-cover opacity-[0.45]" preserveAspectRatio="xMidYMid slice" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- ... existing SVG code ... -->
                    <defs>
                        <filter id="glass-blur">
                            <feGaussianBlur in="SourceGraphic" stdDeviation="1" />
                        </filter>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#b71c1c;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#5c0000;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#0d47a1;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#002171;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad3" x1="100%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fbc02d;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#c49000;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad4" x1="0%" y1="100%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#1b5e20;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#003300;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <rect width="400" height="300" fill="#1a1a1a" />
                    <g stroke="#1a1a1a" stroke-width="4">
                        <path d="M150,100 L250,100 L200,180 Z" fill="url(#grad3)" style="animation: glass-flicker 3s ease-in-out infinite; animation-delay: 0s;" />
                        <path d="M0,0 L150,100 L100,200 L0,300 L0,0 Z" fill="url(#grad2)" opacity="0.8" style="animation: glass-flicker 4s ease-in-out infinite; animation-delay: 1.2s;" />
                        <path d="M250,100 L400,0 L400,300 L300,200 Z" fill="url(#grad1)" opacity="0.8" style="animation: glass-flicker 3.5s ease-in-out infinite; animation-delay: 2.5s;" />
                        <path d="M0,0 L400,0 L250,100 L150,100 Z" fill="#1a237e" opacity="0.6" style="animation: glass-flicker 4.5s ease-in-out infinite; animation-delay: 0.5s;" />
                        <path d="M100,200 L200,180 L300,200 L200,300 Z" fill="url(#grad4)" style="animation: glass-flicker 3.8s ease-in-out infinite; animation-delay: 3s;" />
                        <path d="M0,300 L100,200 L200,300 Z" fill="#b71c1c" opacity="0.5" style="animation: glass-flicker 2.5s ease-in-out infinite; animation-delay: 1.5s;" />
                        <path d="M400,300 L300,200 L200,300 Z" fill="#0d47a1" opacity="0.5" style="animation: glass-flicker 3.2s ease-in-out infinite; animation-delay: 0.8s;" />
                        <path d="M150,100 L100,200 L200,180 Z" fill="#f57f17" opacity="0.7" style="animation: glass-flicker 2s ease-in-out infinite; animation-delay: 1s;" />
                        <path d="M250,100 L300,200 L200,180 Z" fill="#f57f17" opacity="0.7" style="animation: glass-flicker 2.8s ease-in-out infinite; animation-delay: 2s;" />
                    </g>
                    <rect width="400" height="300" fill="url(#grad3)" opacity="0.05" style="mix-blend-mode: overlay;" />
                </svg>
            </div>
            <div class="hero-overlay absolute inset-0 z-10 pointer-events-none"></div>
        
            <!-- NEW MARQUEE PROMO TEXT - Positioned here -->
            <div id="hero-promo-text" class="hidden absolute top-20 left-0 w-full z-30 bg-black/5 overflow-hidden py-1 border-b border-white/5 backdrop-blur-sm">
                <div class="animate-marquee whitespace-nowrap text-ruby font-bold text-xs tracking-widest inline-block"><span id="promo-marquee"></span></div>
            </div>

            <div class="relative z-20 text-center px-4 mt-8">
                <div class="mb-6 inline-block animate-pulse">
                    <i class="fas fa-gem text-amber text-5xl animate-spin-vertical"></i>
                </div>
                <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 tracking-wider drop-shadow-lg" id="editable-hero-title">
                    Î— Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… 
                    <span class="inline-block">
                        <span class="glowing-letter" style="animation-delay: 0s;">Î¦</span><span class="glowing-letter" style="animation-delay: 0.2s;">Ï‰</span><span class="glowing-letter" style="animation-delay: 0.4s;">Ï„</span><span class="glowing-letter" style="animation-delay: 0.6s;">ÏŒ</span><span class="glowing-letter" style="animation-delay: 0.8s;">Ï‚</span>
                    </span>
                </h1>
                <p class="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mb-10 font-serif italic tracking-wide" id="editable-hero-desc">
                    Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î± Î²Î¹Ï„ÏÏŒ, Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ ÎºÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ­Ï‚ Î»ÏÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î¼ÎµÏ„Î±Î¼Î¿ÏÏ†ÏÎ½Î¿Ï…Î½ Ï„Î¿Î½ Ï‡ÏÏÎ¿ ÏƒÎ±Ï‚.
                </p>
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <button onclick="showCatalog(event)" class="bg-amber text-lead px-8 py-3 rounded-full font-bold hover:bg-white transition duration-300 shadow-[0_0_20px_rgba(251,192,45,0.4)]" id="hero-btn-collection">
                        Î”ÎµÎ¯Ï„Îµ Ï„Î· Î£Ï…Î»Î»Î¿Î³Î®
                    </button>
                    <button onclick="openModal()" class="border border-white/30 backdrop-blur-sm text-white px-8 py-3 rounded-full font-bold hover:bg-white/10 transition duration-300" id="hero-btn-quote">
                        Î–Î·Ï„Î®ÏƒÏ„Îµ Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬
                    </button>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 bg-lead">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                    <div class="relative flex justify-center items-center">
                        <svg class="w-full max-w-[500px] h-auto dynamic-spin drop-shadow-2xl opacity-40" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
                            <!-- ... existing Seal SVG code ... -->
                            <defs>
                                <path id="textCircleTop" d="M 70,250 A 180,180 0 1,1 430,250" />
                                <path id="textCircleBottom" d="M 430,250 A 180,180 0 0,1 70,250" />
                                <!-- UPDATED EMBOSS FILTER AND GOLD GRADIENT -->
                                <filter id="emboss-gloss" x="-50%" y="-50%" width="200%" height="200%">
                                    <feGaussianBlur in="SourceAlpha" stdDeviation="2" result="blur"/>
                                    <feOffset in="blur" dx="2" dy="2" result="offsetBlur"/>
                                    <feSpecularLighting in="blur" surfaceScale="5" specularConstant="0.75" specularExponent="20" lighting-color="#ffffff" result="specOut">
                                        <fePointLight x="-5000" y="-10000" z="20000"/>
                                    </feSpecularLighting>
                                    <feComposite in="specOut" in2="SourceAlpha" operator="in" result="specOut"/>
                                    <feComposite in="SourceGraphic" in2="specOut" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="litPaint"/>
                                    <feMerge>
                                        <feMergeNode in="offsetBlur"/>
                                        <feMergeNode in="litPaint"/>
                                    </feMerge>
                                </filter>
                                <linearGradient id="gold-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stop-color="#bf953f" />
                                    <stop offset="50%" stop-color="#fcf6ba" />
                                    <stop offset="100%" stop-color="#b38728" />
                                </linearGradient>
                            </defs>
                            <!-- UPDATED CIRCLES AND TEXT WITH GOLD GRADIENT AND FILTER -->
                            <circle cx="250" cy="250" r="240" fill="none" stroke="url(#gold-grad)" stroke-width="2" class="seal-stroke" filter="url(#emboss-gloss)"/>
                            <circle cx="250" cy="250" r="230" fill="none" stroke="url(#gold-grad)" stroke-width="8" stroke-dasharray="10, 5" class="seal-content" filter="url(#emboss-gloss)"/>
                            <circle cx="250" cy="250" r="220" fill="none" stroke="url(#gold-grad)" stroke-width="2" class="seal-stroke" filter="url(#emboss-gloss)"/>
                            <circle cx="250" cy="250" r="220" fill="#fbc02d" fill-opacity="0.05" />
                            
                            <text fill="url(#gold-grad)" font-family="'Cinzel', serif" font-size="55" font-weight="bold" letter-spacing="10" class="seal-content" filter="url(#emboss-gloss)">
                                <textPath href="#textCircleTop" startOffset="50%" text-anchor="middle">
                                    VITRO CANVAS
                                </textPath>
                            </text>
                            <text fill="url(#gold-grad)" font-family="'Montserrat', sans-serif" font-size="24" font-weight="300" letter-spacing="8" class="seal-content" filter="url(#emboss-gloss)">
                                <textPath href="#textCircleBottom" startOffset="50%" text-anchor="middle">
                                    HANDMADE IN THESSALONIKI
                                </textPath>
                            </text>
                            <circle cx="250" cy="250" r="130" fill="none" stroke="url(#gold-grad)" stroke-width="3" class="seal-stroke" filter="url(#emboss-gloss)"/>
                            <g transform="translate(250, 250)">
                                <path d="M0,-110 L25,-25 L110,0 L25,25 L0,110 L-25,25 L-110,0 L-25,-25 Z" fill="none" stroke="url(#gold-grad)" stroke-width="2" class="seal-stroke" filter="url(#emboss-gloss)"/>
                                <path d="M0,-110 L0,110 M-110,0 L110,0" stroke="url(#gold-grad)" stroke-width="1" class="seal-stroke" filter="url(#emboss-gloss)"/>
                                <circle cx="0" cy="0" r="8" fill="url(#gold-grad)" class="seal-content" filter="url(#emboss-gloss)"/>
                                <path d="M0,-110 Q40,-40 110,0 Q40,40 0,110 Q-40,40 -110,0 Q-40,-40 0,-110" fill="none" stroke="url(#gold-grad)" stroke-width="1" opacity="0.6" class="seal-stroke" filter="url(#emboss-gloss)"/>
                                <text x="0" y="-45" text-anchor="middle" fill="url(#gold-grad)" font-family="'Cinzel', serif" font-size="20" font-weight="bold" class="seal-content" filter="url(#emboss-gloss)">EST.</text>
                                <text x="0" y="65" text-anchor="middle" fill="url(#gold-grad)" font-family="'Cinzel', serif" font-size="24" font-weight="bold" class="seal-content" filter="url(#emboss-gloss)">2024</text>
                            </g>
                        </svg>
                    </div>
                    <div>
                        <h2 id="about-title" class="text-3xl md:text-4xl font-bold text-white mb-6">Î£Ï‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î· <span class="text-amber">Vitro Canvas</span></h2>
                        <div id="editable-about-text">
                            <p id="about-p1" class="text-gray-400 mb-6 leading-relaxed">
                                Î¤Î¿ ÎµÏÎ³Î±ÏƒÏ„Î®ÏÎ¹ÏŒ Î¼Î±Ï‚ ÏƒÏ„Î· ÎÎ­Î± ÎšÎµÏÎ±ÏƒÎ¹Î¬ ÏƒÏ…Î½Î´Ï…Î¬Î¶ÎµÎ¹ Ï„Î·Î½ Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ® Î´ÎµÎ¾Î¹ÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î· ÏƒÏÎ³Ï‡ÏÎ¿Î½Î· Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ®. ÎŸÎ½Î¿Î¼Î¬Î¶Î¿Î¼Î±Î¹ <strong class="text-white">Î§Î¬ÏÎ·Ï‚ Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î¿Ï…</strong> ÎºÎ±Î¹ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Î¼Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î· Ï€Î±ÏÎ¿Ï‡Î® Î»ÏÏƒÎµÏ‰Î½ Î³Ï…Î±Î»Î¹Î¿Ï Ï…ÏˆÎ·Î»Î®Ï‚ Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ®Ï‚ Î³Î¹Î± Î¹Î´Î¹ÏÏ„ÎµÏ‚ ÎºÎ±Î¹ ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚.
                            </p>
                            <p id="about-p2" class="text-gray-400 mb-8 leading-relaxed">
                                Î‘Ï€ÏŒ Ï„Î·Î½ ÎºÎ»Î±ÏƒÎ¹ÎºÎ® Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î¼Î¿Î»ÏÎ²Î´Î¿Ï… Î¼Î­Ï‡ÏÎ¹ Ï„Î·Î½ Î»ÎµÏ€Ï„ÎµÏ€Î¯Î»ÎµÏ€Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Tiffany, ÎºÎ¬Î¸Îµ Î­ÏÎ³Î¿ ÎµÎ¯Î½Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ, ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î¿ Î³Î¹Î± Î½Î± Ï€Î±Î¯Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Ï†Ï‰Ï‚ ÎºÎ±Î¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï„Î¼ÏŒÏƒÏ†Î±Î¹ÏÎ±.
                            </p>
                        </div>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="p-4 border border-white/10 rounded-lg">
                                <i class="fas fa-hand-holding-heart text-ruby text-2xl mb-2"></i>
                                <h4 id="about-badge-1" class="font-bold text-sm">Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î¿</h4>
                            </div>
                            <div class="p-4 border border-white/10 rounded-lg">
                                <i class="fas fa-history text-royal text-2xl mb-2"></i>
                                <h4 id="about-badge-2" class="font-bold text-sm">Î”Î¹Î±Ï‡ÏÎ¿Î½Î¹ÎºÏŒ</h4>
                            </div>
                            <div class="p-4 border border-white/10 rounded-lg">
                                <i class="fas fa-tools text-emerald text-2xl mb-2"></i>
                                <h4 id="about-badge-3" class="font-bold text-sm">Custom</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Preview -->
        <section id="services" class="py-20 bg-[#121212]">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <h2 id="services-title" class="text-3xl md:text-4xl font-bold text-white mb-4">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯ÎµÏ‚ & Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚</h2>
                    <div class="w-24 h-1 bg-amber mx-auto"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Products/Services Images - Now Drop Zones -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-1" onclick="handleImageClick(this, 'static', 'img-service-1')" src="https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=800&q=65" alt="Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-1" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Vitro+Art';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 id="service-1-title" class="text-xl font-bold text-white mb-2">Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ</h3>
                            <p id="service-1-desc" class="text-gray-400 text-sm mb-4">Î Î±ÏÎ¬Î¸Ï…ÏÎ±, Ï†ÎµÎ³Î³Î¯Ï„ÎµÏ‚ ÎºÎ±Î¹ Ï€ÏŒÏÏ„ÎµÏ‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Ï€Î¿Ï… Î±Î»Î»Î¬Î¶Î¿Ï…Î½ Ï„Î·Î½ ÏŒÏˆÎ· Ï„Î¿Ï… ÎºÏ„Î¹ÏÎ¯Î¿Ï….</p>
                            <a href="javascript:void(0)" onclick="showCatalog(event)" class="text-amber text-sm font-bold hover:underline" id="service-1-link">Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                    <!-- Product 2 -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-2" onclick="handleImageClick(this, 'static', 'img-service-2')" src="https://images.unsplash.com/photo-jQdj6IEPbnc?auto=format&fit=crop&w=800&q=65" alt="ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-2" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Glass+Jewelry';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 id="service-2-title" class="text-xl font-bold text-white mb-2">ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±</h3>
                            <p id="service-2-desc" class="text-gray-400 text-sm mb-4">ÎœÎ¿Î½Î±Î´Î¹ÎºÎ¬ Ï‡ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î± ÎºÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î±Î¾ÎµÏƒÎ¿Ï…Î¬Ï Î±Ï€ÏŒ Î³Ï…Î±Î»Î¯ Î³Î¹Î± Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹Ï‚.</p>
                            <a href="javascript:void(0)" onclick="showCatalog(event)" class="text-amber text-sm font-bold hover:underline" id="service-2-link">Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                    <!-- Product 3 -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-3" onclick="handleImageClick(this, 'static', 'img-service-3')" src="https://images.unsplash.com/photo-JAQmddE76RY?auto=format&fit=crop&w=800&q=65" alt="Suncatchers" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-3" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Suncatchers';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 id="service-3-title" class="text-xl font-bold text-white mb-2">Suncatchers & Decor</h3>
                            <p id="service-3-desc" class="text-gray-400 text-sm mb-4">ÎœÎ¹ÎºÏÎ¬ Î´Î¹Î±ÎºÎ¿ÏƒÎ¼Î·Ï„Î¹ÎºÎ¬, Ï†Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ Tiffany ÎºÎ±Î¹ ÎºÎ±Î¸ÏÎ­Ï†Ï„ÎµÏ‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ Î³Ï‰Î½Î¹Î¬.</p>
                            <a href="javascript:void(0)" onclick="showCatalog(event)" class="text-amber text-sm font-bold hover:underline" id="service-3-link">Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                    <!-- Service 4 -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-4" onclick="handleImageClick(this, 'static', 'img-service-4')" src="https://images.unsplash.com/photo-REEUPkG0WoU?auto=format&fit=crop&w=800&q=65" alt="Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-4" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Restoration';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 id="service-4-title" class="text-xl font-bold text-white mb-2">Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ· & Î‘Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</h3>
                            <p id="service-4-desc" class="text-gray-400 text-sm mb-4">Î•Î¾ÎµÎ¹Î´Î¹ÎºÎµÏ…Î¼Î­Î½Î· ÎµÏ€Î¹ÏƒÎºÎµÏ…Î® Ï€Î±Î»Î±Î¹ÏÎ½ Î²Î¹Ï„ÏÏŒ ÏƒÎµ Î½ÎµÎ¿ÎºÎ»Î±ÏƒÎ¹ÎºÎ¬ ÎºÎ±Î¹ ÎµÎºÎºÎ»Î·ÏƒÎ¯ÎµÏ‚.</p>
                            <a href="javascript:void(0)" onclick="openModal()" class="text-amber text-sm font-bold hover:underline" id="service-4-link">Î–Î·Ï„Î®ÏƒÏ„Îµ ÎµÎºÏ„Î¯Î¼Î·ÏƒÎ· <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Workshops Section -->
        <section id="workshops" data-id="workshops-bg" class="admin-editable-bg py-20 relative bg-fixed bg-cover bg-center" onclick="handleImageClick(this, 'static', 'workshops-bg')" style="background-image: url('https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=1920&q=65');">
            <div class="absolute inset-0 bg-lead/90 pointer-events-none"></div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 pointer-events-none">
                <div class="flex flex-col md:flex-row items-center justify-between gap-10">
                    <div class="md:w-1/2 pointer-events-auto">
                        <h2 id="workshops-title" class="text-3xl md:text-5xl font-bold text-white mb-6">ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î·Î½ Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… Î’Î¹Ï„ÏÏŒ</h2>
                        <p id="workshops-desc" class="text-gray-300 text-lg mb-8">
                            Î”Î¹Î¿ÏÎ³Î±Î½ÏÎ½Î¿Ï…Î¼Îµ Î´Î¹Î®Î¼ÎµÏÎ± workshops Î³Î¹Î± Î±ÏÏ‡Î¬ÏÎ¹Î¿Ï…Ï‚. ÎœÎ¬Î¸ÎµÏ„Îµ Î½Î± ÎºÏŒÎ²ÎµÏ„Îµ, Î½Î± Ï„ÏÎ¿Ï‡Î¯Î¶ÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± ÎºÎ¿Î»Î»Î¬Ï„Îµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ±Ï‚ Î­ÏÎ³Î¿ Ï„Î­Ï‡Î½Î·Ï‚.
                        </p>
                        <!-- ... list ... -->
                        <ul class="space-y-4 mb-8">
                            <li class="flex items-center text-gray-300"><i class="fas fa-check text-amber mr-3"></i> <span id="workshops-li-1">ÎŒÎ»Î± Ï„Î± Ï…Î»Î¹ÎºÎ¬ Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹</span></li>
                            <li class="flex items-center text-gray-300"><i class="fas fa-check text-amber mr-3"></i> <span id="workshops-li-2">ÎŸÎ»Î¹Î³Î¿Î¼ÎµÎ»Î® Ï„Î¼Î®Î¼Î±Ï„Î±</span></li>
                            <li class="flex items-center text-gray-300"><i class="fas fa-check text-amber mr-3"></i> <span id="workshops-li-3">Î Î±Î¯ÏÎ½ÎµÏ„Îµ Ï„Î¿ Î­ÏÎ³Î¿ ÏƒÏ€Î¯Ï„Î¹ ÏƒÎ±Ï‚</span></li>
                        </ul>
                        <a id="workshops-cta" href="#contact" class="bg-ruby text-white px-8 py-3 rounded-full font-bold hover:bg-red-700 transition duration-300">
                            ÎšÎ»ÎµÎ¯ÏƒÏ„Îµ Î˜Î­ÏƒÎ· Î¤ÏÏÎ±
                        </a>
                    </div>
                    <div class="md:w-1/2 pointer-events-auto">
                        <div class="bg-white/5 p-2 rounded-lg backdrop-blur-sm border border-white/10">
                            <img id="img-workshops" onclick="handleImageClick(this, 'static', 'img-workshops')" src="https://images.unsplash.com/photo-aNdR7FKIg5w?auto=format&fit=crop&w=800&q=65" alt="Workshop Class" class="admin-editable-img rounded w-full" data-type="static" data-id="img-workshops" onerror="this.src='https://placehold.co/600x400/222/FFF?text=Workshop+Session';">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-20 bg-lead">
            <!-- ... existing contact content ... -->
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-white mb-8" id="contact-title">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</h2>
                        <p class="text-gray-400 mb-10" id="contact-desc">Î•Î½Î´Î¹Î±Ï†Î­ÏÎµÏƒÏ„Îµ Î³Î¹Î± Î¼Î¹Î± custom Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î® Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î± Î¼Î±Î¸Î®Î¼Î±Ï„Î±; Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÏ„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚.</p>
                        <div class="space-y-6">
                            <div class="flex items-start">
                                <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-amber text-xl flex-shrink-0"><i class="fas fa-map-marker-alt"></i></div>
                                <div class="ml-4"><h4 class="text-white font-bold" id="contact-info-address-label">Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·</h4><p class="text-gray-400">ÎÎ­Î± ÎšÎµÏÎ±ÏƒÎ¹Î¬, Î˜ÎµÏƒÏƒÎ±Î»Î¿Î½Î¯ÎºÎ·</p></div>
                            </div>
                            <div class="flex items-start">
                                <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-amber text-xl flex-shrink-0"><i class="fas fa-phone-alt"></i></div>
                                <div class="ml-4"><h4 class="text-white font-bold" id="contact-info-phone-label">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</h4><p class="text-gray-400" id="editable-phone">+30 6973 807 097</p></div>
                            </div>
                            <div class="flex items-start">
                                <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-amber text-xl flex-shrink-0"><i class="fas fa-envelope"></i></div>
                                <div class="ml-4"><h4 class="text-white font-bold" id="contact-info-email-label">Email</h4><p class="text-gray-400">info@vitrocanvas.gr</p></div>
                            </div>
                        </div>
                        <!-- ... social icons ... -->
                        <div class="mt-10 flex space-x-6">
                            <a href="#" class="text-gray-400 hover:text-amber text-2xl transition link-instagram"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="text-gray-400 hover:text-blue-600 text-2xl transition link-facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="text-gray-400 hover:text-red-600 text-2xl transition link-pinterest"><i class="fab fa-pinterest-p"></i></a>
                        </div>
                    </div>
                    <div class="glass-card p-8 rounded-2xl">
                        <form id="contact-form" onsubmit="event.preventDefault(); submitContactForm(this);">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div><label class="block text-gray-400 text-sm mb-2" id="c-label-name">ÎŒÎ½Î¿Î¼Î±</label><input id="c-input-name" name="name" type="text" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="Î¤Î¿ ÏŒÎ½Î¿Î¼Î¬ ÏƒÎ±Ï‚"></div>
                                <div><label class="block text-gray-400 text-sm mb-2" id="c-label-email">Email</label><input id="c-input-email" name="email" type="email" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="email@example.com"></div>
                            </div>
                            <div class="mb-6"><label class="block text-gray-400 text-sm mb-2" id="c-label-phone">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label><input id="c-input-phone" name="phone" type="tel" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="+30 69XX XXX XXX"></div>
                            <div class="mb-6"><label class="block text-gray-400 text-sm mb-2" id="c-label-subject">Î˜Î­Î¼Î±</label><select id="c-select-subject" name="interest" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition"><option>Î“ÎµÎ½Î¹ÎºÎ® Î•ÏÏÏ„Î·ÏƒÎ·</option><option>Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î’Î¹Ï„ÏÏŒ</option><option>ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±</option><option>Î•Ï€Î¹ÏƒÎºÎµÏ…Î®</option><option>Î£Ï…Î¼Î¼ÎµÏ„Î¿Ï‡Î® ÏƒÎµ Workshop</option></select></div>
                            <div class="mb-6"><label class="block text-gray-400 text-sm mb-2" id="c-label-message">ÎœÎ®Î½Ï…Î¼Î±</label><textarea id="c-textarea-message" name="message" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition h-32" placeholder="Î ÏÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î¼Îµ;"></textarea></div>
                            <button type="submit" class="w-full bg-amber text-lead font-bold py-4 rounded-lg hover:bg-white transition duration-300" id="c-submit">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎœÎ·Î½ÏÎ¼Î±Ï„Î¿Ï‚</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- PRODUCTS CATALOG VIEW (Hidden by default) -->
    <div id="view-catalog" class="hidden pt-32 pb-20 min-h-screen bg-lead">
        <!-- ... existing catalog code ... -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Back to Home (Catalog) -->
            <button type="button" onclick="showLanding(true)" class="mb-6 flex items-center text-amber hover:text-white transition font-bold" id="catalog-back-home">
              <i class="fas fa-arrow-left mr-2"></i>
              <span id="catalog-back-home-text">Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î·Î½ Î‘ÏÏ‡Î¹ÎºÎ®</span>
            </button>

            <div class="flex justify-between items-center mb-10">
                <div>
                    <h2 id="catalog-title" class="text-3xl md:text-4xl font-bold text-white">ÎšÎ±Ï„Î¬Î»Î¿Î³Î¿Ï‚ Î ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½</h2>
                    <div class="w-20 h-1 bg-amber mt-2"></div>
                </div>
                <!-- Admin Button (Shows in Dashboard instead) -->
            </div>

            <!-- Products Grid -->
            <div id="catalog-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Initial Products will be rendered here by JS -->
            </div>


            <!-- Product Details Box (opens when a product is clicked) -->
            <div id="product-details-box" class="hidden mt-10 glass-card rounded-2xl p-6 md:p-8 border border-amber/20">
                <div class="flex items-start justify-between gap-4 mb-6">
                    <div>
                        <h3 id="pd-name" class="text-2xl md:text-3xl font-serif font-bold text-white"></h3>
                        <div class="mt-3 flex flex-wrap items-center gap-3 text-sm">
                            <span id="pd-price" class="text-amber font-bold"></span>
                            <span id="pd-stock" class="px-3 py-1 rounded-full bg-black/40 border border-white/10 text-gray-200"></span>
                            <span id="pd-category" class="px-3 py-1 rounded-full bg-black/40 border border-white/10 text-gray-400"></span>
                        </div>
                    </div>
                    <button type="button" onclick="closeProductDetails()" class="text-gray-400 hover:text-amber transition text-2xl leading-none" title="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <img id="pd-image" src="" alt="" class="w-full max-h-[420px] object-contain rounded-xl border border-white/10 bg-black/20">
                    </div>
                    <div class="flex flex-col">
                        <h4 id="pd-desc-label" class="text-white font-bold mb-2">Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®</h4>
                        <div id="pd-desc" class="text-gray-300 leading-relaxed text-sm md:text-base"></div>

                        <div class="mt-6 pt-6 border-t border-white/10 flex flex-col gap-3">
                            <button type="button" onclick="openQuoteForCurrentProduct()" class="w-full bg-amber text-lead font-bold py-3 rounded-lg hover:bg-white transition duration-300">
                                <span id="pd-quote-btn-text">Request a Quote</span>
                            </button>
                            <button type="button" onclick="scrollToCatalogGrid()" class="w-full bg-black/40 text-white font-bold py-3 rounded-lg border border-white/10 hover:bg-white/5 transition duration-300">
                                <span id="pd-back-btn-text">Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW BLOG LIST VIEW (Hidden by default) -->
    <div id="view-blog" class="hidden pt-32 pb-20 min-h-screen bg-lead">
        <!-- ... existing blog list code ... -->
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Back to Home (Blog list) -->
            <button type="button" onclick="showLanding(true)" class="mb-6 flex items-center text-amber hover:text-white transition font-bold" id="blog-back-home">
              <i class="fas fa-arrow-left mr-2"></i>
              <span id="blog-back-home-text">Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î·Î½ Î‘ÏÏ‡Î¹ÎºÎ®</span>
            </button>

            <div class="flex justify-between items-end mb-16">
                <div class="text-center w-full relative">
                    <h2 id="blog-section-title" class="text-3xl md:text-4xl font-bold text-white mb-4">Î¤Î¿ Blog Î¼Î±Ï‚</h2>
                    <div class="w-24 h-1 bg-amber mx-auto"></div>
                    <p id="blog-section-sub" class="text-gray-400 mt-4 font-serif italic">Î™ÏƒÏ„Î¿ÏÎ¯Î±, Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ ÎºÎ±Î¹ Î½Î­Î± Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏŒÏƒÎ¼Î¿ Ï„Î¿Ï… Î³Ï…Î±Î»Î¹Î¿Ï.</p>
                </div>
            </div>

            <!-- Blog Timeline Grid (Populated by JS) -->
            <div id="blog-list-container" class="space-y-12">
                <!-- Blog posts will be injected here -->
            </div>
        </div>
    </div>

    <!-- NEW SINGLE BLOG POST VIEW (Hidden by default) -->
    <div id="view-blog-single" class="hidden pt-32 pb-20 min-h-screen bg-lead">
        <!-- ... existing single blog code ... -->
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Back Button -->
            <button onclick="showBlog(event)" class="mb-8 flex items-center text-amber hover:text-white transition font-bold">
                <i class="fas fa-arrow-left mr-2"></i> <span id="blog-back-text">Î Î¯ÏƒÏ‰ ÏƒÏ„Î¿ Blog</span>
            </button>

            <!-- Article Content (Populated by JS) -->
            <article id="blog-single-content" class="glass-card p-8 md:p-12 rounded-2xl border border-white/5">
                <!-- Content injected here -->
            </article>
        </div>
    </div>

    <!-- ADMIN DASHBOARD VIEW (NEW) -->
    <div id="view-admin-dashboard" class="hidden pt-32 pb-20 min-h-screen bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center mb-10">
                <div>
                    <h2 class="text-3xl md:text-4xl font-bold text-white"><i class="fas fa-tachometer-alt text-emerald mr-3"></i> Î Î¯Î½Î±ÎºÎ±Ï‚ Î•Î»Î­Î³Ï‡Î¿Ï…</h2>
                    <p class="text-gray-400 mt-2">Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï… ÎºÎ±Î¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚.</p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="bg-black/30 p-2 px-4 rounded-lg border border-white/10 text-right">
                        <div class="text-xs text-gray-500 uppercase font-bold">Status</div>
                        <div class="text-emerald font-bold"><i class="fas fa-circle text-xs mr-2"></i>Admin</div>
                    </div>
                    <div class="bg-black/30 p-2 px-4 rounded-lg border border-white/10 text-right" title="Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î¿Î½ server (Render Disk)">
                        <div class="text-xs text-gray-500 uppercase font-bold">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</div>
                        <div id="save-indicator" class="text-amber font-bold"><i class="fas fa-clock text-xs mr-2"></i>ÎŒÏ‡Î¹ Î±ÎºÏŒÎ¼Î±</div>
                    </div>
                    <button onclick="manualSaveNow(event)" class="bg-amber/20 border border-amber/50 text-amber hover:bg-amber hover:text-lead px-4 py-2 rounded-lg font-bold transition">
                        <i class="fas fa-save mr-2"></i> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Ï„ÏÏÎ±
                    </button>
                    <button onclick="adminLogout(event)" class="bg-ruby/20 border border-ruby/50 text-ruby hover:bg-ruby hover:text-white px-4 py-2 rounded-lg font-bold transition">
                        <i class="fas fa-sign-out-alt mr-2"></i> ÎˆÎ¾Î¿Î´Î¿Ï‚
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Quick Actions / Stats -->
                <div class="lg:col-span-1 space-y-8">
                    <!-- Stats Card Small -->
                    <div class="glass-card p-6 rounded-xl">
                        <h3 class="text-white font-bold mb-4 border-b border-white/10 pb-2">Î“ÏÎ®Î³Î¿ÏÎ· Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-black/40 p-4 rounded text-center">
                                <div class="text-3xl font-bold text-amber" id="stats-products">0</div>
                                <div class="text-xs text-gray-400">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</div>
                            </div>
                            <div class="bg-black/40 p-4 rounded text-center">
                                <div class="text-3xl font-bold text-emerald" id="stats-blog">0</div>
                                <div class="text-xs text-gray-400">Î†ÏÎ¸ÏÎ±</div>
                            </div>
                        </div>
                    </div>

                    <!-- Drag & Drop Info -->
                    <div class="bg-emerald/10 border border-emerald/30 p-6 rounded-xl" id="drop-zone-info">
                        <h3 class="text-emerald font-bold mb-2"><i class="fas fa-info-circle mr-2"></i> Drag & Drop</h3>
                        <p class="text-sm text-gray-300">
                            Î£ÏÏÎµÏ„Îµ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¿Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® ÏƒÎ±Ï‚ ÏƒÎµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ ÎµÎ¹ÎºÏŒÎ½Î± Ï„Î¿Ï… site Î³Î¹Î± Î±Î»Î»Î±Î³Î®.
                            <br><br>
                            <strong>Restore:</strong> Î£ÏÏÎµÏ„Îµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ <code>.json</code> ÎµÎ´Ï Î³Î¹Î± ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬.
                        </p>
                    </div>
                </div>

                <!-- Main Content Tabs -->
                <div class="lg:col-span-2">
                    <!-- Tabs -->
                    <div class="flex space-x-2 mb-6 overflow-x-auto">
                        <button onclick="switchAdminTab('products')" id="tab-btn-products" class="bg-amber text-lead px-4 md:px-6 py-2 rounded-t-lg font-bold">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</button>
                        <button onclick="switchAdminTab('blog')" id="tab-btn-blog" class="bg-gray-800 text-gray-400 px-4 md:px-6 py-2 rounded-t-lg font-bold hover:bg-gray-700 transition">Blog</button>
                        <button onclick="switchAdminTab('general')" id="tab-btn-general" class="bg-gray-800 text-gray-400 px-4 md:px-6 py-2 rounded-t-lg font-bold hover:bg-gray-700 transition">Î“ÎµÎ½Î¹ÎºÎ¬</button>
                        <button onclick="switchAdminTab('stats')" id="tab-btn-stats" class="bg-gray-800 text-gray-400 px-4 md:px-6 py-2 rounded-t-lg font-bold hover:bg-gray-700 transition">Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬</button>
                        <button onclick="switchAdminTab('system')" id="tab-btn-system" class="bg-gray-800 text-gray-400 px-4 md:px-6 py-2 rounded-t-lg font-bold hover:bg-gray-700 transition">Î£ÏÏƒÏ„Î·Î¼Î±</button>
                    </div>

                    <!-- Products Panel -->
                    <div id="admin-panel-products" class="glass-card p-6 rounded-b-xl rounded-tr-xl min-h-[500px]">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl text-white font-bold">Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½</h3>
                            <div class="flex gap-2">
                                <div class="flex items-center bg-black/40 rounded-lg px-2">
                                    <input type="number" id="global-discount" placeholder="%" min="0" max="100" class="bg-transparent text-white w-12 text-sm text-center focus:outline-none">
                                    <button type="button" onclick="applyGlobalDiscount()" class="text-xs bg-ruby text-white px-2 py-1 rounded ml-1 hover:bg-red-700 transition z-50 relative">ÎœÎ±Î¶Î¹ÎºÎ® ÎˆÎºÏ€Ï„Ï‰ÏƒÎ·</button>
                                </div>
                                <button onclick="openAddProductModal()" class="bg-emerald text-white px-4 py-2 rounded hover:bg-emerald-600 transition flex items-center gap-2 text-sm"><i class="fas fa-plus"></i> ÎÎ­Î¿</button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-gray-400 text-sm">
                                <thead class="bg-black/30 text-xs uppercase text-gray-500">
                                    <tr>
                                        <th class="p-3">Î•Î¹ÎºÏŒÎ½Î±</th>
                                        <th class="p-3">ÎŒÎ½Î¿Î¼Î±</th>
                                        <th class="p-3">Î¤Î¹Î¼Î®</th>
                                        <th class="p-3">ÎˆÎºÏ€Ï„.</th>
                                        <th class="p-3">Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-products-table">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Blog Panel -->
                    <div id="admin-panel-blog" class="hidden glass-card p-6 rounded-b-xl rounded-tr-xl min-h-[500px]">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl text-white font-bold">Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Blog</h3>
                            <button onclick="openAddBlogModal()" class="bg-emerald text-white px-4 py-2 rounded hover:bg-emerald-600 transition flex items-center gap-2"><i class="fas fa-plus"></i> ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-gray-400 text-sm">
                                <thead class="bg-black/30 text-xs uppercase text-gray-500">
                                    <tr>
                                        <th class="p-3">Î•Î¹ÎºÏŒÎ½Î±</th>
                                        <th class="p-3">Î¤Î¯Ï„Î»Î¿Ï‚</th>
                                        <th class="p-3">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</th>
                                        <th class="p-3">Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-blog-table">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- General Settings Panel (Updated with Live Preview) -->
                    <div id="admin-panel-general" class="hidden glass-card p-6 rounded-b-xl rounded-tr-xl min-h-[500px]">
                        <h3 class="text-xl text-white font-bold mb-6">Î“ÎµÎ½Î¹ÎºÎ­Ï‚ Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ & Î“ÏÎ±Ï†Î¹ÎºÎ¬</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Left Column: Controls -->
                            <form onsubmit="event.preventDefault(); saveGlobalSettings();" oninput="updateLivePreview()">
                                <div class="space-y-6">
                                    <!-- Contact Info -->
                                    <div class="space-y-4">
                                        <h4 class="text-amber font-bold text-sm uppercase border-b border-white/10 pb-2">Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î±</h4>
                                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î¯Ï„Î»Î¿Ï‚ Hero</label><input id="admin-hero-title" type="text" class="w-full bg-black/40 border border-gray-700 rounded py-2 px-3 text-white text-sm"></div>
                                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label><input id="admin-phone" type="text" class="w-full bg-black/40 border border-gray-700 rounded py-2 px-3 text-white text-sm"></div>
                                    </div>

                                    <!-- Graphics Vars -->
                                    <div class="space-y-4">
                                        <h4 class="text-amber font-bold text-sm uppercase border-b border-white/10 pb-2">Î“ÏÎ±Ï†Î¹ÎºÎ¬ (Live)</h4>
                                        <div class="grid grid-cols-2 gap-4">
                                            <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î’Î±ÏƒÎ¹ÎºÏŒ Î§ÏÏÎ¼Î±</label><input id="admin-color-primary" type="color" value="#fbc02d" class="w-full bg-transparent h-8 cursor-pointer"></div>
                                            <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î‘Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹Î± (0-1)</label><input id="admin-glass-opacity" type="number" step="0.1" min="0" max="1" value="0.6" class="w-full bg-black/40 border border-gray-700 rounded py-1 px-2 text-white text-sm"></div>
                                            <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Glow Start</label><input id="admin-glow-start" type="color" value="#fbc02d" class="w-full bg-transparent h-8 cursor-pointer"></div>
                                            <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Glow End</label><input id="admin-glow-end" type="color" value="#b71c1c" class="w-full bg-transparent h-8 cursor-pointer"></div>
                                            <div class="col-span-2"><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î±Ï‡ÏÏ„Î·Ï„Î± Animation (sec)</label><input id="admin-spin-speed" type="number" value="60" class="w-full bg-black/40 border border-gray-700 rounded py-1 px-2 text-white text-sm"></div>
                                        </div>
                                    </div>
                                </div>
                                <button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 mt-6 rounded hover:bg-blue-700 transition">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î¡Ï…Î¸Î¼Î¯ÏƒÎµÏ‰Î½</button>
                            </form>

                            <!-- Right Column: Live Preview Box -->
                            <div class="relative">
                                <h4 class="text-gray-400 text-xs uppercase font-bold mb-2">Î–Ï‰Î½Ï„Î±Î½Î® Î ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·</h4>
                                <!-- Preview Container (simulates the site bg) -->
                                <div class="stained-glass-bg p-6 rounded-xl border border-white/20 h-full flex flex-col items-center justify-center gap-6" id="preview-container">
                                    <!-- Sample Card -->
                                    <div class="glass-card p-4 rounded-lg w-full max-w-xs text-center">
                                        <h3 class="text-white font-serif font-bold text-lg mb-2">Î”ÎµÎ¯Î³Î¼Î± ÎšÎ¬ÏÏ„Î±Ï‚</h3>
                                        <p class="text-gray-400 text-xs mb-3">ÎˆÏ„ÏƒÎ¹ Î¸Î± Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Ï„Î¿ background ÎºÎ±Î¹ Ï„Î± Ï€ÎµÏÎ¹Î³ÏÎ¬Î¼Î¼Î±Ï„Î±.</p>
                                        <button class="bg-amber text-lead px-4 py-2 rounded-full font-bold text-xs hover:bg-white transition" style="background-color: var(--color-primary)">ÎšÎ¿Ï…Î¼Ï€Î¯ Î”ÎµÎ¯Î³Î¼Î±</button>
                                    </div>
                                    
                                    <!-- Glowing Text Sample -->
                                    <div class="text-2xl font-bold text-white tracking-widest text-center">
                                        <span class="glowing-letter" style="animation-delay: 0s;">T</span><span class="glowing-letter" style="animation-delay: 0.2s;">E</span><span class="glowing-letter" style="animation-delay: 0.4s;">X</span><span class="glowing-letter" style="animation-delay: 0.6s;">T</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics Panel (NEW) -->
                    <div id="admin-panel-stats" class="hidden glass-card p-6 rounded-b-xl rounded-tr-xl min-h-[500px]">
                        <h3 class="text-xl text-white font-bold mb-6">Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ¬ Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-black/40 p-6 rounded-xl border border-white/5 relative overflow-hidden">
                                <div class="absolute top-0 right-0 p-4 opacity-10 text-emerald text-6xl"><i class="fas fa-users"></i></div>
                                <h4 class="text-gray-400 text-sm uppercase">Online Î§ÏÎ®ÏƒÏ„ÎµÏ‚</h4>
                                <div class="text-4xl font-bold text-emerald mt-2 animate-pulse" id="stat-online-users">0</div>
                                <div class="text-xs text-gray-500 mt-1">Î•Î½ÎµÏÎ³Î¿Î¯ Ï„ÏÏÎ±</div>
                            </div>
                            <div class="bg-black/40 p-6 rounded-xl border border-white/5 relative overflow-hidden">
                                <div class="absolute top-0 right-0 p-4 opacity-10 text-amber text-6xl"><i class="fas fa-eye"></i></div>
                                <h4 class="text-gray-400 text-sm uppercase">Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ Î•Ï€Î¹ÏƒÎºÎ­ÏˆÎµÎ¹Ï‚</h4>
                                <div class="text-4xl font-bold text-white mt-2" id="stat-total-visits">0</div>
                                <div class="text-xs text-gray-500 mt-1">Î‘Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î®</div>
                            </div>
                            <div class="bg-black/40 p-6 rounded-xl border border-white/5 relative overflow-hidden">
                                <div class="absolute top-0 right-0 p-4 opacity-10 text-blue-500 text-6xl"><i class="fas fa-mouse-pointer"></i></div>
                                <h4 class="text-gray-400 text-sm uppercase">Clicks Î ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½</h4>
                                <div class="text-4xl font-bold text-blue-400 mt-2" id="stat-product-clicks">0</div>
                            </div>
                        </div>

                        <div class="bg-black/30 p-6 rounded-xl border border-white/10">
                            <h4 class="text-white font-bold mb-4">Î•Ï€Î¹ÏƒÎºÎµÏˆÎ¹Î¼ÏŒÏ„Î·Ï„Î± Î±Î½Î¬ Î£ÎµÎ»Î¯Î´Î±</h4>
                            <div class="space-y-4" id="stats-bars">
                                <!-- Bars injected by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- System/Backup Panel & AI Settings -->
                    <div id="admin-panel-system" class="hidden glass-card p-6 rounded-b-xl rounded-tr-xl min-h-[500px]">
                        <h3 class="text-xl text-white font-bold mb-6">Î£ÏÏƒÏ„Î·Î¼Î± & AI</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Maintenance Mode Toggle -->
                            <div class="bg-red-900/20 border border-red-500/30 p-6 rounded-xl col-span-2 md:col-span-1">
                                <h4 class="text-red-400 font-bold mb-4 flex items-center"><i class="fas fa-hard-hat mr-2"></i> Maintenance Mode</h4>
                                <p class="text-gray-400 text-sm mb-4">
                                    Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¿ Î³Î¹Î± Î½Î± ÎºÎ»ÎµÎ¯ÏƒÎµÏ„Îµ Ï„Î¿ site ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹ÏƒÎºÎ­Ï€Ï„ÎµÏ‚ (ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Î¼Î®Î½Ï…Î¼Î± "Under Construction"). Î•ÏƒÎµÎ¯Ï‚ Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÏ„Îµ Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·.
                                </p>
                                <div class="flex items-center gap-3">
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="maintenance-toggle" class="sr-only peer" onchange="toggleMaintenanceMode()">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"></div>
                                        <span class="ml-3 text-sm font-medium text-white" id="maintenance-status-text">Î‘Î½ÎµÎ½ÎµÏÎ³ÏŒ</span>
                                    </label>
                                </div>
                            </div>

                            <!-- AI Settings -->
                            <div class="bg-indigo-900/20 border border-indigo-500/30 p-6 rounded-xl col-span-2 md:col-span-1">
                                <h4 class="text-indigo-400 font-bold mb-4 flex items-center"><i class="fas fa-robot mr-2"></i> Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ Blog (Gemini AI)</h4>
                                <p class="text-gray-400 text-sm mb-4">
                                    Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ API Ï„Î¿Ï… Google Gemini. 
                                    <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-indigo-400 underline hover:text-indigo-300">Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ Î´Ï‰ÏÎµÎ¬Î½ ÎµÎ´Ï</a>.
                                </p>
                                
                                <div class="mb-4 relative">
                                    <label class="block text-gray-400 text-xs uppercase font-bold mb-1">Gemini API Key</label>
                                    <input id="gemini-api-key" type="password" class="w-full bg-black/40 border border-indigo-500/50 rounded py-2 px-3 text-white text-sm focus:border-indigo-400 focus:outline-none transition pr-10" placeholder="AIzaSy...">
                                    <button type="button" onclick="toggleKeyVisibility()" class="absolute right-3 top-8 text-gray-400 hover:text-white">
                                        <i class="fas fa-eye" id="eye-icon"></i>
                                    </button>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="saveGeminiKey(event)" class="bg-indigo-600 text-white px-4 py-2 rounded font-bold text-xs hover:bg-indigo-700 transition">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Key</button>
                                    <button onclick="forceAiBlogGeneration()" class="bg-indigo-800/50 text-indigo-200 border border-indigo-500/30 px-4 py-2 rounded font-bold text-xs hover:bg-indigo-800 transition">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î¤ÏÏÎ± (Test)</button>
                                </div>
                                <p class="text-gray-500 text-xs mt-3 italic">Î•Ï€ÏŒÎ¼ÎµÎ½Î· Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼Î­Î½Î·: <span id="next-ai-date" class="text-indigo-300">...</span></p>
                            </div>

                            <!-- Backup Restore -->
                            <div class="space-y-6 col-span-2">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div class="bg-black/40 p-6 rounded-lg border border-white/10">
                                        <h4 class="text-emerald font-bold mb-2">1. Î•Î¾Î±Î³Ï‰Î³Î® (Backup)</h4>
                                        <p class="text-gray-400 text-sm mb-4">ÎšÎ±Ï„ÎµÎ²Î¬ÏƒÏ„Îµ ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.</p>
                                        <button onclick="exportData()" class="bg-emerald text-white px-6 py-2 rounded font-bold hover:bg-emerald-600 transition"><i class="fas fa-download mr-2"></i> ÎšÎ±Ï„Î­Î²Î±ÏƒÎ¼Î±</button>
                                    </div>

                                    <div class="bg-black/40 p-6 rounded-lg border border-white/10 relative">
                                        <h4 class="text-amber font-bold mb-2">2. Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® (Restore)</h4>
                                        <p class="text-gray-400 text-sm mb-4">Î£ÏÏÎµÏ„Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ <code>.json</code> ÎµÎ´Ï Î® ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Ï„Î¿.</p>
                                        <!-- UPDATED INPUT TO RESET VALUE ON CLICK FOR RELOAD -->
                                        <input type="file" id="import-file" onclick="this.value=null" onchange="importData(this.files[0])" class="block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber file:text-lead hover:file:bg-white transition"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-black py-10 border-t border-white/10">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-gray-500 text-sm">
                &copy; 2024 VITRO CANVAS. All rights reserved. | Created by Harris Eleftheriou
                <!-- HIDDEN ADMIN TRIGGER -->
                <span onclick="openAdminLogin()" class="cursor-pointer opacity-0 hover:opacity-100 ml-2 transition-opacity" title="Admin Login"><i class="fas fa-key text-gray-700"></i></span>
            </p>
        </div>
    </footer>

    <script>

        // ===== Server-side AI proxy support (production-safe) =====
        // If true, the admin AI calls your own backend (/api/gemini/*) so the API key is NOT exposed in the browser.
        // Set window.USE_SERVER_AI = true when hosting with the included server.
        window.USE_SERVER_AI = window.USE_SERVER_AI ?? false;

        async function serverListModels() {
            const resp = await fetch('/api/gemini/models', { method: 'GET' });
            if (!resp.ok) {
                const err = await resp.json().catch(() => ({}));
                throw new Error(err?.error || `Î£Ï†Î¬Î»Î¼Î± server (models): ${resp.status}`);
            }
            return await resp.json();
        }

        async function serverGenerateContent(payload) {
            const resp = await fetch('/api/gemini/generate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            if (!resp.ok) {
                const err = await resp.json().catch(() => ({}));
                throw new Error(err?.error || `Î£Ï†Î¬Î»Î¼Î± server (generate): ${resp.status}`);
            }
            return await resp.json();
        }
        // ==========================================================

        async function callGeminiGenerate({ key, model, body }) {
            if (window.USE_SERVER_AI) {
                // body should be the JSON payload you would send to Gemini
                return await serverGenerateContent({ model, body });
            }
            const resp = await callGeminiGenerate({ key, model, body: body });
            if (!resp.ok) {
                const err = await resp.json().catch(() => ({}));
                throw new Error(err?.error?.message || `Î£Ï†Î¬Î»Î¼Î± Google (generate): ${resp.status}`);
            }
            return await resp.json();
        }

        function showToast(message, opts = {}) {
    const toast = document.getElementById('toast');
    const msgElement = document.getElementById('toast-message');
    const iconEl = toast ? toast.querySelector('i') : null;

    const {
        sticky = false,
        duration = 3000,
        iconClass = 'fas fa-check-circle text-xl'
    } = opts || {};

    if (!toast || !msgElement) return;

    msgElement.textContent = message;

    if (iconEl) {
        iconEl.className = iconClass;
    }

    // Show
    toast.classList.remove('hidden');
    setTimeout(() => { toast.classList.remove('translate-y-20', 'opacity-0'); }, 10);

    // Auto-hide unless sticky
    if (!sticky) {
        setTimeout(() => hideToast(), duration);
    }
}

function updateToast(message, opts = {}) {
    const toast = document.getElementById('toast');
    const msgElement = document.getElementById('toast-message');
    const iconEl = toast ? toast.querySelector('i') : null;
    if (!toast || !msgElement) return;

    msgElement.textContent = message;

    if (opts && opts.iconClass && iconEl) {
        iconEl.className = opts.iconClass;
    }

    // Ensure visible
    toast.classList.remove('hidden');
    toast.classList.remove('translate-y-20', 'opacity-0');
}

function hideToast() {
    const toast = document.getElementById('toast');
    if (!toast) return;
    toast.classList.add('translate-y-20', 'opacity-0');
    setTimeout(() => { toast.classList.add('hidden'); }, 300);
}

        // ===== Auto-translate (Gemini via server) =====
        function _vcExtractGeminiText(resp) {
            try {
                const cand = resp?.candidates?.[0];
                const parts = cand?.content?.parts;
                if (Array.isArray(parts)) {
                    return parts.map(p => p?.text || '').join('').trim();
                }
            } catch (e) {}
            return '';
        }

        function _vcParseJsonLoose(text) {
            if (!text) throw new Error('Empty model response.');
            const cleaned = String(text)
                .replace(/```(?:json)?/gi, '')
                .replace(/```/g, '')
                .trim();
            const first = cleaned.indexOf('{');
            const last = cleaned.lastIndexOf('}');
            if (first === -1 || last === -1 || last <= first) throw new Error('No JSON object found in model response.');
            const jsonStr = cleaned.slice(first, last + 1);
            return JSON.parse(jsonStr);
        }

        function _vcSetBtnBusy(btn, busy, busyText) {
            if (!btn) return;
            if (busy) {
                if (!btn.dataset._label) btn.dataset._label = btn.innerHTML;
                btn.disabled = true;
                btn.classList.add('opacity-60', 'cursor-not-allowed');
                btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${busyText || 'Translating...'}`;
            } else {
                btn.disabled = false;
                btn.classList.remove('opacity-60', 'cursor-not-allowed');
                if (btn.dataset._label) btn.innerHTML = btn.dataset._label;
            }
        }

        async function _vcGeminiJson(prompt, { model = 'gemini-2.5-flash', maxOutputTokens = 1024 } = {}) {
            const body = {
                contents: [{ role: "user", parts: [{ text: prompt }] }],
                generationConfig: { temperature: 0.2, topP: 0.95, maxOutputTokens }
            };
            const resp = await serverGenerateContent({ model, body });
            const text = _vcExtractGeminiText(resp);
            return _vcParseJsonLoose(text);
        }

        async function autoTranslateProductToEn() {
            const btn = document.getElementById('btn-prod-auto-en');
            try {
                const nameEl = (document.getElementById('prod-name')?.value || '').trim();
                const descEl = (document.getElementById('prod-desc')?.value || '').trim();
                if (!nameEl && !descEl) { showToast('Î“ÏÎ¬ÏˆÎµ Ï€ÏÏÏ„Î± Ï„Î¿ ÎµÎ»Î»Î·Î½Î¹ÎºÏŒ ÏŒÎ½Î¿Î¼Î±/Ï€ÎµÏÎ¹Î³ÏÎ±Ï†Î®.'); return; }

                _vcSetBtnBusy(btn, true, 'Translating...');
                const prompt = `You are a professional Greek to English translator for a premium stained-glass studio website.
Return ONLY valid JSON (no markdown, no code fences), with EXACT keys: "name_en", "desc_en".
Translate naturally, concise, marketing tone. Do not invent details. Keep brand names and "Tiffany" as-is.
Greek product name: [[[${nameEl}]]]
Greek product description: [[[${descEl}]]]`;

                const out = await _vcGeminiJson(prompt, { maxOutputTokens: 512 });
                if (out?.name_en) document.getElementById('prod-name-en').value = String(out.name_en).trim();
                if (out?.desc_en) document.getElementById('prod-desc-en').value = String(out.desc_en).trim();
                showToast('ÎˆÎ³Î¹Î½Îµ Î¼ÎµÏ„Î¬Ï†ÏÎ±ÏƒÎ· ÏƒÏ„Î± Î‘Î³Î³Î»Î¹ÎºÎ¬ (Product).');
            } catch (e) {
                showToast('Î£Ï†Î¬Î»Î¼Î± Î¼ÎµÏ„Î¬Ï†ÏÎ±ÏƒÎ·Ï‚: ' + String(e?.message || e));
            } finally {
                _vcSetBtnBusy(btn, false);
            }
        }

        async function autoTranslateBlogToEn() {
            const btn = document.getElementById('btn-blog-auto-en');
            try {
                const titleEl = (document.getElementById('blog-title')?.value || '').trim();
                const dateEl = (document.getElementById('blog-date')?.value || '').trim();
                const contentEl = (document.getElementById('blog-content')?.value || '').trim();
                if (!titleEl && !contentEl) { showToast('Î“ÏÎ¬ÏˆÎµ Ï€ÏÏÏ„Î± Ï„Î¿Î½ ÎµÎ»Î»Î·Î½Î¹ÎºÏŒ Ï„Î¯Ï„Î»Î¿/Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿.'); return; }

                _vcSetBtnBusy(btn, true, 'Translating...');
                const prompt = `You are a professional Greek to English translator for a premium stained-glass studio blog.
Return ONLY valid JSON (no markdown, no code fences) with EXACT keys: "title_en", "date_en", "content_en".
- Translate into natural English.
- Keep the meaning, do not invent details.
- The blog content is an HTML fragment. Preserve ALL HTML tags and attributes exactly; translate only the human-readable text.
- For date, output English in format "D Mon YYYY" (example: "4 Feb 2026"). If input is already English, keep it.
Greek title: [[[${titleEl}]]]
Greek date: [[[${dateEl}]]]
Greek HTML content: [[[${contentEl}]]]`;

                const out = await _vcGeminiJson(prompt, { maxOutputTokens: 2048 });
                if (out?.title_en) document.getElementById('blog-title-en').value = String(out.title_en).trim();
                if (out?.date_en) document.getElementById('blog-date-en').value = String(out.date_en).trim();
                if (out?.content_en) document.getElementById('blog-content-en').value = String(out.content_en).trim();
                showToast('ÎˆÎ³Î¹Î½Îµ Î¼ÎµÏ„Î¬Ï†ÏÎ±ÏƒÎ· ÏƒÏ„Î± Î‘Î³Î³Î»Î¹ÎºÎ¬ (Blog).');
            } catch (e) {
                showToast('Î£Ï†Î¬Î»Î¼Î± Î¼ÎµÏ„Î¬Ï†ÏÎ±ÏƒÎ·Ï‚: ' + String(e?.message || e));
            } finally {
                _vcSetBtnBusy(btn, false);
            }
            try { const __img = document.getElementById('blog-image'); if (__img) __img.dispatchEvent(new Event('input')); } catch(e) {}
        }
        // ===============================================



// --- THEME PRESETS (optional, zero-impact unless used) ---
        // Keeps the current visuals unchanged by default.
        const THEME_PRESETS = {
            vitro: {
                "--color-primary": "#fbc02d",
                "--glass-opacity": "0.6",
                "--glow-start": "#fbc02d",
                "--glow-end": "#b71c1c",
                "--spin-speed": "60s"
            },
            handmade: {
                "--color-primary": "#d97706",
                "--glass-opacity": "0.55",
                "--glow-start": "#f59e0b",
                "--glow-end": "#10b981",
                "--spin-speed": "70s"
            }
        };

        const THEME_PRESET_IMAGES = {
            vitro: {
                "img-service-1": "https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=800&q=65",
                "img-service-2": "https://images.unsplash.com/photo-jQdj6IEPbnc?auto=format&fit=crop&w=800&q=65",
                "img-service-3": "https://images.unsplash.com/photo-JAQmddE76RY?auto=format&fit=crop&w=800&q=65",
                "img-service-4": "https://images.unsplash.com/photo-REEUPkG0WoU?auto=format&fit=crop&w=800&q=65",
                "img-workshops": "https://images.unsplash.com/photo-aNdR7FKIg5w?auto=format&fit=crop&w=800&q=65",
                "workshops-bg": "https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=1920&q=65"
            },
            handmade: {
                "img-service-1": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=800&q=65",
                "img-service-2": "https://images.unsplash.com/photo-V1Gry60Knlo?auto=format&fit=crop&w=800&q=65",
                "img-service-3": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=800&q=65",
                "img-service-4": "https://images.unsplash.com/photo-V1Gry60Knlo?auto=format&fit=crop&w=800&q=65",
                "img-workshops": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=800&q=65",
                "workshops-bg": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=1920&q=65"
            }
        };

        function applyThemeImages(name) {
            const imgs = THEME_PRESET_IMAGES[name];
            if (!imgs) return;
            // Overwrite staticImages and persist so the admin panel sees them too
            staticImages = { ...staticImages, ...imgs };
            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
            scheduleServerSave();
            applyStaticImages();
        }



        // Apply a preset theme by setting CSS variables. Does NOT touch your layout/components.
        function applyThemePreset(name) {
            const preset = THEME_PRESETS[name];
            if (!preset) return;
            const root = document.documentElement;
            for (const [k, v] of Object.entries(preset)) root.style.setProperty(k, v);
            document.documentElement.setAttribute('data-theme', name);
            applyThemeImages(name);
            showToast(`Theme: ${name}`);
        }

        // One-click reset for non-technical users:
        // - forces the current theme's default images
        // - clears any stored overrides for images
        window.resetDefaultImagesForTheme = function(themeName) {
            const name = themeName || document.documentElement.getAttribute('data-theme') || 'vitro';
            const pack = THEME_PRESET_IMAGES[name] || THEME_PRESET_IMAGES.vitro;
            staticImages = { ...pack };
            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
            localStorage.setItem('vitro_assets_version', DEFAULT_ASSETS_VERSION);
            scheduleServerSave();
            applyStaticImages();
            showToast('ÎˆÎ³Î¹Î½Îµ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬ Ï†Ï‰Ï„Î¿Î³ÏÎ±Ï†Î¹ÏÎ½.');
        };



        function toggleAiLoader(show) {
            const el = document.getElementById('ai-toast');
            if(show) el.classList.remove('hidden');
            else el.classList.add('hidden');
        }
        
        function toggleKeyVisibility() {
            const input = document.getElementById('gemini-api-key');
            const icon = document.getElementById('eye-icon');
            if (input.type === "password") {
                input.type = "text";
                icon.classList.replace("fa-eye", "fa-eye-slash");
            } else {
                input.type = "password";
                icon.classList.replace("fa-eye-slash", "fa-eye");
            }
        }

        // --- AUTH & ANALYTICS INIT ---
// --- ADMIN MODE ---
// Admin mode is enabled only after a successful admin login (stored in localStorage).
// Public visitors should never get admin features unless they explicitly log in.
let isAdmin = (localStorage.getItem('vitro_isAdmin') === 'true');
// File-drop guard (Safari & friends): never navigate away on dropped files.
// - Public users: do absolutely nothing.
// - Admin: allow drop to reach the specific drop zones.
const __vcGuardFileDrop = (e) => {
    try {
        const dt = e.dataTransfer;
        const types = dt && dt.types ? Array.from(dt.types) : [];
        if (types.includes('Files')) {
            e.preventDefault(); // always block navigation
            if (!isAdmin) e.stopPropagation(); // public: no action at all
        }
    } catch(_) {}
};
document.addEventListener('dragenter', __vcGuardFileDrop, true);
document.addEventListener('dragover', __vcGuardFileDrop, true);
document.addEventListener('drop', __vcGuardFileDrop, true);


        // (Fallback) will be overridden by server data if present.
        let isMaintenance = localStorage.getItem('vitro_maintenance') === 'true';

        // --- SERVER SAVE/LOAD (Render Disk) ---
        // Without this, edits live only in your browser and disappear for everyone else.
        let __serverSaveTimer = null;

        async function loadFromServer() {
            try {
                const r = await fetch('/api/site', { credentials: 'include' });
                const j = await r.json();
                if (j?.ok && j?.data) {
                    const d = j.data;
                    if (Array.isArray(d.products)) products = d.products;
                    if (Array.isArray(d.blogPosts)) blogPosts = d.blogPosts;
                    if (d.staticImages && typeof d.staticImages === 'object') staticImages = d.staticImages;
                    if (d.globalTexts && typeof d.globalTexts === 'object') globalTexts = d.globalTexts;

                    // Normalize bilingual fields in case older data exists on disk.
                    try { products = window.VC_LANG.normalizeProducts(products); } catch(e) {}
                    try { blogPosts = window.VC_LANG.normalizeBlogPosts(blogPosts); } catch(e) {}
                    try { globalTexts = window.VC_LANG.normalizeGlobalTexts(globalTexts); } catch(e) {}
                    if (d.globalGraphics && typeof d.globalGraphics === 'object') globalGraphics = d.globalGraphics;
                    if (typeof d.isMaintenance === 'boolean') isMaintenance = d.isMaintenance;
                    if (typeof d.lastAiDate === 'number') lastAiDate = d.lastAiDate;

                    // Keep legacy localStorage in sync (harmless, helps transitions)
                    try {
                        localStorage.setItem('vitro_products', JSON.stringify(products));
                        localStorage.setItem('vitro_blog', JSON.stringify(blogPosts));
                        localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                        localStorage.setItem('vitro_texts', JSON.stringify(globalTexts));
                        localStorage.setItem('vitro_graphics', JSON.stringify(globalGraphics));
                        localStorage.setItem('vitro_maintenance', isMaintenance ? 'true' : 'false');
                        localStorage.setItem('vitro_last_ai_date', String(lastAiDate || 0));
                    } catch(e) {}
                }
            } catch (e) {
                console.warn('Server load failed:', e);
            }
        }

        async function saveToServer() {
            const payload = { products, blogPosts, staticImages, globalTexts, globalGraphics, analytics, isMaintenance, lastAiDate };
            try {
                updateSaveIndicator('saving');
                const r = await fetch('/api/site', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ data: payload })
                });
                const j = await r.json().catch(() => ({}));
                if (!r.ok || !j?.ok) {
                    console.warn('Server save failed:', j);
                    updateSaveIndicator('error');
                    return false;
                }
                updateSaveIndicator('saved');
                return true;
            } catch (e) {
                console.warn('Server save error:', e);
                updateSaveIndicator('error');
                return false;
            }
        }

        function scheduleServerSave() {
            clearTimeout(__serverSaveTimer);
            __serverSaveTimer = setTimeout(saveToServer, 700);
        }

        function updateSaveIndicator(state) {
            const el = document.getElementById('save-indicator');
            if (!el) return;
            if (state === 'saving') {
                el.className = 'text-amber font-bold';
                el.innerHTML = '<i class="fas fa-spinner fa-spin text-xs mr-2"></i>Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·â€¦';
            } else if (state === 'saved') {
                el.className = 'text-emerald font-bold';
                el.innerHTML = '<i class="fas fa-check text-xs mr-2"></i>Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ';
            } else if (state === 'error') {
                el.className = 'text-ruby font-bold';
                el.innerHTML = '<i class="fas fa-exclamation-triangle text-xs mr-2"></i>Î£Ï†Î¬Î»Î¼Î±';
            } else {
                el.className = 'text-amber font-bold';
                el.innerHTML = '<i class="fas fa-clock text-xs mr-2"></i>ÎŒÏ‡Î¹ Î±ÎºÏŒÎ¼Î±';
            }
        }

        window.manualSaveNow = async function(ev) {
            try { ev?.preventDefault?.(); } catch(e) {}
            const ok = await saveToServer();
            showToast(ok ? 'Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ ÏƒÏ„Î¿Î½ server.' : 'Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚. Î”Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î¾Î±Î½Î¬.');
        };

        // Safety net: if a control changes and we forgot to call scheduleServerSave(),
        // this will still trigger a debounced save.
        document.addEventListener('input', () => { if (isAdmin) scheduleServerSave(); }, true);
        document.addEventListener('change', () => { if (isAdmin) scheduleServerSave(); }, true);


        
        // --- IMAGE UPLOAD HELPERS (validate + resize + progress) ---
        const VC_ALLOWED_IMAGE_MIME = new Set(['image/jpeg', 'image/png', 'image/webp']);
        const VC_ALLOWED_IMAGE_EXT = new Set(['.jpg', '.jpeg', '.png', '.webp']);

        function vcValidateImageFile(file) {
            if (!file) return { ok: false, message: 'Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î±ÏÏ‡ÎµÎ¯Î¿.' };

            const name = (file.name || '').toLowerCase().trim();
            const ext = name.includes('.') ? name.slice(name.lastIndexOf('.')) : '';

            const mimeOk = file.type && VC_ALLOWED_IMAGE_MIME.has(file.type);
            const extOk = ext && VC_ALLOWED_IMAGE_EXT.has(ext);

            // Accept if either mime or ext looks valid (some browsers are weird)
            if (!(mimeOk || extOk)) {
                return { ok: false, message: 'ÎœÏŒÎ½Î¿ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ JPG / PNG / WebP.' };
            }

            // Donâ€™t â€œresizeâ€ GIFs, HEIC, SVG, etc. (we block them above anyway)
            return { ok: true, message: '' };
        }

        async function vcResizeImageFile(file, opts = {}) {
    const {
        maxSide = 1800,
        quality = 0.86,
        targetBytes = 2000000, // ~2MB ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Î³Î¹Î± Î½Î± Î¼Î· Ï‡Ï„Ï…Ï€Î¬Î¼Îµ server limits
        minSide = 900,
        minQuality = 0.60
    } = opts || {};

    const img = await new Promise((resolve, reject) => {
        const url = URL.createObjectURL(file);
        const im = new Image();
        im.onload = () => { try { URL.revokeObjectURL(url); } catch(_) {} resolve(im); };
        im.onerror = () => { try { URL.revokeObjectURL(url); } catch(_) {} reject(new Error('Î”ÎµÎ½ Î¼Ï€Î¿ÏÏ Î½Î± Î±Î½Î¿Î¯Î¾Ï‰ Î±Ï…Ï„Î® Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î±.')); };
        im.src = url;
    });

    const w = img.naturalWidth || img.width || 0;
    const h = img.naturalHeight || img.height || 0;
    if (!w || !h) throw new Error('Î†Î³Î½Ï‰ÏƒÏ„ÎµÏ‚ Î´Î¹Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ ÎµÎ¹ÎºÏŒÎ½Î±Ï‚.');

    // Î Î¬Î½Ï„Î± JPEG ÏƒÏ„Î¿ upload (Î¼Î¹ÎºÏÏŒÏ„ÎµÏÎ¿ ÎºÎ±Î¹ Ï€Î¹Î¿ ÏƒÏ…Î¼Î²Î±Ï„ÏŒ)
    const outType = 'image/jpeg';

    let curMaxSide = maxSide;
    let curQuality = quality;
    let blob = null;

    for (let attempt = 0; attempt < 4; attempt++) {
        const scale = Math.min(1, curMaxSide / Math.max(w, h));
        const nw = Math.max(1, Math.round(w * scale));
        const nh = Math.max(1, Math.round(h * scale));

        const canvas = document.createElement('canvas');
        canvas.width = nw;
        canvas.height = nh;

        const ctx = canvas.getContext('2d', { alpha: false });
        if (!ctx) throw new Error('Î”ÎµÎ½ Î¼Ï€Î¿ÏÏ Î½Î± ÎºÎ¬Î½Ï‰ resize ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ browser.');

        // Î›ÎµÏ…ÎºÏŒ Ï†ÏŒÎ½Ï„Î¿ (Î³Î¹Î± Î´Î¹Î±Ï†Î¬Î½ÎµÎ¹ÎµÏ‚ Î±Ï€ÏŒ PNG/WebP)
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, nw, nh);
        ctx.drawImage(img, 0, 0, nw, nh);

        blob = await new Promise((resolve, reject) => {
            canvas.toBlob((b) => b ? resolve(b) : reject(new Error('Î‘Ï€Î­Ï„Ï…Ï‡Îµ Ï„Î¿ resize.')), outType, curQuality);
        });

        if (blob && blob.size <= targetBytes) break;

        // Î£Ï†Î¯Î³Î³Î¿Ï…Î¼Îµ Î»Î¯Î³Î¿ Î±ÎºÏŒÎ¼Î· (Ï€Î¿Î¹ÏŒÏ„Î·Ï„Î± + (Î±Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯) Î±Î½Î¬Î»Ï…ÏƒÎ·)
        if (curQuality > minQuality) curQuality = Math.max(minQuality, curQuality - 0.10);
        if (blob && blob.size > targetBytes * 1.4 && curMaxSide > minSide) {
            curMaxSide = Math.max(minSide, Math.round(curMaxSide * 0.90));
        }

        if (curQuality <= minQuality && curMaxSide <= minSide) break;
    }

    const base = (file.name || 'image').replace(/\.[^.]+$/, '');
    const safeBase = base.replace(/[^\w\-\.]+/g, '_').slice(0, 60) || 'image';
    const newName = safeBase + '.jpg';
    return new File([blob], newName, { type: outType });
}

// --- MODAL IMAGE UPLOAD ZONES (Drag & Drop + Preview) ---
        function initModalUploadZones() {
            if (!isAdmin) return;
            setupModalDropZone({ dropId: 'prod-image-drop', fileInputId: 'prod-image-file', previewId: 'prod-image-preview', urlInputId: 'prod-image' });
            setupModalDropZone({ dropId: 'blog-image-drop', fileInputId: 'blog-image-file', previewId: 'blog-image-preview', urlInputId: 'blog-image' });
        }

        function setupModalDropZone({ dropId, fileInputId, previewId, urlInputId }) {
            const drop = document.getElementById(dropId);
            const fileInput = document.getElementById(fileInputId);
            const preview = document.getElementById(previewId);
            const urlInput = document.getElementById(urlInputId);
            if (!drop || !fileInput || !preview || !urlInput) return;

            const showPreviewFromUrl = (u) => {
                const url = (u || '').trim();
                if (!url) {
                    preview.classList.add('hidden');
                    preview.removeAttribute('src');
                    return;
                }
                preview.src = url;
                preview.classList.remove('hidden');
            };

            // Keep preview in sync with URL field
            urlInput.addEventListener('input', () => showPreviewFromUrl(urlInput.value));

            // Clicking the zone opens file picker
            drop.addEventListener('click', () => fileInput.click());

            // Drag visuals
            ['dragenter', 'dragover'].forEach(ev => drop.addEventListener(ev, (e) => {
                e.preventDefault();
                e.stopPropagation();
                drop.classList.add('drag-over');
            }));
            ['dragleave', 'drop'].forEach(ev => drop.addEventListener(ev, (e) => {
                e.preventDefault();
                e.stopPropagation();
                drop.classList.remove('drag-over');
            }));

            const uploadAndSet = async (file) => {
                if (!file) return;

                const v = vcValidateImageFile(file);
                if (!v.ok) {
                    showToast(v.message, { iconClass: 'fas fa-exclamation-triangle text-xl' });
                    return;
                }

                try {
                    // Local preview immediately (fast feedback)
                    try {
                        const tmpUrl = URL.createObjectURL(file);
                        preview.src = tmpUrl;
                        preview.classList.remove('hidden');
                        setTimeout(() => { try { URL.revokeObjectURL(tmpUrl); } catch(_) {} }, 4000);
                    } catch(_) {}

                    showToast('Î ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦', { sticky: true, iconClass: 'fas fa-sync-alt fa-spin text-xl' });
                    const resized = await vcResizeImageFile(file, { maxSide: 1800, quality: 0.86 });

                    let lastPct = -1;
                    updateToast('Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦ 0%', { iconClass: 'fas fa-cloud-upload-alt text-xl' });

                    const __progress = (pct) => {
                        // Throttle UI updates a bit
                        if (typeof pct !== 'number') return;
                        if (pct === lastPct) return;
                        lastPct = pct;
                        updateToast(`Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦ ${pct}%`, { iconClass: 'fas fa-cloud-upload-alt text-xl' });
                    };

                    let url;
                    try {
                        url = await uploadImageToServer(resized, __progress);
                    } catch (upErr) {
                        if (upErr && (upErr.status === 413 || /payload/i.test(String(upErr.error || '')))) {
                            updateToast('Î Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î· ÎµÎ¹ÎºÏŒÎ½Î±â€¦ ÎºÎ¬Î½Ï‰ extra ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·', { iconClass: 'fas fa-sync-alt fa-spin text-xl' });
                            const resized2 = await vcResizeImageFile(file, { maxSide: 1400, quality: 0.78, targetBytes: 1200000 });
                            updateToast('Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦ 0%', { iconClass: 'fas fa-cloud-upload-alt text-xl' });
                            url = await uploadImageToServer(resized2, __progress);
                        } else {
                            throw upErr;
                        }
                    }

                    hideToast();
                    urlInput.value = url;
                    showPreviewFromUrl(url);
                    showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î±Î½Î­Î²Î·ÎºÎµ!', { iconClass: 'fas fa-check-circle text-xl' });
                } catch (err) {
                    console.error(err);
                    hideToast();
                    const st = err && err.status;
                    if (st === 401 || st === 403) {
                        showToast('Î— ÏƒÏÎ½Î´ÎµÏƒÎ· admin Î­Î»Î·Î¾Îµ. ÎšÎ¬Î½Îµ logout/login Î¾Î±Î½Î¬.', { iconClass: 'fas fa-exclamation-triangle text-xl' });
                    } else if (st === 413) {
                        showToast('ÎŸ server Î­ÎºÎ¿ÏˆÎµ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Ï‰Ï‚ Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î·. Î”Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î¾Î±Î½Î¬ (Î¸Î± Ï„Î· ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÏ‰ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿).', { iconClass: 'fas fa-exclamation-triangle text-xl' });
                    } else {
                        showToast('Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ Î±Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚.', { iconClass: 'fas fa-exclamation-triangle text-xl' });
                    }
                }
            };

            drop.addEventListener('drop', (e) => {
                const file = e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files[0] : null;
                uploadAndSet(file);
            });

            fileInput.addEventListener('change', () => {
                const file = fileInput.files && fileInput.files[0] ? fileInput.files[0] : null;
                uploadAndSet(file);
                try { fileInput.value = ''; } catch(_) {}
            });

            // Initial preview if url already filled
            showPreviewFromUrl(urlInput.value);
        }


        function uploadImageToServer(file, onProgress) {
    const fd = new FormData();
    fd.append('file', file, file && file.name ? file.name : 'upload.jpg');

    return new Promise((resolve, reject) => {
        const xhr = new XMLHttpRequest();
        xhr.open('POST', '/api/upload', true);
        xhr.withCredentials = true;

        if (xhr.upload && typeof onProgress === 'function') {
            xhr.upload.onprogress = (e) => {
                try {
                    if (e.lengthComputable) {
                        const pct = Math.max(0, Math.min(100, Math.round((e.loaded / e.total) * 100)));
                        onProgress(pct);
                    }
                } catch(_) {}
            };
        }

        xhr.onload = () => {
            let j = {};
            const text = xhr.responseText || '';
            try { j = JSON.parse(text || '{}'); } catch(_) {}

            if (xhr.status >= 200 && xhr.status < 300 && j && j.ok && j.url) {
                resolve(j.url);
                return;
            }

            const err = {
                status: xhr.status,
                error: (j && j.error) ? j.error : (text ? String(text).slice(0, 200) : 'Upload failed')
            };
            reject(err);
        };

        xhr.onerror = () => reject({ status: 0, error: 'Network error' });
        xhr.send(fd);
    });
}

// Init Analytics Counters
        let analytics = JSON.parse(localStorage.getItem('vitro_analytics')) || {
            totalVisits: 0,
            pageViews: { home: 0, catalog: 0, blog: 0, workshops: 0 }
        };
        if(!sessionStorage.getItem('session_started')) {
            analytics.totalVisits++;
            localStorage.setItem('vitro_analytics', JSON.stringify(analytics));
            sessionStorage.setItem('session_started', 'true');
        }

        // Load Data - Changed to LET to allow re-assignment during import
        let staticImages = JSON.parse(localStorage.getItem('vitro_static_images')) || {};
        // --- Default image pack versioning (so new image sets actually show up) ---
        const DEFAULT_ASSETS_VERSION = '2026-01-31-images-v1';
        const currentAssetsVersion = localStorage.getItem('vitro_assets_version');

        // If you have old saved images in your browser (LocalStorage), they override the file.
        // This block safely migrates to the new default images once, while keeping a backup.
        if (currentAssetsVersion !== DEFAULT_ASSETS_VERSION) {
            try {
                const old = localStorage.getItem('vitro_static_images');
                if (old) localStorage.setItem('vitro_static_images_backup_' + Date.now(), old);
            } catch (e) {}
            staticImages = { ...(THEME_PRESET_IMAGES?.vitro || {}) };
            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
            localStorage.setItem('vitro_assets_version', DEFAULT_ASSETS_VERSION);
        }

        let globalTexts = JSON.parse(localStorage.getItem('vitro_texts')) || {};
        let globalGraphics = JSON.parse(localStorage.getItem('vitro_graphics')) || { 
            primary: '#fbc02d',
            opacity: '0.6',
            glowStart: '#fbc02d', 
            glowEnd: '#b71c1c', 
            spinSpeed: '60' 
        };
        // AI State
        let geminiKey = localStorage.getItem('vitro_gemini_key') || "";
        let geminiModel = localStorage.getItem('vitro_gemini_model') || "";

        let lastAiDate = parseInt(localStorage.getItem('vitro_last_ai_date')) || 0;

        // --- DRAG AND DROP LOGIC ---
        function initDragAndDrop() {
            // Prevent browsers (Safari especially) from navigating to file:// when dropping files anywhere
            // Cancel default behavior early (capture phase) but DO NOT stop propagation, so drop handlers still work.
            const __vcBlockFileNav = (e) => { try { e.preventDefault(); } catch(_) {} };
            window.addEventListener("dragover", __vcBlockFileNav, true);
            window.addEventListener("drop", __vcBlockFileNav, true);

['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
        }

        // Explicitly called after renders to attach drag events to new elements
        function enableImageDropZones() {
            if (!isAdmin) return;
            // Only add if not inline-handled (static imgs or specific zones)
            const images = document.querySelectorAll('.admin-editable-img, .admin-editable-bg, #drop-zone-info');
            images.forEach(img => {
                // Check if already bound to avoid duplicates on static elements
                if(img.dataset.bound === 'true') return; 
                
                img.addEventListener('dragenter', highlight, false);
                img.addEventListener('dragover', highlight, false);
                img.addEventListener('dragleave', unhighlight, false);
                img.addEventListener('drop', handleDrop, false);
                
                img.dataset.bound = 'true'; // Mark as bound
            });
        }

        function highlight(e) { try { e.preventDefault(); } catch(_) {} this.classList.add('drag-over'); }
        function unhighlight(e) { try { e.preventDefault(); } catch(_) {} this.classList.remove('drag-over'); }

        function handleDrop(e) {
            try { e.preventDefault(); e.stopPropagation(); } catch(_) {}
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.name.endsWith('.json')) {
                    importData(file);
                    this.classList.remove('drag-over');
                    return;
                }
                if (vcValidateImageFile(file).ok) {
                    if (this.id === 'drop-zone-info') showToast('Î£ÏÏÎµÏ„Îµ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î±Î»Î»Î¬Î¾ÎµÏ„Îµ.');
                    else handleFileSelect(file, this);
                } else {
                    showToast('Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏÏÎµÏ„Îµ Î¼ÏŒÎ½Î¿ Î±ÏÏ‡ÎµÎ¯Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ Î® .json backup.');
                }
            }
            this.classList.remove('drag-over');
        }

        async function handleFileSelect(file, element) {
            const v = vcValidateImageFile(file);
            if (!v.ok) {
                showToast(v.message, { iconClass: 'fas fa-exclamation-triangle text-xl' });
                return;
            }

            try {
                // Quick local preview for <img> targets (optional)
                try {
                    if (element && element.tagName === 'IMG') {
                        const tmpUrl = URL.createObjectURL(file);
                        element.src = tmpUrl;
                        setTimeout(() => { try { URL.revokeObjectURL(tmpUrl); } catch(_) {} }, 4000);
                    }
                } catch(_) {}

                showToast('Î ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦', { sticky: true, iconClass: 'fas fa-sync-alt fa-spin text-xl' });
                const resized = await vcResizeImageFile(file, { maxSide: 1800, quality: 0.86 });

                let lastPct = -1;
                updateToast('Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦ 0%', { iconClass: 'fas fa-cloud-upload-alt text-xl' });

                // Upload to server so EVERYONE sees it (not just your browser)
                const __progress = (pct) => {
                    if (typeof pct !== 'number') return;
                    if (pct === lastPct) return;
                    lastPct = pct;
                    updateToast(`Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦ ${pct}%`, { iconClass: 'fas fa-cloud-upload-alt text-xl' });
                };

                let url;
                try {
                    url = await uploadImageToServer(resized, __progress);
                } catch (upErr) {
                    if (upErr && (upErr.status === 413 || /payload/i.test(String(upErr.error || '')))) {
                        updateToast('Î Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î· ÎµÎ¹ÎºÏŒÎ½Î±â€¦ ÎºÎ¬Î½Ï‰ extra ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·', { iconClass: 'fas fa-sync-alt fa-spin text-xl' });
                        const resized2 = await vcResizeImageFile(file, { maxSide: 1400, quality: 0.78, targetBytes: 1200000 });
                        updateToast('Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚â€¦ 0%', { iconClass: 'fas fa-cloud-upload-alt text-xl' });
                        url = await uploadImageToServer(resized2, __progress);
                    } else {
                        throw upErr;
                    }
                }

                hideToast();

                const id = element.id || element.dataset.id;

                if (element.classList.contains('admin-editable-bg') || (id && id.endsWith('-bg'))) {
                    element.style.backgroundImage = `url('${url}')`;
                    if (id) {
                        staticImages[id] = url;
                        localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                        scheduleServerSave();
                    }
                } else {
                    element.src = url;
                    if (id && (id.startsWith('img-service') || id.startsWith('img-about') || id.startsWith('img-workshops'))) {
                        staticImages[id] = url;
                        localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                        scheduleServerSave();
                        showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!', { iconClass: 'fas fa-check-circle text-xl' });
                        return;
                    }
                }

                // Dynamic Data Attributes Check
                if (element.dataset.type === 'product') {
                    const prodId = parseInt(element.dataset.id);
                    const prod = products.find(p => p.id === prodId);
                    if (prod) {
                        prod.image = url;
                        saveProducts();
                        renderProducts();
                        showToast('Î ÏÎ¿ÏŠÏŒÎ½ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!', { iconClass: 'fas fa-check-circle text-xl' });
                    }
                } else if (element.dataset.type === 'blog') {
                    const postId = parseInt(element.dataset.id);
                    const post = blogPosts.find(p => p.id === postId);
                    if (post) {
                        post.image = url;
                        saveBlogPosts();
                        renderBlogList();
                        showToast('Î†ÏÎ¸ÏÎ¿ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!', { iconClass: 'fas fa-check-circle text-xl' });
                    }
                } else {
                    showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!', { iconClass: 'fas fa-check-circle text-xl' });
                }
            } catch (e) {
                console.error(e);
                hideToast();
                const st = e && e.status;
                 if (st === 401 || st === 403) {
                     showToast('Î— ÏƒÏÎ½Î´ÎµÏƒÎ· admin Î­Î»Î·Î¾Îµ. ÎšÎ¬Î½Îµ logout/login Î¾Î±Î½Î¬.', { iconClass: 'fas fa-exclamation-triangle text-xl' });
                 } else if (st === 413) {
                     showToast('ÎŸ server Î­ÎºÎ¿ÏˆÎµ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Ï‰Ï‚ Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î·. Î”Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î¾Î±Î½Î¬ (Î¸Î± Ï„Î· ÏƒÏ…Î¼Ï€Î¹Î­ÏƒÏ‰ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿).', { iconClass: 'fas fa-exclamation-triangle text-xl' });
                 } else {
                     showToast('Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ upload ÎµÎ¹ÎºÏŒÎ½Î±Ï‚. Î”Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î¬Î»Î»Î· ÎµÎ¹ÎºÏŒÎ½Î±.', { iconClass: 'fas fa-exclamation-triangle text-xl' });
                 }
            }
        }

        // --- BACKUP & RESTORE ---
        function exportData() {
            const data = {
                products, blogPosts, staticImages, globalTexts, globalGraphics, analytics,
                lastAiDate, // Save AI state
                timestamp: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data)], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "vitro_backup.json";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('Î¤Î¿ backup ÎºÎ±Ï„Î­Î²Î·ÎºÎµ!');
        }

        function importData(file) {
            if(!file) return;
            showToast('Î‘Î½Î¬Î³Î½Ï‰ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Î¿Ï…...');
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const data = JSON.parse(event.target.result);
                    
                    // 1. Update In-Memory Variables Immediately (Hot Load)
                    if (data.products) products = data.products;
                    if (data.blogPosts) blogPosts = data.blogPosts;
                    if (data.staticImages) staticImages = data.staticImages;
                    if (data.globalTexts) globalTexts = data.globalTexts;
                    if (data.globalGraphics) globalGraphics = data.globalGraphics;
                    if (data.analytics) analytics = data.analytics;
                    if (data.lastAiDate) lastAiDate = data.lastAiDate;

                    // 2. Re-render everything immediately
                    renderProducts();
                    renderBlogList();
                    applyStaticImages();
                    applyGlobalSettings();
                    updateAdminTables();
                    
                    showToast('Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎ±Î½ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!');

                    // 3. Try to save to LocalStorage (Might fail if too big)
                    try {
                        localStorage.setItem('vitro_products', JSON.stringify(products));
                        localStorage.setItem('vitro_blog', JSON.stringify(blogPosts));
                        localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                        localStorage.setItem('vitro_texts', JSON.stringify(globalTexts));
                        localStorage.setItem('vitro_graphics', JSON.stringify(globalGraphics));
                        localStorage.setItem('vitro_analytics', JSON.stringify(analytics));
                        localStorage.setItem('vitro_last_ai_date', lastAiDate);
                        
                        // If we reached here, save was successful. We can reload to be clean.
                        showToast('Î•Ï€Î¹Ï„Ï…Ï‡Î®Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·! Î— ÏƒÎµÎ»Î¯Î´Î± Î¸Î± Î±Î½Î±Î½ÎµÏ‰Î¸ÎµÎ¯.');
                        setTimeout(() => location.reload(), 1000);
                        
                    } catch (storageError) {
                        if (storageError.name === 'QuotaExceededError') {
                            alert("Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ backup Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎµ, Î±Î»Î»Î¬ ÎµÎ¯Î½Î±Î¹ Î ÎŸÎ›Î¥ ÎœÎ•Î“Î‘Î›ÎŸ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ Î¼ÏŒÎ½Î¹Î¼Î± ÏƒÏ„Î· Î¼Î½Î®Î¼Î· Ï„Î¿Ï… browser.\n\nÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„ÏÏÎ±, Î±Î»Î»Î¬ Î±Î½ ÎºÎ¬Î½ÎµÏ„Îµ Î±Î½Î±Î½Î­Ï‰ÏƒÎ· (refresh), Î¸Î± Ï‡Î±Î¸Î¿ÏÎ½.");
                        } else {
                            console.error(storageError);
                        }
                    }

                } catch (e) {
                    showToast('Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿. Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î· Î¼Î¿ÏÏ†Î®.');
                    console.error(e);
                    alert("Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®: " + e.message);
                }
            };
            reader.readAsText(file);
        }

        // --- MAINTENANCE MODE ---
        function toggleMaintenanceMode() {
            isMaintenance = document.getElementById('maintenance-toggle').checked;
            localStorage.setItem('vitro_maintenance', isMaintenance);
            scheduleServerSave();
            const statusText = document.getElementById('maintenance-status-text');
            
            if (isMaintenance) {
                statusText.innerText = "Î•Î½ÎµÏÎ³ÏŒ (Site ÎšÎ»ÎµÎ¹ÏƒÏ„ÏŒ)";
                statusText.classList.add('text-red-400');
                document.getElementById('maintenance-banner').classList.remove('hidden');
                showToast('Maintenance Mode Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ.');
            } else {
                statusText.innerText = "Î‘Î½ÎµÎ½ÎµÏÎ³ÏŒ (Site Î‘Î½Î¿Î¹Ï‡Ï„ÏŒ)";
                statusText.classList.remove('text-red-400');
                document.getElementById('maintenance-banner').classList.add('hidden');
                showToast('Maintenance Mode Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ.');
            }
        }
        
        function checkMaintenance() {
            // Setup toggle switch UI state
            const toggle = document.getElementById('maintenance-toggle');
            if(toggle) {
                toggle.checked = isMaintenance;
                const statusText = document.getElementById('maintenance-status-text');
                if (isMaintenance) {
                    statusText.innerText = "Î•Î½ÎµÏÎ³ÏŒ (Site ÎšÎ»ÎµÎ¹ÏƒÏ„ÏŒ)";
                    statusText.classList.add('text-red-400');
                }
            }

            if (isMaintenance) {
                if (!isAdmin) {
                    // Visitor: Show only maintenance screen
                    document.getElementById('view-landing').classList.add('hidden');
                    document.getElementById('view-catalog').classList.add('hidden');
                    document.getElementById('view-blog').classList.add('hidden');
                    document.getElementById('view-blog-single').classList.add('hidden');
                    document.getElementById('view-admin-dashboard')?.classList.add('hidden');
                    document.getElementById('main-nav').classList.add('hidden'); // Hide menu
                    
                    document.getElementById('view-maintenance').classList.remove('hidden');
                } else {
                    // Admin: Show banner
                    document.getElementById('maintenance-banner').classList.remove('hidden');
                }
            } else {
                document.getElementById('view-maintenance').classList.add('hidden');
                document.getElementById('maintenance-banner').classList.add('hidden');
                document.getElementById('main-nav').classList.remove('hidden');
            }
        }

        // --- AI BLOG GENERATION LOGIC ---
        // Gemini helper: list models and pick a generateContent-capable model (client-side)
        async function getBestGeminiModel(key) {
            const preferred = [
                "gemini-2.5-flash",
                "gemini-2.0-flash",
                "gemini-1.5-flash",
                "gemini-1.5-pro",
            ];
            const resp = window.USE_SERVER_AI ? await fetch('/api/gemini/models') : await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${key}`);
            if (!resp.ok) {
                const err = await resp.json().catch(() => ({}));
                throw new Error(err?.error?.message || `Î£Ï†Î¬Î»Î¼Î± Google (ListModels): ${resp.status}`);
            }
            const data = await resp.json();
            const models = Array.isArray(data.models) ? data.models : [];
            // filter models that support generateContent
            const eligible = models.filter(m => Array.isArray(m.supportedGenerationMethods) && m.supportedGenerationMethods.includes("generateContent"));
            if (!eligible.length) throw new Error("Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿ Ï€Î¿Ï… Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ generateContent.");
            // choose preferred if exists
            for (const p of preferred) {
                const found = eligible.find(m => (m.name || "").endsWith(p));
                if (found) return found.name; // e.g. "models/gemini-2.5-flash"
            }
            return eligible[0].name;
        }


        async function saveGeminiKey(event) {
            if(event) event.preventDefault();
            const btn = event?.currentTarget || document.querySelector('button[onclick*="saveGeminiKey"]'); 
            const keyInput = document.getElementById('gemini-api-key');
            let key = keyInput.value.trim();
            
            if(!key) {
                showToast('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯.');
                return;
            }

            // Client-side quick check
            if (!key.startsWith('AIza')) {
                 showToast('Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¾ÎµÎºÎ¹Î½Î¬ Î¼Îµ "AIza".');
                 return;
            }
            
            // Validate key
            const originalText = btn.innerText;
            btn.innerText = "ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚...";
            btn.disabled = true;

            try {
                // Validation Request using generateContent with gemini-1.5-flash-latest
                const response = window.USE_SERVER_AI ? await fetch('/api/gemini/models') : await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${key}`);
if (!response.ok) {
                   const errorData = await response.json();
                   console.warn("Gemini Validation Error:", errorData);
                   
                   // Check for common error codes
                   if (response.status === 400 && errorData.error?.status === 'INVALID_ARGUMENT') {
                        throw new Error('Î›Î¬Î¸Î¿Ï‚ ÎšÎ»ÎµÎ¹Î´Î¯ (Invalid Key). Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î®.');
                   } else if (response.status === 403) {
                       throw new Error('Î‘Ï€Î±Î³Î¿ÏÎµÏÎµÏ„Î±Î¹ Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·. Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ Ï„Î¿Ï… ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï.');
                   }
                   
                   throw new Error(`Î£Ï†Î¬Î»Î¼Î± Google: ${errorData.error?.message || response.status}`);
                }

                // Pick a working model dynamically (Google changes names/availability often)
                const selectedModel = await getBestGeminiModel(key);
                geminiKey = key;
                geminiModel = selectedModel; // e.g. "models/gemini-2.5-flash"
                localStorage.setItem('vitro_gemini_key', key);
                localStorage.setItem('vitro_gemini_model', selectedModel);
                showToast('Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ ÎµÎ¯Î½Î±Î¹ Î­Î³ÎºÏ…ÏÎ¿ ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!');
                
                // Update UI
                const dateEl = document.getElementById('next-ai-date');
                if(dateEl && lastAiDate === 0) dateEl.innerText = "Î†Î¼ÎµÏƒÎ±";
                
                checkWeeklyAI(); 

            } catch (error) {
                console.error(error);
                let msg = error.message;
                if (msg === 'Failed to fetch') {
                    msg = 'Î ÏÏŒÎ²Î»Î·Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚. Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿ Î¯Î½Ï„ÎµÏÎ½ÎµÏ„ Î® AdBlock.';
                }
                showToast(msg);
            } finally {
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }

        async function fetchAIBlogPost() {
            if(!geminiModel){
                try { geminiModel = await getBestGeminiModel(geminiKey); localStorage.setItem('vitro_gemini_model', geminiModel); }
                catch(e){ console.warn(e); }
            }

            if(!geminiKey) return;
            toggleAiLoader(true);

            const prompt = `Î“ÏÎ¬ÏˆÎµ Î­Î½Î± Î½Î­Î¿, ÏƒÏÎ½Ï„Î¿Î¼Î¿, ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½ Î¬ÏÎ¸ÏÎ¿ Î³Î¹Î± blog ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒ Î¼Îµ Ï„Î·Î½ Ï„Î­Ï‡Î½Î· Ï„Î¿Ï… Î²Î¹Ï„ÏÏŒ (Stained Glass), Î¹ÏƒÏ„Î¿ÏÎ¯Î±, Î® Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚. Î ÎµÏÎ¯Ï€Î¿Ï… 150 Î»Î­Î¾ÎµÎ¹Ï‚.
            Î•Ï€Î¯ÏƒÏ„ÏÎµÏˆÎµ ÎœÎŸÎÎŸ JSON Î¼Î¿ÏÏ†Î® Ï‡Ï‰ÏÎ¯Ï‚ markdown (backticks):
            {
             "title": "Î¤Î¯Ï„Î»Î¿Ï‚ Î¬ÏÎ¸ÏÎ¿Ï…",
             "content": "Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ ÏƒÎµ HTML Ï€Î±ÏÎ±Î³ÏÎ¬Ï†Î¿Ï…Ï‚...",
             "image_keyword": "Î¼Î¹Î± Î±Î³Î³Î»Î¹ÎºÎ® Î»Î­Î¾Î· ÎºÎ»ÎµÎ¹Î´Î¯ Î³Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î± Ï€Ï‡ stained glass flower"
            }`;

            try {
                // Use gemini-1.5-flash-latest as standard
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/${(geminiModel || 'models/gemini-2.0-flash')}:generateContent?key=${geminiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                
                if (!response.ok) {
                   const errorData = await response.json();
                   console.warn("AI Generation Warning:", errorData); 
                   throw new Error('API Request Failed: ' + (errorData.error?.message || response.status));
                }

                const data = await response.json();
                const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                
                if (rawText) {
                    const cleanText = rawText.replace(/```json/g, '').replace(/```/g, '').trim();
                    const jsonPost = JSON.parse(cleanText);
                    
                    const newPost = {
                        id: Date.now(),
                        title: jsonPost.title || "ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿ AI",
                        date: new Date().toLocaleDateString('el-GR', { day: 'numeric', month: 'short', year: 'numeric' }),
                        image: `https://image.pollinations.ai/prompt/${jsonPost.image_keyword || 'stained glass'}%20art%20high%20quality`, 
                        content: jsonPost.content || "<p>Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î¼Î· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿.</p>"
                    };

                    blogPosts.unshift(newPost);
                    saveBlogPosts();
                    renderBlogList();
                    
                    lastAiDate = Date.now();
                    localStorage.setItem('vitro_last_ai_date', lastAiDate);
                    updateStats(); 
                    
                    showToast('ÎÎ­Î¿ Î¬ÏÎ¸ÏÎ¿ AI Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!');
                }
            } catch (error) {
                console.warn("AI Error:", error); 
                showToast('Î£Ï†Î¬Î»Î¼Î±: ' + error.message);
            } finally {
                toggleAiLoader(false);
            }
        }

        function checkWeeklyAI() {
            if(!geminiKey) return;
            const now = Date.now();
            const oneWeek = 7 * 24 * 60 * 60 * 1000;
            
            if (now - lastAiDate > oneWeek) {
                console.log("Triggering Weekly AI Blog Post...");
                fetchAIBlogPost();
            }
        }

        function forceAiBlogGeneration() {
            if(!geminiKey) { showToast('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€ÏÏÏ„Î± API Key.'); return; }
            if(confirm('Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î¬ÏÎ¸ÏÎ¿ Ï„ÏÏÎ±;')) {
                fetchAIBlogPost();
            }
        }

        // --- LIVE PREVIEW & SETTINGS ---
        function updateLivePreview() {
            const root = document.documentElement;
            const getVal = (id) => { const el = document.getElementById(id); return el ? el.value : null; };

            const primary = getVal('admin-color-primary');
            const opacity = getVal('admin-glass-opacity');
            const glowStart = getVal('admin-glow-start');
            const glowEnd = getVal('admin-glow-end');
            const spinSpeed = getVal('admin-spin-speed');

            if (primary) root.style.setProperty('--color-primary', primary);
            if (opacity) root.style.setProperty('--glass-opacity', opacity);
            if (glowStart) root.style.setProperty('--glow-start', glowStart);
            if (glowEnd) root.style.setProperty('--glow-end', glowEnd);
            if (spinSpeed) root.style.setProperty('--spin-speed', spinSpeed + 's');
        }

        function applyGlobalSettings() {
            if (globalTexts.heroTitle) { const elTitle = document.getElementById('editable-hero-title'); if (elTitle) elTitle.innerHTML = (window.VC_LANG ? window.VC_LANG.pick(globalTexts.heroTitle) : globalTexts.heroTitle); }
            if (globalTexts.phone) { const phoneEls = document.querySelectorAll('.fa-phone-alt + div p, #editable-phone'); phoneEls.forEach(el => el.textContent = globalTexts.phone); }
            if (globalTexts.instagram) document.querySelectorAll('.link-instagram').forEach(el => el.href = globalTexts.instagram);
            if (globalTexts.facebook) document.querySelectorAll('.link-facebook').forEach(el => el.href = globalTexts.facebook);
            if (globalTexts.pinterest) document.querySelectorAll('.link-pinterest').forEach(el => el.href = globalTexts.pinterest);

            const root = document.documentElement;
            root.style.setProperty('--color-primary', globalGraphics.primary || '#fbc02d');
            root.style.setProperty('--glass-opacity', globalGraphics.opacity || '0.6');
            root.style.setProperty('--glow-start', globalGraphics.glowStart || '#fbc02d');
            root.style.setProperty('--glow-end', globalGraphics.glowEnd || '#b71c1c');
            root.style.setProperty('--spin-speed', (globalGraphics.spinSpeed || '60') + 's');
            
            const setVal = (id, val) => { const el = document.getElementById(id); if (el) el.value = val; };
            setVal('admin-hero-title', globalTexts.heroTitle ? globalTexts.heroTitle.replace(/<[^>]*>?/gm, '') : "Î— Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… Î¦Ï‰Ï„ÏŒÏ‚");
            setVal('admin-phone', globalTexts.phone || "+30 6973 807 097");
            setVal('admin-insta', globalTexts.instagram || "#");
            setVal('admin-fb', globalTexts.facebook || "#");
            setVal('admin-pin', globalTexts.pinterest || "#");
            setVal('admin-color-primary', globalGraphics.primary || '#fbc02d');
            setVal('admin-glass-opacity', globalGraphics.opacity || '0.6');
            setVal('admin-glow-start', globalGraphics.glowStart || '#fbc02d');
            setVal('admin-glow-end', globalGraphics.glowEnd || '#b71c1c');
            setVal('admin-spin-speed', globalGraphics.spinSpeed || '60');
            
            // AI Key
            if(document.getElementById('gemini-api-key')) document.getElementById('gemini-api-key').value = geminiKey;
        }

        function saveGlobalSettings() {
            const getVal = (id) => { const el = document.getElementById(id); return el ? el.value : ""; };
            globalTexts.heroTitle = getVal('admin-hero-title');
            globalTexts.phone = getVal('admin-phone');
            globalTexts.instagram = getVal('admin-insta');
            globalTexts.facebook = getVal('admin-fb');
            globalTexts.pinterest = getVal('admin-pin');
            globalGraphics.primary = getVal('admin-color-primary');
            globalGraphics.opacity = getVal('admin-glass-opacity');
            globalGraphics.glowStart = getVal('admin-glow-start');
            globalGraphics.glowEnd = getVal('admin-glow-end');
            globalGraphics.spinSpeed = getVal('admin-spin-speed');
            localStorage.setItem('vitro_texts', JSON.stringify(globalTexts));
            localStorage.setItem('vitro_graphics', JSON.stringify(globalGraphics));
            scheduleServerSave();
            showToast('ÎŸÎ¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!');
        }

        // --- AUTH FUNCTIONS ---
        function openAdminLogin() { 
            document.getElementById('admin-login-modal').classList.remove('hidden'); 
            if (isAdmin) {
                document.getElementById('admin-login-form').classList.add('hidden');
                document.getElementById('admin-logout-view').classList.remove('hidden');
            } else {
                document.getElementById('admin-login-form').classList.remove('hidden');
                document.getElementById('admin-logout-view').classList.add('hidden');
                setTimeout(() => document.getElementById('admin-password').focus(), 100);
            }
        }
        function closeAdminLogin() { document.getElementById('admin-login-modal').classList.add('hidden'); }

        function attemptAdminLogin() {
            const pass = document.getElementById('admin-password').value;
            if (pass === '1111') {
                isAdmin = true;
                localStorage.setItem('vitro_isAdmin', 'true'); 
                document.getElementById('nav-admin-link').classList.remove('hidden');
                document.getElementById('nav-logout-link').classList.remove('hidden');
                document.getElementById('mobile-nav-admin-link').classList.remove('hidden');
                document.getElementById('mobile-nav-logout-link').classList.remove('hidden');
                document.body.classList.add('admin-mode');
                enableImageDropZones();
                initModalUploadZones();
                checkMaintenance(); // Refresh maintenance view
                showToast('ÎšÎ±Î»Ï‰ÏƒÎ®ÏÎ¸Î±Ï„Îµ! Î¤Î¿ Drag & Drop ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ.');
                closeAdminLogin();
                document.getElementById('admin-password').value = ''; 
                showAdminDashboard(null);
            } else {
                showToast('Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!');
                document.getElementById('admin-password').value = '';
            }
        }

        if (isAdmin) {
            document.getElementById('nav-admin-link').classList.remove('hidden');
            document.getElementById('nav-logout-link').classList.remove('hidden');
            document.getElementById('mobile-nav-admin-link').classList.remove('hidden');
            document.getElementById('mobile-nav-logout-link').classList.remove('hidden');
            document.body.classList.add('admin-mode');
            enableImageDropZones();
            initModalUploadZones();
        }

        function adminLogout(e) {
            if(e) e.preventDefault();
            isAdmin = false;
            localStorage.removeItem('vitro_isAdmin'); 
            localStorage.removeItem('vitro_active_view');
            document.getElementById('nav-admin-link').classList.add('hidden');
            document.getElementById('nav-logout-link').classList.add('hidden');
            document.getElementById('mobile-nav-admin-link').classList.add('hidden');
            document.getElementById('mobile-nav-logout-link').classList.add('hidden');
            document.body.classList.remove('admin-mode');
            showToast('Î‘Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸Î®ÎºÎ±Ï„Îµ.');
            closeAdminLogin();
            
            // Check maintenance again - if active, user will see under construction
            checkMaintenance();
            if(!isMaintenance) showLanding(true);
        }

        // --- PLACEHOLDER LINKS ---
        // Add listeners to empty links
        function initEmptyLinks() {
            document.querySelectorAll('a[href="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    showToast('Coming Soon / Î¥Ï€ÏŒ ÎšÎ±Ï„Î±ÏƒÎºÎµÏ…Î®');
                });
            });
        }

        // --- IMAGE EDITING & STOCK TOGGLE CLICK ---
        function handleImageClick(element, type, id) {
            if (!isAdmin) return;
            if (event) event.preventDefault();
            if (event) event.stopPropagation();

            if (type === 'product') {
                const prod = products.find(p => p.id === id);
                if (prod) {
                    if (prod.stock === 'in-stock') prod.stock = 'made-to-order';
                    else if (prod.stock === 'made-to-order') prod.stock = 'sold';
                    else prod.stock = 'in-stock';
                    saveProducts();
                    renderProducts(); 
                    let label = "";
                    if (prod.stock === 'in-stock') label = "Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿";
                    else if (prod.stock === 'made-to-order') label = "ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚";
                    else label = "Î•Î¾Î±Î½Ï„Î»Î·Î¼Î­Î½Î¿";
                    showToast(`ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·: ${label}`);
                }
                return;
            }

            const currentUrl = type === 'static' ? (id.endsWith('-bg') ? element.style.backgroundImage.slice(5, -2) : element.src) : element.src;
            const newUrl = prompt("Î•Ï€Î¹ÎºÎ¿Î»Î»Î®ÏƒÏ„Îµ URL Î® Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Drag & Drop:", currentUrl);

            if (newUrl && newUrl !== currentUrl) {
                if (type === 'static') {
                    if (id.endsWith('-bg')) element.style.backgroundImage = `url('${newUrl}')`;
                    else element.src = newUrl;
                    staticImages[id] = newUrl;
                    localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                    showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!');
                } else if (type === 'blog') {
                    const post = blogPosts.find(p => p.id === id);
                    if (post) { post.image = newUrl; saveBlogPosts(); renderBlogList(); showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î¬ÏÎ¸ÏÎ¿Ï… Î¬Î»Î»Î±Î¾Îµ!'); }
                }
            }
        }

        // --- DATA PERSISTENCE HELPERS ---
        function saveProducts() {
            localStorage.setItem('vitro_products', JSON.stringify(products));
            updateAdminTables();
            scheduleServerSave();
        }
        function saveBlogPosts() {
            localStorage.setItem('vitro_blog', JSON.stringify(blogPosts));
            updateAdminTables();
            scheduleServerSave();
        }

        // --- MODAL LOGIC ---
        function openModal() { document.getElementById('contact-modal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('contact-modal').classList.add('hidden'); }
        // NEW: Open Add Modal logic handles both ADD and EDIT now
        function openAddProductModal(editMode = false, productId = null) {
            const modal = document.getElementById('add-product-modal');
            const title = document.getElementById('modal-product-title');
            const idField = document.getElementById('prod-id');
            
            // Reset form
            document.getElementById('prod-name').value = '';
            const __pne = document.getElementById('prod-name-en'); if (__pne) __pne.value = '';
            document.getElementById('prod-price').value = '';
            document.getElementById('prod-discount').value = ''; // Reset discount
            document.getElementById('prod-image').value = '';
            document.getElementById('prod-desc').value = '';
            const __pde = document.getElementById('prod-desc-en'); if (__pde) __pde.value = '';
            idField.value = '';

            if (editMode && productId) {
                const prod = products.find(p => p.id === productId);
                if (prod) {
                    title.innerText = "Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚";
                    idField.value = prod.id;
                    document.getElementById('prod-name').value = (window.VC_LANG?window.VC_LANG.pickLang(prod.name,'el'):prod.name);
                    const __pne2 = document.getElementById('prod-name-en'); if (__pne2) __pne2.value = (window.VC_LANG?window.VC_LANG.pickLang(prod.name,'en'):prod.name);
                    document.getElementById('prod-price').value = prod.price;
                    document.getElementById('prod-discount').value = prod.discount || 0;
                    document.getElementById('prod-category').value = prod.category;
                    document.getElementById('prod-stock').value = prod.stock;
                    document.getElementById('prod-image').value = prod.image;
                    document.getElementById('prod-desc').value = (window.VC_LANG?window.VC_LANG.pickLang(prod.desc,'el'):prod.desc);
                    const __pde2 = document.getElementById('prod-desc-en'); if (__pde2) __pde2.value = (window.VC_LANG?window.VC_LANG.pickLang(prod.desc,'en'):prod.desc);
                }
            } else {
                title.innerText = "ÎÎ­Î¿ Î ÏÎ¿ÏŠÏŒÎ½";
            }
            try { const __img = document.getElementById('prod-image'); if (__img) __img.dispatchEvent(new Event('input')); } catch(e) {}
            modal.classList.remove('hidden'); 
        }
        function closeAddProductModal() { document.getElementById('add-product-modal').classList.add('hidden'); }
        function openAddBlogModal(editMode=false, blogId=null) {
            document.getElementById('add-blog-modal').classList.remove('hidden');

            const idEl = document.getElementById('blog-id');
            const titleEl = document.getElementById('blog-title');
            const titleEnEl = document.getElementById('blog-title-en');
            const dateEl = document.getElementById('blog-date');
            const dateEnEl = document.getElementById('blog-date-en');
            const imageEl = document.getElementById('blog-image');
            const contentEl = document.getElementById('blog-content');
            const contentEnEl = document.getElementById('blog-content-en');

            // Clear by default
            if (idEl) idEl.value = '';
            if (titleEl) titleEl.value = '';
            if (titleEnEl) titleEnEl.value = '';
            if (dateEl) dateEl.value = '';
            if (dateEnEl) dateEnEl.value = '';
            if (imageEl) imageEl.value = '';
            if (contentEl) contentEl.value = '';
            if (contentEnEl) contentEnEl.value = '';

            if (editMode && blogId != null) {
                const post = blogPosts.find(p => p.id === blogId);
                if (!post) return;

                if (idEl) idEl.value = String(post.id);
                if (titleEl) titleEl.value = (window.VC_LANG ? window.VC_LANG.pickLang(post.title, 'el') : post.title);
                if (titleEnEl) titleEnEl.value = (window.VC_LANG ? window.VC_LANG.pickLang(post.title, 'en') : post.title);
                if (dateEl) dateEl.value = (window.VC_LANG ? window.VC_LANG.pickLang(post.date, 'el') : post.date);
                if (dateEnEl) dateEnEl.value = (window.VC_LANG ? window.VC_LANG.pickLang(post.date, 'en') : post.date);
                if (imageEl) imageEl.value = post.image || '';
                if (contentEl) contentEl.value = (window.VC_LANG ? window.VC_LANG.pickLang(post.content, 'el') : post.content);
                if (contentEnEl) contentEnEl.value = (window.VC_LANG ? window.VC_LANG.pickLang(post.content, 'en') : post.content);
            }
            try { const __img = document.getElementById('blog-image'); if (__img) __img.dispatchEvent(new Event('input')); } catch(e) {}

        }
        function closeAddBlogModal() { document.getElementById('add-blog-modal').classList.add('hidden'); }

        // --- NAVIGATION & TRACKING ---
        function trackView(page) {
            if (analytics.pageViews[page] !== undefined) analytics.pageViews[page]++;
            else analytics.pageViews[page] = 1;
            localStorage.setItem('vitro_analytics', JSON.stringify(analytics));
        }

        function hideAllViews() {
            const ids = [
                'view-landing',
                'view-catalog',
                'view-blog',
                'view-blog-single',
                'view-admin-dashboard',
                'view-maintenance',
            ];
            ids.forEach((id) => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });
        }
        function saveViewState(viewId) { localStorage.setItem('vitro_active_view', viewId); }

        function navigateToSection(e, sectionId) {
            if(e) e.preventDefault();
            if(isMaintenance && !isAdmin) return; // Block nav in maintenance
            hideAllViews();
            document.getElementById('view-landing').classList.remove('hidden');
            saveViewState('view-landing');
            trackView('home');
            if (sectionId) {
                const element = document.getElementById(sectionId);
                if(element) element.scrollIntoView({ behavior: 'smooth' });
                else window.scrollTo({ top: 0, behavior: 'smooth' });
            } else window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Check promo text on view change
            updatePromoText();
        }

        function showLanding(scrollToTop = true) {
            if(isMaintenance && !isAdmin) return;
            hideAllViews();
            document.getElementById('view-landing').classList.remove('hidden');
            saveViewState('view-landing');
            trackView('home');
            if(scrollToTop) window.scrollTo({ top: 0, behavior: 'smooth' });
            updatePromoText();
        }

        
        // --- Shareable Product URLs (public visitors) ---
        function vcParseProductIdFromUrl() {
            try {
                const u = new URL(window.location.href);
                const sp = u.searchParams;
                const raw = sp.get('id') || sp.get('product') || sp.get('pid') || '';
                const n = parseInt(String(raw), 10);
                if (!Number.isFinite(n) || n <= 0) return null;
                return n;
            } catch(e) { return null; }
        }

        function vcUpdateUrlForProduct(id, opts = {}) {
            try {
                if (isAdmin) return; // never touch admin URLs
                const replace = !!opts.replace;
                const u = new URL(window.location.href);
                u.pathname = '/product';
                u.searchParams.set('id', String(id));
                u.searchParams.delete('product');
                u.searchParams.delete('pid');
                u.searchParams.delete('view');
                u.hash = '';
                const next = u.pathname + u.search + u.hash;
                if (replace) window.history.replaceState({ vc: 'product', id }, '', next);
                else window.history.pushState({ vc: 'product', id }, '', next);
            } catch(e) {}
        }

        function vcSetUrlToCatalog(opts = {}) {
            try {
                if (isAdmin) return;
                const replace = !!opts.replace;
                const u = new URL(window.location.href);
                u.pathname = '/';
                u.searchParams.delete('id');
                u.searchParams.delete('product');
                u.searchParams.delete('pid');
                u.searchParams.set('view', 'catalog');
                u.hash = '';
                const next = u.pathname + u.search + u.hash;
                if (replace) window.history.replaceState({ vc: 'catalog' }, '', next);
                else window.history.pushState({ vc: 'catalog' }, '', next);
            } catch(e) {}
        }

        function vcApplyRouteOverrides() {
            // Safe to call many times
            try {
                if (isMaintenance && !isAdmin) return;
                const u = new URL(window.location.href);
                const path = (u.pathname || '/').replace(/\/+$/, '') || '/';
                const sp = u.searchParams;

                const view = (sp.get('view') || '').toLowerCase();
                const id = vcParseProductIdFromUrl();

                // Product route wins
                if (path === '/product' && id) {
                    showCatalog(null);
                    setTimeout(() => {
                        try { openProductDetails(id); } catch(e) {}
                    }, 50);
                    return;
                }

                if (view === 'catalog') { showCatalog(null); return; }
                if (view === 'blog') { showBlog(null); return; }
            } catch(e) {}
        }

        window.addEventListener('popstate', () => {
            try { vcApplyRouteOverrides(); } catch(e) {}
        });

        function showCatalog(e) {
            if(e) e.preventDefault();
            if(isMaintenance && !isAdmin) return;
            hideAllViews();
            document.getElementById('view-catalog').classList.remove('hidden');
            saveViewState('view-catalog');
            trackView('catalog');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            renderProducts(); 
            // Public URL for catalog (unless we are on /product?id=...)
            try {
                if (!isAdmin) {
                    const u = new URL(window.location.href);
                    const path = (u.pathname || '/').replace(/\/+$/, '') || '/';
                    const pid = vcParseProductIdFromUrl();
                    if (!(path === '/product' && pid)) vcSetUrlToCatalog({ replace: true });
                }
            } catch(e) {}

        }

        function showBlog(e) {
            if(e) e.preventDefault();
            if(isMaintenance && !isAdmin) return;
            hideAllViews();
            document.getElementById('view-blog').classList.remove('hidden');
            saveViewState('view-blog');
            trackView('blog');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            renderBlogList();
        }

        function showAdminDashboard(e) {
            if(e) e.preventDefault();
            if (!isAdmin) { openAdminLogin(); return; }
            hideAllViews();
            document.getElementById('view-admin-dashboard')?.classList.remove('hidden');
            saveViewState('view-admin-dashboard');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            updateAdminTables();
            updateStats();
            applyGlobalSettings();
            checkMaintenance(); // Ensure banner state correct
        }

        // --- ADMIN DASHBOARD ---
        function switchAdminTab(tab) {
            const panels = ['products', 'blog', 'general', 'stats', 'system'];
            panels.forEach(p => {
                document.getElementById('admin-panel-' + p).classList.add('hidden');
                const btn = document.getElementById('tab-btn-' + p);
                btn.classList.replace('bg-amber', 'bg-gray-800');
                btn.classList.replace('text-lead', 'text-gray-400');
            });

            document.getElementById('admin-panel-' + tab).classList.remove('hidden');
            const activeBtn = document.getElementById('tab-btn-' + tab);
            activeBtn.classList.replace('bg-gray-800', 'bg-amber');
            activeBtn.classList.replace('text-gray-400', 'text-lead');
            
            if(tab === 'stats') updateStats();
            if(tab === 'system') {
                const dateEl = document.getElementById('next-ai-date');
                if(lastAiDate === 0) dateEl.innerText = "Î†Î¼ÎµÏƒÎ± (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ»ÎµÎ¹Î´Î¯)";
                else {
                    const next = new Date(lastAiDate + (7 * 24 * 60 * 60 * 1000));
                    dateEl.innerText = next.toLocaleDateString('el-GR');
                }
            }
        }

        function updateStats() {
            // Random Online Users (Simulation)
            const online = Math.floor(Math.random() * 10) + 2; 
            document.getElementById('stat-online-users').innerText = online;
            document.getElementById('stat-total-visits').innerText = analytics.totalVisits;
            
            // Bars
            const container = document.getElementById('stats-bars');
            container.innerHTML = '';
            const maxViews = Math.max(...Object.values(analytics.pageViews), 1);
            
            const labels = { 'home': 'Î‘ÏÏ‡Î¹ÎºÎ®', 'catalog': 'Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±', 'blog': 'Blog', 'workshops': 'Workshops' };
            
            for (const [key, value] of Object.entries(analytics.pageViews)) {
                if (!labels[key]) continue;
                const percent = (value / maxViews) * 100;
                container.innerHTML += `
                    <div>
                        <div class="flex justify-between text-xs text-gray-400 mb-1">
                            <span>${labels[key]}</span>
                            <span>${value} views</span>
                        </div>
                        <div class="w-full bg-black/50 rounded-full h-2">
                            <div class="stat-bar bg-emerald h-2 rounded-full" style="width: ${percent}%"></div>
                        </div>
                    </div>
                `;
            }
        }

        function updateAdminTables() {
            document.getElementById('stats-products').innerText = products.length;
            document.getElementById('stats-blog').innerText = blogPosts.length;

            const prodTable = document.getElementById('admin-products-table');
            prodTable.innerHTML = '';
            products.forEach(p => {
                prodTable.innerHTML += `
                    <tr class="border-b border-white/5 hover:bg-white/5 transition">
                        <td class="p-3"><img src="${p.image}" onclick="handleImageClick(this, 'product', ${p.id})" class="admin-editable-img w-10 h-10 object-cover rounded cursor-pointer" data-type="product" data-id="${p.id}" title="Drag & Drop Î® click Î³Î¹Î± Î±Î»Î»Î±Î³Î®"></td>
                        <td class="p-3 font-bold text-white">${(window.VC_LANG?window.VC_LANG.pick(p.name):p.name)}</td>
                        <td class="p-3">â‚¬${p.price}</td>
                        <td class="p-3 text-red-400 font-bold">${p.discount > 0 ? '-' + p.discount + '%' : '-'}</td>
                        <td class="p-3 flex gap-2">
                            <button onclick="openAddProductModal(true, ${p.id})" class="text-amber hover:text-yellow-300" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteProduct(${p.id})" class="text-ruby hover:text-red-400" title="Î”Î¹Î±Î³ÏÎ±Ï†Î®"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });

            const blogTable = document.getElementById('admin-blog-table');
            blogTable.innerHTML = '';
            blogPosts.forEach(p => {
                blogTable.innerHTML += `
                    <tr class="border-b border-white/5 hover:bg-white/5 transition">
                        <td class="p-3"><img src="${p.image}" onclick="handleImageClick(this, 'blog', ${p.id})" class="admin-editable-img w-10 h-10 object-cover rounded cursor-pointer" data-type="blog" data-id="${p.id}" title="Drag & Drop Î® click Î³Î¹Î± Î±Î»Î»Î±Î³Î®"></td>
                        <td class="p-3 font-bold text-white">${(window.VC_LANG?window.VC_LANG.pick(p.title):p.title)}</td>
                        <td class="p-3">${(window.VC_LANG?window.VC_LANG.pick(p.date):p.date)}</td>
                        <td class="p-3 text-right"><button onclick="openAddBlogModal(true, ${p.id})" class="text-emerald hover:text-emerald-300 mr-3" title="Edit"><i class="fas fa-pen"></i></button><button onclick="deleteBlogPost(${p.id})" class="text-ruby hover:text-red-400" title="Delete"><i class="fas fa-trash"></i></button></td>
                    </tr>
                `;
            });
            enableImageDropZones();
        }

        function deleteProduct(id) { if(confirm('Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Ï‚;')) { products = products.filter(p => p.id !== id); saveProducts(); showToast('Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ.'); } }
        function deleteBlogPost(id) { if(confirm('Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Ï‚;')) { blogPosts = blogPosts.filter(p => p.id !== id); saveBlogPosts(); showToast('Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ.'); } }

        // --- DATA INIT ---
        let storedProducts = localStorage.getItem('vitro_products');
        let products = storedProducts ? JSON.parse(storedProducts) : [
        {
            id: 1,
            name: { el: "Î’Î¹Ï„ÏÏŒ Î Î±ÏÎ¬Î¸Ï…ÏÎ¿ 'Î‘Î½Î±Î³Î­Î½Î½Î·ÏƒÎ·'", en: "Stained Glass Window 'Renaissance'" },
            price: "â‚¬450",
            desc: { el: "Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î¿ Î²Î¹Ï„ÏÏŒ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ Î¼Îµ Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¹ÎºÎ¬ Î¼Î¿Ï„Î¯Î²Î± ÎºÎ±Î¹ Î­Î½Ï„Î¿Î½ÎµÏ‚ Î±Ï€Î¿Ï‡ÏÏÏƒÎµÎ¹Ï‚. Î™Î´Î±Î½Î¹ÎºÏŒ Î³Î¹Î± Î½Î± Î´ÏÏƒÎµÎ¹ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎ± ÏƒÎµ ÎºÎ¬Î¸Îµ Ï‡ÏÏÎ¿.", en: "Handcrafted stained-glass window with geometric patterns and bold colors. Perfect for adding character to any space." },
            category: "architectural",
            image: "https://images.unsplash.com/photo-1617545474080-dfbfd7908c38?auto=format&fit=crop&w=900&q=80",
            stock: "made-to-order"
        },
        {
            id: 2,
            name: { el: "ÎšÏÎµÎ¼Î±ÏƒÏ„ÏŒ ÎšÏŒÏƒÎ¼Î·Î¼Î± 'Ruby Bloom'", en: "Pendant 'Ruby Bloom'" },
            price: "â‚¬65",
            desc: { el: "ÎˆÎ½Î± Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ ÎºÏÎµÎ¼Î±ÏƒÏ„ÏŒ ÎºÏŒÏƒÎ¼Î·Î¼Î± Î¼Îµ ÎºÏŒÎºÎºÎ¹Î½ÎµÏ‚ ÎºÎ±Î¹ Ï‡ÏÏ…ÏƒÎ­Ï‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚. Î¦Ï„Î¹Î±Î³Î¼Î­Î½Î¿ Î±Ï€ÏŒ Î³Ï…Î±Î»Î¯ ÎºÎ±Î¹ Î¿ÏÎµÎ¯Ï‡Î±Î»ÎºÎ¿.", en: "A unique pendant with red and gold details, crafted from glass and brass." },
            category: "jewelry",
            image: "https://images.unsplash.com/photo-1600185365926-3a2ce3cdb9eb?auto=format&fit=crop&w=900&q=80",
            stock: "in-stock"
        },
        {
            id: 3,
            name: { el: "Î¦Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÏŒ Tiffany 'Emerald Night'", en: "Tiffany Lamp 'Emerald Night'" },
            price: "â‚¬320",
            desc: { el: "Î¦Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÏŒ Ï„ÏÏ€Î¿Ï… Tiffany Î¼Îµ ÏƒÎ¼Î±ÏÎ±Î³Î´Î¯ ÎºÎ±Î¹ Î¼Ï€Î»Îµ Ï„ÏŒÎ½Î¿Ï…Ï‚. Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î¶ÎµÏƒÏ„Î® Î±Ï„Î¼ÏŒÏƒÏ†Î±Î¹ÏÎ± ÎºÎ±Î¹ ÎµÎ½Ï„Ï…Ï€Ï‰ÏƒÎ¹Î¬Î¶ÎµÎ¹.", en: "Tiffany-style lamp in emerald and blue tones. Creates a warm atmosphere and stands out beautifully." },
            category: "lighting",
            image: "https://images.unsplash.com/photo-1565962212001-74a3d1b8e3f7?auto=format&fit=crop&w=900&q=80",
            stock: "made-to-order"
        },
        {
            id: 4,
            name: { el: "Î”Î¹Î±ÎºÎ¿ÏƒÎ¼Î·Ï„Î¹ÎºÏŒ Î Î¬Î½ÎµÎ» 'Î‘Î¹Î³Î±Î¯Î¿'", en: "Decorative Panel 'Aegean'" },
            price: "â‚¬180",
            desc: { el: "Î”Î¹Î±ÎºÎ¿ÏƒÎ¼Î·Ï„Î¹ÎºÏŒ Ï€Î¬Î½ÎµÎ» ÎµÎ¼Ï€Î½ÎµÏ…ÏƒÎ¼Î­Î½Î¿ Î±Ï€ÏŒ Ï„Î± Ï‡ÏÏÎ¼Î±Ï„Î± Ï„Î¿Ï… Î‘Î¹Î³Î±Î¯Î¿Ï…. Î¤Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ ÏƒÎµ Ï„Î¿Î¯Ï‡Î¿ Î® Ï‰Ï‚ Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ.", en: "A decorative panel inspired by the colors of the Aegean. Suitable for a wall display or as a room divider." },
            category: "decor",
            image: "https://images.unsplash.com/photo-1576502200916-3808e07386a5?auto=format&fit=crop&w=900&q=80",
            stock: "in-stock"
        }
        ];
        function renderProducts() {
            const grid = document.getElementById('catalog-grid');
            if(!grid) return;
            grid.innerHTML = ''; 
            products.forEach(prod => {
                let stockColor = prod.stock === 'in-stock' ? 'text-emerald' : (prod.stock === 'sold' ? 'text-ruby' : 'text-amber');
                let stockText = (function(code){
                const lang = (window.VC_LANG && window.VC_LANG.get) ? window.VC_LANG.get() : 'el';
                const dict = (window.VC_I18N && (window.VC_I18N[lang] || window.VC_I18N.el)) || {};
                if (code === 'in-stock') return dict.stock_in || 'Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿';
                if (code === 'sold') return dict.stock_sold || 'Î•Î¾Î±Î½Ï„Î»Î®Î¸Î·ÎºÎµ';
                return dict.stock_made || 'ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚';
            })(prod.stock);
                
                // PRICE CALCULATION LOGIC
                let priceDisplay = `<span class="text-amber font-serif font-bold text-xl">â‚¬${prod.price}</span>`;
                let discountBadge = '';
                
                // Convert string prices to float safely if needed (though inputs are number)
                let numericPrice = parseFloat(prod.price);
                
                if (prod.discount && prod.discount > 0 && !isNaN(numericPrice)) {
                    let discountedPrice = (numericPrice * (1 - (prod.discount / 100))).toFixed(2);
                    priceDisplay = `
                        <div class="flex flex-col items-end">
                             <span class="text-xs text-gray-500 line-through decoration-red-500/50">â‚¬${prod.price}</span>
                             <span class="text-ruby font-serif font-bold text-xl">â‚¬${discountedPrice}</span>
                        </div>
                    `;
                    discountBadge = `<div class="absolute top-2 left-2 bg-ruby text-white px-2 py-1 rounded text-xs font-bold shadow-lg z-10 animate-pulse">-${prod.discount}%</div>`;
                }

                // If price is text (e.g. "ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î•ÎºÏ„Î¯Î¼Î·ÏƒÎ·Ï‚"), display as is
                if (isNaN(numericPrice)) {
                    priceDisplay = `<span class="text-amber font-serif font-bold text-sm">${prod.price}</span>`;
                    discountBadge = '';
                }

                // ADDED EDIT BUTTON FOR ADMIN
                let adminEditBtn = '';
                if(isAdmin) {
                    adminEditBtn = `<button onclick="event.stopPropagation(); openAddProductModal(true, ${prod.id})" class="text-emerald hover:text-white mr-3 p-2 rounded-full hover:bg-white/10 transition" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î¤Î¹Î¼Î®Ï‚/ÎˆÎºÏ€Ï„Ï‰ÏƒÎ·Ï‚"><i class="fas fa-pencil-alt"></i></button>`;
                }

                grid.innerHTML += `
                    <div class="glass-card rounded-xl overflow-hidden group flex flex-col h-full relative cursor-pointer" onclick="openProductDetails(${prod.id})">
                        ${discountBadge}
                        <div class="h-64 overflow-hidden relative">
                            <img src="${prod.image}" alt="${(window.VC_LANG?window.VC_LANG.pick(prod.name):prod.name)}" onclick="if(isAdmin){event.stopPropagation(); handleImageClick(this, 'product', ${prod.id});} else {openProductDetails(${prod.id});}" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="product" data-id="${prod.id}">
                            <div class="absolute top-2 right-2 bg-black/70 px-2 py-1 rounded text-xs font-bold ${stockColor} pointer-events-none">${stockText}</div>
                        </div>
                        <div class="p-5 flex-grow flex flex-col">
                            <h3 class="text-lg font-bold text-white mb-1">${(window.VC_LANG?window.VC_LANG.pick(prod.name):prod.name)}</h3>
                            <p class="text-gray-400 text-xs mb-3 flex-grow">${(window.VC_LANG?window.VC_LANG.pick(prod.desc):prod.desc)}</p>
                            <div class="mt-auto flex items-center justify-between border-t border-white/10 pt-3">
                                ${priceDisplay}
                                <div class="flex items-center">
                                    ${adminEditBtn}
                                    <button onclick="event.stopPropagation(); openModal()" class="text-white hover:text-amber transition" title="Request a Quote"><i class="fas fa-shopping-bag"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>`;
            });
            enableImageDropZones(); 
        }


        // --- PRODUCT DETAILS BOX (Catalog View) ---
        function scrollToCatalogGrid() {
            const grid = document.getElementById('catalog-grid');
            if (grid) grid.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function closeProductDetails() {
            const box = document.getElementById('product-details-box');
            if (box) box.classList.add('hidden');
            window.__currentProductId = null;
            try {
                if (!isAdmin) vcSetUrlToCatalog({ replace: true });
            } catch(e) {}

        }

        function openProductDetails(id) {
            const box = document.getElementById('product-details-box');
            if (!box) return;

            const prod = products.find(p => p.id === id);
            if (!prod) return;

            window.__currentProductId = id;

            // Shareable URL for public visitors: /product?id=123
            try {
                if (!isAdmin) {
                    const u = new URL(window.location.href);
                    const path = (u.pathname || '/').replace(/\/+$/, '') || '/';
                    const cur = vcParseProductIdFromUrl();
                    const replace = (path === '/product' && cur === id);
                    vcUpdateUrlForProduct(id, { replace });
                }
            } catch(e) {}


            const lang = (window.VC_LANG && window.VC_LANG.get) ? window.VC_LANG.get() : 'el';
            const dict = (window.VC_I18N && (window.VC_I18N[lang] || window.VC_I18N.el)) || {};

            const pick = (v) => (window.VC_LANG && window.VC_LANG.pick) ? window.VC_LANG.pick(v) : (v?.el || v);

            const name = pick(prod.name);
            const desc = pick(prod.desc);

            // Stock label
            const stockText = (function(code){
                if (code === 'in-stock') return dict.stock_in || 'Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿';
                if (code === 'sold') return dict.stock_sold || 'Î•Î¾Î±Î½Ï„Î»Î®Î¸Î·ÎºÎµ';
                return dict.stock_made || 'ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚';
        })(prod.stock);

            // Price label (handles â‚¬ strings)
            const rawPrice = String(prod.price ?? '').replace('â‚¬','').trim();
            const numeric = parseFloat(rawPrice);
            let priceLabel = '';
            if (!isNaN(numeric)) {
                if (prod.discount && prod.discount > 0) {
                    const discounted = (numeric * (1 - (prod.discount / 100))).toFixed(2);
                    priceLabel = `â‚¬${discounted}  ( -${prod.discount}% )`;
                } else {
                    priceLabel = `â‚¬${numeric.toFixed(2)}`;
                }
            } else {
                priceLabel = String(prod.price ?? '');
            }

            const img = document.getElementById('pd-image');
            const nameEl = document.getElementById('pd-name');
            const priceEl = document.getElementById('pd-price');
            const stockEl = document.getElementById('pd-stock');
            const catEl = document.getElementById('pd-category');
            const descEl = document.getElementById('pd-desc');

            if (img) { img.src = prod.image || ''; img.alt = name || ''; }
            if (nameEl) nameEl.textContent = name || '';
            if (priceEl) priceEl.textContent = priceLabel;
            if (stockEl) stockEl.textContent = stockText;
            if (catEl) catEl.textContent = prod.category || '';
            if (descEl) descEl.textContent = desc || '';

            // Ensure labels match language
            const dLabel = document.getElementById('pd-desc-label');
            const qBtn = document.getElementById('pd-quote-btn-text');
            const bBtn = document.getElementById('pd-back-btn-text');
            if (dLabel) dLabel.textContent = dict.pd_desc_label || 'Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®';
            if (qBtn) qBtn.textContent = dict.pd_quote_btn || 'Î–Î·Ï„Î®ÏƒÏ„Îµ Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬';
            if (bBtn) bBtn.textContent = dict.pd_back_to_products || 'Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±';

            box.classList.remove('hidden');
            box.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function openQuoteForCurrentProduct() {
            try {
                const id = window.__currentProductId;
                const prod = products.find(p => p.id === id);
                if (prod) {
                    const pick = (v) => (window.VC_LANG && window.VC_LANG.pick) ? window.VC_LANG.pick(v) : (v?.el || v);
                    const name = pick(prod.name);
                    const msgEl = document.getElementById('q-textarea-message');
                    if (msgEl) {
                        msgEl.value = `Î˜Î­Î»Ï‰ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ¬ Î³Î¹Î±: ${name}`;
                    }
                }
            } catch(e) {}
            openModal();
        }

        // PROMO TEXT LOGIC
        function updatePromoText() {
            const promo = document.getElementById('hero-promo-text');
            if(!promo) return;
            
            // Check if any product has discount > 0
            const hasDiscounts = products.some(p => p.discount > 0);
            
            if (hasDiscounts) {
                promo.classList.remove('hidden');
            } else {
                promo.classList.add('hidden');
            }
        }

        // GLOBAL DISCOUNT LOGIC
        function applyGlobalDiscount() {
            const inputVal = document.getElementById('global-discount').value;
            if (!inputVal) { showToast("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€Î¿ÏƒÎ¿ÏƒÏ„ÏŒ."); return; }
            
            const percent = parseInt(inputVal);
            if (isNaN(percent) || percent < 0 || percent > 100) {
                showToast("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÎ¿ÏƒÏ„ÏŒ (0-100).");
                return;
            }
            
            if(confirm(`Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Î¹ ÏŒÏ„Î¹ Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÏ„Îµ Î­ÎºÏ€Ï„Ï‰ÏƒÎ· ${percent}% ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î±;`)) {
                products.forEach(p => {
                    // Only apply to numeric prices
                    if (!isNaN(parseFloat(p.price))) {
                        p.discount = percent;
                    }
                });
                saveProducts();
                renderProducts(); // Update catalog view (if visible or cached)
                updateAdminTables(); // IMPORTANT: Update admin table immediately
                updatePromoText(); // Update hero text
                showToast(`Î— Î­ÎºÏ€Ï„Ï‰ÏƒÎ· ${percent}% ÎµÏ†Î±ÏÎ¼ÏŒÏƒÏ„Î·ÎºÎµ ÏƒÎµ ÏŒÎ»Î±!`);
            }
        }

        let storedBlog = localStorage.getItem('vitro_blog');
        let blogPosts = storedBlog ? JSON.parse(storedBlog) : [
            {
                id: 1,
                date: "20 Î™Î±Î½ 2026",
                image: "https://images.unsplash.com/photo-1579965342575-16428a7c8d71?auto=format&fit=crop&w=800&q=80",
                title: "Î— Î•Ï€Î±Î½Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ Î¤ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Tiffany",
                content: `...`
            },
            // ... (rest of default blog posts) ...
        ];
        // Ensure default blog content is populated
         if (!storedBlog) {
            blogPosts = [
                {
                    id: 1,
                    date: "20 Î™Î±Î½ 2026",
                    image: "https://images.unsplash.com/photo-1579965342575-16428a7c8d71?auto=format&fit=crop&w=800&q=80",
                    title: "Î— Î•Ï€Î±Î½Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ Î¤ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Tiffany",
                    content: `<p class="mb-4">ÎŸ Louis Comfort Tiffany, Î³Î¹Î¿Ï‚ Ï„Î¿Ï… Î´Î¹Î¬ÏƒÎ·Î¼Î¿Ï… ÎºÎ¿ÏƒÎ¼Î·Î¼Î±Ï„Î¿Ï€ÏÎ»Î· Charles Lewis Tiffany, Î¬Î»Î»Î±Î¾Îµ Î³Î¹Î± Ï€Î¬Î½Ï„Î± Ï„Î·Î½ Î¹ÏƒÏ„Î¿ÏÎ¯Î± Ï„Î¿Ï… Î²Î¹Ï„ÏÏŒ ÏƒÏ„Î± Ï„Î­Î»Î· Ï„Î¿Ï… 19Î¿Ï… Î±Î¹ÏÎ½Î±. ÎœÎ­Ï‡ÏÎ¹ Ï„ÏŒÏ„Îµ, Î· ÎºÏ…ÏÎ¯Î±ÏÏ‡Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î®Ï„Î±Î½ Î±Ï…Ï„Î® Ï„Î¿Ï… Î¼Î¿Î»ÏÎ²Î´Î¿Ï… (lead came), Î· Î¿Ï€Î¿Î¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÏƒÎµ Ï‡Î¿Î½Ï„ÏÎ¬ Ï€ÏÎ¿Ï†Î¯Î» Î¼Î¿Î»ÏÎ²Î´Î¿Ï… Î³Î¹Î± Î½Î± ÏƒÏ…Î³ÎºÏÎ±Ï„ÎµÎ¯ Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Ï„Î¿Ï… Î³Ï…Î±Î»Î¹Î¿Ï. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚, Î±Î½ ÎºÎ±Î¹ ÏƒÏ„Î¹Î²Î±ÏÎ® ÎºÎ±Î¹ Î¹Î´Î±Î½Î¹ÎºÎ® Î³Î¹Î± Î¼ÎµÎ³Î¬Î»Î± ÎµÎºÎºÎ»Î·ÏƒÎ¹Î±ÏƒÏ„Î¹ÎºÎ¬ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ±, Ï€ÎµÏÎ¹ÏŒÏÎ¹Î¶Îµ Ï„Î· Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹Î± ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î¿Î»Ï…Ï€Î»Î¿ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ ÏƒÏ‡ÎµÎ´Î¯Ï‰Î½.</p>
                    <p class="mb-4">ÎŸ Tiffany ÎµÎ¹ÏƒÎ®Î³Î±Î³Îµ Ï„Î·Î½ ÎµÏ€Î±Î½Î±ÏƒÏ„Î±Ï„Î¹ÎºÎ® Ï„ÎµÏ‡Î½Î¹ÎºÎ® Ï„Î¿Ï… Ï†ÏÎ»Î»Î¿Ï… Ï‡Î±Î»ÎºÎ¿Ï (copper foil). Î‘Î½Ï„Î¯ Î³Î¹Î± Î¼ÏŒÎ»Ï…Î²Î´Î¿, ÎºÎ¬Î¸Îµ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î³Ï…Î±Î»Î¹Î¿Ï Ï„Ï…Î»Î¯Î³ÎµÏ„Î±Î¹ Ï€ÎµÏÎ¹Î¼ÎµÏ„ÏÎ¹ÎºÎ¬ Î¼Îµ Î¼Î¹Î± Ï€Î¿Î»Ï Î»ÎµÏ€Ï„Î®, Î±Ï…Ï„Î¿ÎºÏŒÎ»Î»Î·Ï„Î· Ï„Î±Î¹Î½Î¯Î± Ï‡Î±Î»ÎºÎ¿Ï. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ Î¼Î±Î¶Î¯ ÎºÎ±Î¹ ÏƒÏ…Î³ÎºÎ¿Î»Î»ÏÎ½Ï„Î±Î¹ Î¼Îµ ÎºÎ±ÏƒÏƒÎ¯Ï„ÎµÏÎ¿. Î‘Ï…Ï„ÏŒ ÎµÏ€Î­Ï„ÏÎµÏˆÎµ Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Î»ÎµÏ€Ï„ÎµÏ€Î¯Î»ÎµÏ€Ï„Ï‰Î½ ÏƒÏ‡ÎµÎ´Î¯Ï‰Î½, Î¼Îµ Ï€Î¿Î»Ï Ï€Î¹Î¿ ÏƒÏ„ÎµÎ½Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Î½Ï‰ÏƒÎ·Ï‚, Î´Î¯Î½Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î¿ Î­ÏÎ³Î¿ Î¼Î¹Î± Ï€Î¹Î¿ Î±Î½Î¬Î»Î±Ï†ÏÎ· ÎºÎ±Î¹ Î¿ÏÎ³Î±Î½Î¹ÎºÎ® Î±Î¯ÏƒÎ¸Î·ÏƒÎ·.</p>`
                },
                {
                    id: 2,
                    date: "15 Î”ÎµÎº 2025",
                    image: "https://images.unsplash.com/photo-1621252179027-94459d27d3ee?auto=format&fit=crop&w=800&q=80",
                    title: "Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ· Î’Î¹Ï„ÏÏŒ: Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÏƒÎ­Ï‡ÎµÏ„Îµ",
                    content: `<p class="mb-4">Î¤Î± Î²Î¹Ï„ÏÏŒ ÎµÎ¯Î½Î±Î¹ Î­ÏÎ³Î± Ï„Î­Ï‡Î½Î·Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Ï„Î­Î¾Î¿Ï…Î½ Î±Î¹ÏÎ½ÎµÏ‚, Î±ÏÎºÎµÎ¯ Î½Î± ÏƒÏ…Î½Ï„Î·ÏÎ¿ÏÎ½Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬. Î Î¿Î»Î»Î¿Î¯ Î½Î¿Î¼Î¯Î¶Î¿Ï…Î½ ÏŒÏ„Î¹ Ï„Î¿ Î³Ï…Î±Î»Î¯ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î¿ Î¼Î­ÏÎ¿Ï‚, Î±Î»Î»Î¬ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±, Î¿ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ ÎµÏ‡Î¸ÏÏŒÏ‚ ÎµÎ½ÏŒÏ‚ Î²Î¹Ï„ÏÏŒ ÎµÎ¯Î½Î±Î¹ Î¿ ÏƒÎºÎµÎ»ÎµÏ„ÏŒÏ‚ Ï„Î¿Ï… ÎºÎ±Î¹ Î¿ Ï‡ÏÏŒÎ½Î¿Ï‚. ÎŸ Î¼ÏŒÎ»Ï…Î²Î´Î¿Ï‚ (lead came) Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î± Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ¬ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ±, ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¼Î±Î»Î±ÎºÏŒ Î¼Î­Ï„Î±Î»Î»Î¿. ÎœÎµ Ï„Î·Î½ Ï€Î¬ÏÎ¿Î´Î¿ Ï„Ï‰Î½ Î´ÎµÎºÎ±ÎµÏ„Î¹ÏÎ½, Î¿ Î¼ÏŒÎ»Ï…Î²Î´Î¿Ï‚ Î¿Î¾ÎµÎ¹Î´ÏÎ½ÎµÏ„Î±Î¹, Ï‡Î¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎ»Î±ÏƒÏ„Î¹ÎºÏŒÏ„Î·Ï„Î¬ Ï„Î¿Ï… ÎºÎ±Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÏÎ¸ÏÎ±Ï…ÏƒÏ„Î¿Ï‚. Î‘Ï…Ï„ÏŒ Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "ÎºÏŒÏ€Ï‰ÏƒÎ· Î¼Ï„Î¬Î»Î»Î¿Ï…".</p>`
                },
                {
                    id: 3,
                    date: "10 ÎÎ¿Îµ 2025",
                    image: "https://images.unsplash.com/photo-1563293886-27154256621f?auto=format&fit=crop&w=800&q=80",
                    title: "Î¤Î¿ ÎœÏ…ÏƒÏ„Î®ÏÎ¹Î¿ Ï„Î¿Ï… ÎœÏ€Î»Îµ Ï„Î·Ï‚ Chartres",
                    content: `<p class="mb-4">ÎŸ ÎšÎ±Î¸ÎµÎ´ÏÎ¹ÎºÏŒÏ‚ ÎÎ±ÏŒÏ‚ Ï„Î·Ï‚ Chartres ÏƒÏ„Î· Î“Î±Î»Î»Î¯Î± Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ Î³Î¹Î± Ï„Î± Î²Î¹Ï„ÏÏŒ Ï„Î¿Ï… 12Î¿Ï… ÎºÎ±Î¹ 13Î¿Ï… Î±Î¹ÏÎ½Î±, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¸ÎµÏ‰ÏÎ¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± Ï‰ÏÎ±Î¹ÏŒÏ„ÎµÏÎ± ÎºÎ±Î¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ± Î´Î¹Î±Ï„Î·ÏÎ·Î¼Î­Î½Î± ÏƒÏ„Î¿Î½ ÎºÏŒÏƒÎ¼Î¿. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Ï€Î±ÏƒÏ‡Î¿Î»Î®ÏƒÎµÎ¹ Ï„Î¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿ÏÏ‚ Ï„Î­Ï‡Î½Î·Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï…Ï‚ ÎµÏ€Î¹ÏƒÏ„Î®Î¼Î¿Î½ÎµÏ‚ Î³Î¹Î± Î±Î¹ÏÎ½ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€ÎµÏÎ¯Ï†Î·Î¼Î¿ "ÎœÏ€Î»Îµ Ï„Î·Ï‚ Chartres" (Bleu de Chartres). ÎˆÎ½Î± Î²Î±Î¸Ï, Ï†Ï‰Ï„ÎµÎ¹Î½ÏŒ, ÏƒÏ‡ÎµÎ´ÏŒÎ½ Ï…Ï€ÎµÏÏ†Ï…ÏƒÎ¹ÎºÏŒ Î¼Ï€Î»Îµ Ï‡ÏÏÎ¼Î± Ï€Î¿Ï… ÎºÏ…ÏÎ¹Î±ÏÏ‡ÎµÎ¯ ÏƒÏ„Î± Ï€Î±ÏÎ¬Î¸Ï…ÏÎ± ÎºÎ±Î¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î¼Î¹Î± Î¼Ï…ÏƒÏ„Î·ÏÎ¹Î±ÎºÎ® Î±Ï„Î¼ÏŒÏƒÏ†Î±Î¹ÏÎ± ÏƒÏ„Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒ Ï„Î¿Ï… Î½Î±Î¿Ï.</p>`
                },
                {
                    id: 4,
                    date: "05 ÎŸÎºÏ„ 2025",
                    image: "https://images.unsplash.com/photo-1518640467707-6811f4a6ab73?auto=format&fit=crop&w=800&q=80",
                    title: "Art Deco ÎºÎ±Î¹ Î’Î¹Ï„ÏÏŒ: Î“ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î± ÎºÎ±Î¹ Î£Ï„Ï…Î»",
                    content: `<p class="mb-4">Î— Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ Art Deco (1920-1940) Î­Ï†ÎµÏÎµ Î¼Î¹Î± Î´ÏÎ±Î¼Î±Ï„Î¹ÎºÎ® Î±Î»Î»Î±Î³Î® ÏƒÏ„Î·Î½ Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ® Ï„Î¿Ï… Î²Î¹Ï„ÏÏŒ. ÎÎµÏ†ÎµÏÎ³Î¿Î½Ï„Î±Ï‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ Ï†Ï…ÏƒÎ¹ÎºÎ­Ï‚, ÎºÎ±Î¼Ï€ÏÎ»ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎºÎ±Î¹ Ï„Î± Î»Î¿Ï…Î»Î¿Ï…Î´Î¬Ï„Î± Î¼Î¿Ï„Î¯Î²Î± Ï„Î·Ï‚ Art Nouveau, Ï„Î¿ Art Deco Î±Î³ÎºÎ¬Î»Î¹Î±ÏƒÎµ Ï„Î· Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î±, Ï„Î· ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¯Î± ÎºÎ±Î¹ Ï„Î¿Î½ Î¼Î¿Î½Ï„ÎµÏÎ½Î¹ÏƒÎ¼ÏŒ.</p>`
                }
            ];
        }

        function renderBlogList() {
            const container = document.getElementById('blog-list-container');
            container.innerHTML = '';
            blogPosts.forEach(post => {
                container.innerHTML += `<div class="glass-card p-8 rounded-2xl border-l-4 border-amber relative hover:bg-white/5 transition-all"><div class="flex flex-col md:flex-row gap-6"><div class="md:w-1/4 flex flex-col items-center md:items-start text-amber font-serif"><span class="text-gray-500 mt-1 text-sm font-sans">${(window.VC_LANG?window.VC_LANG.pick(post.date):post.date)}</span><img src="${post.image}" alt="${(window.VC_LANG?window.VC_LANG.pick(post.title):post.title)}" onclick="handleImageClick(this, 'blog', ${post.id})" class="admin-editable-img mt-4 rounded-lg w-full h-32 object-cover border border-white/10 shadow-lg" data-type="blog" data-id="${post.id}"></div><div class="md:w-3/4"><h3 class="text-2xl font-bold text-white mb-3 hover:text-amber transition cursor-pointer" onclick="openBlogPost(${post.id})">${(window.VC_LANG?window.VC_LANG.pick(post.title):post.title)}</h3><div class="text-gray-300 leading-relaxed mb-4 line-clamp-6 text-sm md:text-base">${(window.VC_LANG?window.VC_LANG.pick(post.content):post.content)}</div><button onclick="openBlogPost(${post.id})" class="text-amber text-sm font-bold hover:underline">${(window.VC_I18N && window.VC_LANG ? ((window.VC_I18N[window.VC_LANG.get()]||window.VC_I18N.el).blog_read_more || 'Read more') : 'Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ±')} <i class="fas fa-arrow-right ml-1"></i></button></div></div></div>`;
            });
            enableImageDropZones(); // Re-enable drag zones after render
        }

        function openBlogPost(id) {
            window.__currentBlogId = id;
            const post = blogPosts.find(p => p.id === id);
            if (!post) return;
            const contentContainer = document.getElementById('blog-single-content');
            contentContainer.innerHTML = `<div class="border-b border-white/10 pb-6 mb-6"><span class="text-amber font-serif text-sm tracking-widest">${(window.VC_LANG?window.VC_LANG.pick(post.date):post.date)}</span><h1 class="text-3xl md:text-5xl font-bold text-white mt-2 font-serif">${(window.VC_LANG?window.VC_LANG.pick(post.title):post.title)}</h1></div><img src="${post.image}" alt="${(window.VC_LANG?window.VC_LANG.pick(post.title):post.title)}" class="w-full h-64 md:h-96 object-cover rounded-xl mb-8 border border-white/10 shadow-2xl"><div class="text-gray-300 leading-loose text-lg space-y-6">${(window.VC_LANG?window.VC_LANG.pick(post.content):post.content)}</div>`;
            document.getElementById('view-blog').classList.add('hidden');
            document.getElementById('view-blog-single').classList.remove('hidden');
            saveViewState('view-blog-single');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Updated Handle Add/Edit Product
        function handleAddProduct() {
            const idField = document.getElementById('prod-id').value;
            const nameEl = document.getElementById('prod-name').value;
            const nameEn = (document.getElementById('prod-name-en')?.value || '').trim() || nameEl;
            const price = document.getElementById('prod-price').value;
            const category = document.getElementById('prod-category').value;
            const stock = document.getElementById('prod-stock').value;
            const image = document.getElementById('prod-image').value;
            const descEl = document.getElementById('prod-desc').value;
            const descEn = (document.getElementById('prod-desc-en')?.value || '').trim() || descEl;
            const name = { el: nameEl, en: nameEn };
            const desc = { el: descEl, en: descEn };
            const discount = document.getElementById('prod-discount').value || 0; // Get discount

            if (idField) {
                // EDIT EXISTING
                const index = products.findIndex(p => p.id == idField);
                if (index !== -1) {
                    products[index] = {
                        ...products[index], // keep existing props
                        name, price, category, stock, image, desc, discount
                    };
                    showToast('Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!');
                }
            } else {
                // ADD NEW
                const newProd = {
                    id: Date.now(),
                    name, price, category, stock, image, desc, discount
                };
                products.unshift(newProd);
                showToast('Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!');
            }

            saveProducts();
            renderProducts();
            updatePromoText(); // Check if text needs to show/hide
            closeAddProductModal();
            
            // Check where to return: dashboard or catalog
            const activeView = localStorage.getItem('vitro_active_view');
            if (activeView === 'view-admin-dashboard') {
                showAdminDashboard(null);
            } else {
                // Stay on catalog
            }
        }

        function handleAddBlogPost() {
            const idRaw = (document.getElementById('blog-id')?.value || '').trim();
            const isEdit = Boolean(idRaw);

            const titleEl = document.getElementById('blog-title').value;
            const titleEn = (document.getElementById('blog-title-en')?.value || '').trim() || titleEl;

            const dateEl = document.getElementById('blog-date').value;
            const dateEn = (document.getElementById('blog-date-en')?.value || '').trim() || dateEl;

            const image = document.getElementById('blog-image').value;

            const contentEl = document.getElementById('blog-content').value;
            const contentEn = (document.getElementById('blog-content-en')?.value || '').trim() || contentEl;

            const payload = {
                title: { el: titleEl, en: titleEn },
                date: { el: dateEl, en: dateEn },
                image,
                content: { el: contentEl, en: contentEn }
            };

            if (isEdit) {
                const id = Number(idRaw);
                const idx = blogPosts.findIndex(p => p.id === id);
                if (idx !== -1) {
                    blogPosts[idx] = { ...blogPosts[idx], ...payload, id };
                }
                showToast('Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!');
            } else {
                const newPost = { id: Date.now(), ...payload };
                blogPosts.unshift(newPost);
                showToast('Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ Î´Î·Î¼Î¿ÏƒÎ¹ÎµÏÏ„Î·ÎºÎµ!');
            }

            saveBlogPosts();
            renderBlogList();
            closeAddBlogModal();
            showAdminDashboard(null);
        }

        function applyStaticImages() {
            for (const [id, url] of Object.entries(staticImages)) {
                // Prefer exact id match; fallback to data-id match (useful when an element must keep a different semantic id).
                const el = document.getElementById(id) || document.querySelector(`[data-id="${id}"]`);
                if (el) {
                    if (id.endsWith('-bg') || el.classList.contains('admin-editable-bg')) {
                        el.style.backgroundImage = `url('${url}')`;
                    } else {
                        el.src = url;
                    }
                }
            }
        }

        window.onload = async function() {
            // Load latest server data FIRST so the admin edits the real public site.
            await loadFromServer();

            // Normalize bilingual fields (products/blog/global texts) so language switching works everywhere.
            try { products = window.VC_LANG.normalizeProducts(products); } catch(e) {}
            try { blogPosts = window.VC_LANG.normalizeBlogPosts(blogPosts); } catch(e) {}
            try { globalTexts = window.VC_LANG.normalizeGlobalTexts(globalTexts); } catch(e) {}

            applyStaticImages();
            applyGlobalSettings();
            try { renderProducts(); } catch(e) {}
            try { renderBlogList(); } catch(e) {}
            try { updateAdminTables(); } catch(e) {}
            initDragAndDrop();
            initModalUploadZones();
            initEmptyLinks();
            
            // Check Maintenance First
            checkMaintenance();

            // Then check view state if maintenance is not blocking (or if admin)
            const lastView = localStorage.getItem('vitro_active_view');
            
            // If in maintenance and not admin, force maintenance view regardless of stored view
            if (isMaintenance && !isAdmin) {
                // checkMaintenance already handles hiding views and showing maintenance
            } else {
                if (lastView) {
                    if (lastView === 'view-admin-dashboard' && isAdmin) showAdminDashboard(null);
                    else if (lastView === 'view-catalog') showCatalog(null);
                    else if (lastView === 'view-blog') showBlog(null);
                    else showLanding(false);
                } else showLanding();
            }
            
            checkWeeklyAI();
            updatePromoText(); // Initial check for promo text
        };
    
</script>


<script>
async function submitContactForm(form, opts = {}) {
  const btn = form.querySelector('button[type="submit"]');
  const originalText = btn ? btn.textContent : null;
  if (btn) {
    btn.disabled = true;
    const __lang = (localStorage.getItem('vc_lang') || 'el').toLowerCase();
    btn.textContent = (__lang === 'en') ? 'Sending...' : 'Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®...';
  }

  try {
    const fd = new FormData(form);
    const payload = {
      name: (fd.get('name') || '').trim(),
      email: (fd.get('email') || '').trim(),
      phone: (fd.get('phone') || '').trim(),
      interest: (fd.get('interest') || '').trim(),
      message: (fd.get('message') || '').trim()
    };

    if (!payload.name || !payload.email || !payload.message) {
      if (typeof showToast === 'function') showToast('Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ ÏŒÎ½Î¿Î¼Î±, email ÎºÎ±Î¹ Î¼Î®Î½Ï…Î¼Î±.');
      else alert('Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ ÏŒÎ½Î¿Î¼Î±, email ÎºÎ±Î¹ Î¼Î®Î½Ï…Î¼Î±.');
      return;
    }

    const res = await fetch('/api/contact', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    let json = null;
    try { json = await res.json(); } catch (e) {}

    if (res.ok && json && json.ok) {
      if (typeof showToast === 'function') showToast('Î¤Î¿ Î¼Î®Î½Ï…Î¼Î¬ ÏƒÎ±Ï‚ ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ.');
      else alert('Î¤Î¿ Î¼Î®Î½Ï…Î¼Î¬ ÏƒÎ±Ï‚ ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ.');
      form.reset();
      if (opts.closeModal && typeof closeModal === 'function') closeModal();
      return;
    }

    const err = (json && (json.error || json.message)) || ('HTTP ' + res.status);
    if (typeof showToast === 'function') showToast('Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚: ' + err);
    else alert('Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î± Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚: ' + err);
  } catch (e) {
    const msg = e && e.message ? e.message : String(e);
    if (typeof showToast === 'function') showToast('Î£Ï†Î¬Î»Î¼Î± Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚: ' + msg);
    else alert('Î£Ï†Î¬Î»Î¼Î± Î±Ï€Î¿ÏƒÏ„Î¿Î»Î®Ï‚: ' + msg);
  } finally {
    if (btn) {
      btn.disabled = false;
      btn.textContent = originalText;
    }
  }
}
</script>


<script>
/**
 * VITRO CANVAS i18n (EL/EN)
 * - UI strings via VC_I18N
 * - Dynamic content (products/blog/global texts) supports bilingual fields: { el: "...", en: "..." }
 * - Fallback: if EN is missing, EL is used (and vice versa).
 */
(function () {
  const STORE_KEY = 'vc_lang';
  const SUPPORTED = ['el', 'en'];

  function normalizeLang(lang) {
    const l = String(lang || '').toLowerCase();
    return SUPPORTED.includes(l) ? l : 'el';
  }

  function guessLang() {
    // localStorage wins. If missing, use browser language.
    const stored = (localStorage.getItem(STORE_KEY) || '').toLowerCase();
    if (SUPPORTED.includes(stored)) return stored;
    const nav = (navigator.language || 'el').toLowerCase();
    return nav.startsWith('en') ? 'en' : 'el';
  }

  function pick(value, lang) {
    if (value && typeof value === 'object' && (Object.prototype.hasOwnProperty.call(value, 'el') || Object.prototype.hasOwnProperty.call(value, 'en'))) {
      const el = value.el ?? '';
      const en = value.en ?? '';
      return (lang === 'en' ? (en || el) : (el || en)) || '';
    }
    return (value ?? '') + '';
  }

  function ensureBilingual(value) {
    if (value && typeof value === 'object' && (Object.prototype.hasOwnProperty.call(value, 'el') || Object.prototype.hasOwnProperty.call(value, 'en'))) {
      return { el: pick(value, 'el'), en: pick(value, 'en') };
    }
    const s = (value ?? '') + '';
    return { el: s, en: s };
  }

  function normalizeProducts(arr) {
    if (!Array.isArray(arr)) return arr;
    return arr.map(p => {
      if (!p || typeof p !== 'object') return p;
      return { ...p, name: ensureBilingual(p.name), desc: ensureBilingual(p.desc) };
    });
  }

  function normalizeBlogPosts(arr) {
    if (!Array.isArray(arr)) return arr;
    return arr.map(b => {
      if (!b || typeof b !== 'object') return b;
      return { ...b, title: ensureBilingual(b.title), date: ensureBilingual(b.date), content: ensureBilingual(b.content) };
    });
  }

  function normalizeGlobalTexts(obj) {
    if (!obj || typeof obj !== 'object') return obj;
    const out = { ...obj };
    if (out.heroTitle !== undefined) out.heroTitle = ensureBilingual(out.heroTitle);
    return out;
  }

  // Expose helpers for renderers/admin panels
  window.VC_LANG = {
    normalizeLang,
    get: () => normalizeLang(localStorage.getItem(STORE_KEY) || guessLang()),
    set: (lang) => localStorage.setItem(STORE_KEY, normalizeLang(lang)),
    pick: (value) => pick(value, window.VC_LANG.get()),
    pickLang: (value, lang) => pick(value, normalizeLang(lang)),
    ensureBilingual,
    normalizeProducts,
    normalizeBlogPosts,
    normalizeGlobalTexts
  };

  const VC_I18N = {
    el: {
      nav_home: 'Î‘ÏÏ‡Î¹ÎºÎ®',
      nav_about: 'Î¤Î¿ Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿',
      nav_products: 'Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±',
      nav_blog: 'Blog',
      nav_workshops: 'Workshops',
      nav_contact: 'Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±',
    hero_title_html: `Î— Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… <span class="glowing-letter">Î¦</span><span class="glowing-letter">Ï‰</span><span class="glowing-letter">Ï„</span><span class="glowing-letter">ÏŒ</span><span class="glowing-letter">Ï‚</span>`,
    hero_desc: 'Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î± Î²Î¹Ï„ÏÏŒ, Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ ÎºÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ­Ï‚ Î»ÏÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î¼ÎµÏ„Î±Î¼Î¿ÏÏ†ÏÎ½Î¿Ï…Î½ Ï„Î¿Î½ Ï‡ÏÏÎ¿ ÏƒÎ±Ï‚.',
    about_title_html: `Î£Ï‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î· <span class="text-amber">Vitro Canvas</span>`,
    about_p1: 'Î¤Î¿ ÎµÏÎ³Î±ÏƒÏ„Î®ÏÎ¹ÏŒ Î¼Î±Ï‚ ÏƒÏ„Î· ÎÎ­Î± ÎšÎµÏÎ±ÏƒÎ¹Î¬ ÏƒÏ…Î½Î´Ï…Î¬Î¶ÎµÎ¹ Ï„Î·Î½ Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ® Î´ÎµÎ¾Î¹ÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î· ÏƒÏÎ³Ï‡ÏÎ¿Î½Î· Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ®. ÎŸÎ½Î¿Î¼Î¬Î¶Î¿Î¼Î±Î¹ Î§Î¬ÏÎ·Ï‚ Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î¿Ï… ÎºÎ±Î¹ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Î¼Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î· Ï€Î±ÏÎ¿Ï‡Î® Î»ÏÏƒÎµÏ‰Î½ Î³Ï…Î±Î»Î¹Î¿Ï Ï…ÏˆÎ·Î»Î®Ï‚ Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ®Ï‚ Î³Î¹Î± Î¹Î´Î¹ÏÏ„ÎµÏ‚ ÎºÎ±Î¹ ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚.',
    about_p2: 'Î‘Ï€ÏŒ Ï„Î·Î½ ÎºÎ»Î±ÏƒÎ¹ÎºÎ® Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î¼Î¿Î»ÏÎ²Î´Î¿Ï… Î¼Î­Ï‡ÏÎ¹ Ï„Î· Î»ÎµÏ€Ï„ÎµÏ€Î¯Î»ÎµÏ€Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Tiffany, ÎºÎ¬Î¸Îµ Î­ÏÎ³Î¿ ÎµÎ¯Î½Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ, ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î¿ Î³Î¹Î± Î½Î± Ï€Î±Î¯Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Ï†Ï‰Ï‚ ÎºÎ±Î¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï„Î¼ÏŒÏƒÏ†Î±Î¹ÏÎ±.',
    about_badge_handmade: 'Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î¿',
    about_badge_timeless: 'Î”Î¹Î±Ï‡ÏÎ¿Î½Î¹ÎºÏŒ',
    about_badge_custom: 'Custom',
    back_home: 'Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î·Î½ Î‘ÏÏ‡Î¹ÎºÎ®',
    back_to_blog: 'Î Î¯ÏƒÏ‰ ÏƒÏ„Î¿ Blog',
    pd_desc_label: 'Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®',
    pd_quote_btn: 'Î–Î·Ï„Î®ÏƒÏ„Îµ Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬',
    pd_back_to_products: 'Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÏƒÏ„Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±',


      services_title: 'Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯ÎµÏ‚ & Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚',
      service1_title: 'Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ',
      service1_desc: 'Î Î±ÏÎ¬Î¸Ï…ÏÎ±, Ï†ÎµÎ³Î³Î¯Ï„ÎµÏ‚ ÎºÎ±Î¹ Ï€ÏŒÏÏ„ÎµÏ‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Ï€Î¿Ï… Î±Î»Î»Î¬Î¶Î¿Ï…Î½ Ï„Î·Î½ ÏŒÏˆÎ· Ï„Î¿Ï… ÎºÏ„Î¹ÏÎ¯Î¿Ï….',
      service2_title: 'ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±',
      service2_desc: 'ÎœÎ¿Î½Î±Î´Î¹ÎºÎ¬ Ï‡ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î± ÎºÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î±Î¾ÎµÏƒÎ¿Ï…Î¬Ï Î±Ï€ÏŒ Î³Ï…Î±Î»Î¯ Î³Î¹Î± Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹Ï‚.',
      service3_title: 'Suncatchers & Decor',
      service3_desc: 'ÎœÎ¹ÎºÏÎ¬ Î´Î¹Î±ÎºÎ¿ÏƒÎ¼Î·Ï„Î¹ÎºÎ¬, Ï†Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ Tiffany ÎºÎ±Î¹ ÎºÎ±Î¸ÏÎ­Ï†Ï„ÎµÏ‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ Î³Ï‰Î½Î¹Î¬.',
      service4_title: 'Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ· & Î‘Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·',
      service4_desc: 'Î•Î¾ÎµÎ¹Î´Î¹ÎºÎµÏ…Î¼Î­Î½Î· ÎµÏ€Î¹ÏƒÎºÎµÏ…Î® Ï€Î±Î»Î±Î¹ÏÎ½ Î²Î¹Ï„ÏÏŒ ÏƒÎµ Î½ÎµÎ¿ÎºÎ»Î±ÏƒÎ¹ÎºÎ¬ ÎºÎ±Î¹ ÎµÎºÎºÎ»Î·ÏƒÎ¯ÎµÏ‚.',
      service_link_more_html: 'Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i>',
      service_link_estimate_html: 'Î–Î·Ï„Î®ÏƒÏ„Îµ ÎµÎºÏ„Î¯Î¼Î·ÏƒÎ· <i class="fas fa-arrow-right ml-1"></i>',

      workshops_title: 'ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î·Î½ Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… Î’Î¹Ï„ÏÏŒ',
      workshops_desc: 'Î”Î¹Î¿ÏÎ³Î±Î½ÏÎ½Î¿Ï…Î¼Îµ Î´Î¹Î®Î¼ÎµÏÎ± workshops Î³Î¹Î± Î±ÏÏ‡Î¬ÏÎ¹Î¿Ï…Ï‚. ÎœÎ¬Î¸ÎµÏ„Îµ Î½Î± ÎºÏŒÎ²ÎµÏ„Îµ, Î½Î± Ï„ÏÎ¿Ï‡Î¯Î¶ÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± ÎºÎ¿Î»Î»Î¬Ï„Îµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ±Ï‚ Î­ÏÎ³Î¿ Ï„Î­Ï‡Î½Î·Ï‚.',
      workshops_li1: 'ÎŒÎ»Î± Ï„Î± Ï…Î»Î¹ÎºÎ¬ Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹',
      workshops_li2: 'ÎŸÎ»Î¹Î³Î¿Î¼ÎµÎ»Î® Ï„Î¼Î®Î¼Î±Ï„Î±',
      workshops_li3: 'Î Î±Î¯ÏÎ½ÎµÏ„Îµ Ï„Î¿ Î­ÏÎ³Î¿ ÏƒÏ€Î¯Ï„Î¹ ÏƒÎ±Ï‚',
      workshops_cta: 'ÎšÎ»ÎµÎ¯ÏƒÏ„Îµ Î˜Î­ÏƒÎ· Î¤ÏÏÎ±',

      hero_collection: 'Î”ÎµÎ¯Ï„Îµ Ï„Î· Î£Ï…Î»Î»Î¿Î³Î®',
      hero_quote: 'Î–Î·Ï„Î®ÏƒÏ„Îµ Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬',

      promo_marquee: 'ğŸ”¥ Î Î¡ÎŸÎ£Î¦ÎŸÎ¡Î•Î£: Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ Ï„Î¹Ï‚ ÎµÎºÏ€Ï„ÏÏƒÎµÎ¹Ï‚ Î¼Î±Ï‚ ÎºÎ±Î¹ Î±Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ Î­ÏÎ³Î± ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ­Ï‚ Ï„Î¹Î¼Î­Ï‚!',
      catalog_title: 'ÎšÎ±Ï„Î¬Î»Î¿Î³Î¿Ï‚ Î ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½',
      blog_section_title: 'Î¤Î¿ Blog Î¼Î±Ï‚',
      blog_section_sub: 'Î™ÏƒÏ„Î¿ÏÎ¯Î±, Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ ÎºÎ±Î¹ Î½Î­Î± Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏŒÏƒÎ¼Î¿ Ï„Î¿Ï… Î³Ï…Î±Î»Î¹Î¿Ï.',
      blog_read_more: 'Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ±',

      stock_in: 'Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿',
      stock_sold: 'Î•Î¾Î±Î½Ï„Î»Î®Î¸Î·ÎºÎµ',
      stock_made: 'ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚',

      modal_title: 'Î¦ÏŒÏÎ¼Î± Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬Ï‚',
      modal_sub: 'Î£Ï…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏƒÎ±Ï‚ ÎºÎ±Î¹ Î¸Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎ¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ±.',
      q_label_name: 'ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿',
      q_ph_name: 'Ï€.Ï‡. Î“Î¹Î¬Î½Î½Î·Ï‚ Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚',
      q_label_email: 'Email',
      q_label_phone: 'Î¤Î·Î»Î­Ï†Ï‰Î½Î¿',
      q_label_interest: 'Î•Î½Î´Î¹Î±Ï†Î­ÏÎ¿Î¼Î±Î¹ Î³Î¹Î±',
      q_opts: ['Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ', 'Custom ÎšÏŒÏƒÎ¼Î·Î¼Î±', 'Î•Ï€Î¹ÏƒÎºÎµÏ…Î® / Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·', 'Î†Î»Î»Î¿'],
      q_label_message: 'ÎœÎ®Î½Ï…Î¼Î±',
      q_ph_message: 'Î ÎµÏÎ¹Î³ÏÎ¬ÏˆÏ„Îµ Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ...',
      q_submit: 'Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î‘Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚',

      contact_title: 'Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±',
      contact_desc: 'Î•Î½Î´Î¹Î±Ï†Î­ÏÎµÏƒÏ„Îµ Î³Î¹Î± Î¼Î¹Î± custom Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î® Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î± Î¼Î±Î¸Î®Î¼Î±Ï„Î±; Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÏ„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚.',
      contact_address_label: 'Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·',
      contact_phone_label: 'Î¤Î·Î»Î­Ï†Ï‰Î½Î¿',
      contact_email_label: 'Email',

      c_label_name: 'ÎŒÎ½Î¿Î¼Î±',
      c_ph_name: 'Î¤Î¿ ÏŒÎ½Î¿Î¼Î¬ ÏƒÎ±Ï‚',
      c_label_email: 'Email',
      c_label_phone: 'Î¤Î·Î»Î­Ï†Ï‰Î½Î¿',
      c_label_subject: 'Î˜Î­Î¼Î±',
      c_opts: ['Î“ÎµÎ½Î¹ÎºÎ® Î•ÏÏÏ„Î·ÏƒÎ·', 'Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î’Î¹Ï„ÏÏŒ', 'ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±', 'Î•Ï€Î¹ÏƒÎºÎµÏ…Î®', 'Î£Ï…Î¼Î¼ÎµÏ„Î¿Ï‡Î® ÏƒÎµ Workshop'],
      c_label_message: 'ÎœÎ®Î½Ï…Î¼Î±',
      c_ph_message: 'Î ÏÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î¼Îµ;',
      c_submit: 'Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎœÎ·Î½ÏÎ¼Î±Ï„Î¿Ï‚',

      lang_caption: 'Î•Î»Î»Î·Î½Î¹ÎºÎ¬',
      lang_aria: 'Î‘Î»Î»Î±Î³Î® Î³Î»ÏÏƒÏƒÎ±Ï‚'
    },
    en: {
      nav_home: 'Home',
      nav_about: 'Studio',
      nav_products: 'Products',
      nav_blog: 'Blog',
      nav_workshops: 'Workshops',
      nav_contact: 'Contact',
    hero_title_html: `The Art of <span class="glowing-letter">L</span><span class="glowing-letter">i</span><span class="glowing-letter">g</span><span class="glowing-letter">h</span><span class="glowing-letter">t</span>`,
    hero_desc: 'Handmade stained glass, unique jewelry and architectural solutions that transform your space.',
    about_title_html: `About <span class="text-amber">Vitro Canvas</span>`,
    about_p1: 'Our studio in Nea Kerasia blends traditional craftsmanship with modern aesthetics. My name is Î§Î¬ÏÎ·Ï‚ Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î¿Ï… and my goal is to offer high-aesthetic glass solutions for individuals and professionals.',
    about_p2: 'From classic lead came to the delicate Tiffany technique, every piece is unique, designed to play with light and create atmosphere.',
    about_badge_handmade: 'Handcrafted',
    about_badge_timeless: 'Timeless',
    about_badge_custom: 'Custom',
    back_home: 'Back to Home',
    back_to_blog: 'Back to Blog',
    pd_desc_label: 'Description',
    pd_quote_btn: 'Request a Quote',
    pd_back_to_products: 'Back to Products',


      services_title: 'Creations & Services',
      service1_title: 'Architectural Stained Glass',
      service1_desc: 'Windows, skylights and entrance doors that transform the look of your building.',
      service2_title: 'Jewelry',
      service2_desc: 'Handmade glass jewelry and accessories for truly distinctive looks.',
      service3_title: 'Suncatchers & Decor',
      service3_desc: 'Small decor pieces, Tiffany lamps and mirrors for every corner.',
      service4_title: 'Maintenance & Restoration',
      service4_desc: 'Specialized restoration of old stained glass for neoclassical buildings and churches.',
      service_link_more_html: 'See more <i class="fas fa-arrow-right ml-1"></i>',
      service_link_estimate_html: 'Request an estimate <i class="fas fa-arrow-right ml-1"></i>',

      workshops_title: 'Learn the Art of Stained Glass',
      workshops_desc: 'We run two-day beginner workshops. Learn to cut, grind and solder your own piece of art.',
      workshops_li1: 'All materials provided',
      workshops_li2: 'Small groups',
      workshops_li3: 'Take your piece home',
      workshops_cta: 'Book your spot now',

      hero_collection: 'View Collection',
      hero_quote: 'Request a Quote',

      promo_marquee: 'ğŸ”¥ LIMITED OFFERS: Discover our discounts and get unique pieces at special prices!',
      catalog_title: 'Product Catalog',
      blog_section_title: 'Our Blog',
      blog_section_sub: 'Stories, techniques and news from the world of glass.',
      blog_read_more: 'Read more',

      stock_in: 'In Stock',
      stock_sold: 'Sold out',
      stock_made: 'Made to order',

      modal_title: 'Quote Form',
      modal_sub: 'Fill in your details and weâ€™ll get back to you shortly.',
      q_label_name: 'Full name',
      q_ph_name: 'e.g. John Doe',
      q_label_email: 'Email',
      q_label_phone: 'Phone',
      q_label_interest: "I'm interested in",
      q_opts: ['Architectural stained glass', 'Custom jewelry', 'Repair / restoration', 'Other'],
      q_label_message: 'Message',
      q_ph_message: 'Describe what you need...',
      q_submit: 'Send request',

      contact_title: 'Contact',
      contact_desc: 'Interested in a custom order or want to learn more about workshops? Get in touch.',
      contact_address_label: 'Address',
      contact_phone_label: 'Phone',
      contact_email_label: 'Email',

      c_label_name: 'Name',
      c_ph_name: 'Your name',
      c_label_email: 'Email',
      c_label_phone: 'Phone',
      c_label_subject: 'Subject',
      c_opts: ['General question', 'Stained glass order', 'Jewelry', 'Repair', 'Workshop participation'],
      c_label_message: 'Message',
      c_ph_message: 'How can we help?',
      c_submit: 'Send message',

      lang_caption: 'English',
      lang_aria: 'Change language'
    }
  };
  window.VC_I18N = VC_I18N;

  function t(key) {
    const lang = window.VC_LANG.get();
    return (VC_I18N[lang] && VC_I18N[lang][key]) || (VC_I18N.el && VC_I18N.el[key]) || '';
  }

  function byId(id) { return document.getElementById(id); }
  function setText(id, value) { const el = byId(id); if (el) el.textContent = value; }
  function setHTML(id, value) { const el = byId(id); if (el) el.innerHTML = value; }
  function setPlaceholder(id, value) { const el = byId(id); if (el) el.setAttribute('placeholder', value); }
  function setSelectOptions(id, values) {
    const el = byId(id);
    if (!el) return;
    const opts = el.querySelectorAll('option');
    values.forEach((v, i) => { if (opts[i]) opts[i].textContent = v; });
  }

  function updateFlagUI(lang) {
    const isEn = lang === 'en';
    const flag = isEn ? 'ğŸ‡¬ğŸ‡§' : 'ğŸ‡¬ğŸ‡·';
    const caption = isEn ? VC_I18N.en.lang_caption : VC_I18N.el.lang_caption;

    const btn = byId('lang-toggle');
    const flagEl = byId('lang-flag');
    if (flagEl) flagEl.textContent = flag;
    if (btn) {
      btn.setAttribute('aria-label', t('lang_aria') + ': ' + caption);
      btn.setAttribute('title', caption);
    }

    const mBtn = byId('m-lang-toggle');
    const mFlagEl = byId('m-lang-flag');
    const mCap = byId('m-lang-caption');
    if (mFlagEl) mFlagEl.textContent = flag;
    if (mCap) mCap.textContent = caption;
    if (mBtn) {
      mBtn.setAttribute('aria-label', t('lang_aria') + ': ' + caption);
      mBtn.setAttribute('title', caption);
    }
  }

  function updatePromoMarquee() {
    const el = byId('promo-marquee');
    if (!el) return;
    const base = t('promo_marquee');
    const spacer = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';
    el.innerHTML = (base + spacer).repeat(6);
  }

  function apply(lang) {
    const normalized = window.VC_LANG.normalizeLang(lang);
    window.VC_LANG.set(normalized);
    document.documentElement.lang = normalized;

    // Nav
    setText('nav-home', t('nav_home'));
    setText('nav-about', t('nav_about'));
    setText('nav-products', t('nav_products'));
    setText('nav-blog', t('nav_blog'));
    setText('nav-workshops', t('nav_workshops'));
    setText('nav-contact-btn', t('nav_contact'));

    setText('mnav-home', t('nav_home'));
    setText('mnav-about', t('nav_about'));
    setText('mnav-products', t('nav_products'));
    setText('mnav-blog', t('nav_blog'));
    setText('mnav-workshops', t('nav_workshops'));
    setText('mnav-contact-btn', t('nav_contact'));

    // Hero buttons
    setText('hero-btn-collection', t('hero_collection'));
    setText('hero-btn-quote', t('hero_quote'));


    // Hero text
    setHTML('editable-hero-title', t('hero_title_html'));
    setText('editable-hero-desc', t('hero_desc'));

    // About section
    setHTML('about-title', t('about_title_html'));
    setHTML('about-p1', (t('about_p1') || '').replace('Î§Î¬ÏÎ·Ï‚ Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î¿Ï…', '<strong class="text-white">Î§Î¬ÏÎ·Ï‚ Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î¿Ï…</strong>'));
    setText('about-p2', t('about_p2'));
    setText('about-badge-1', t('about_badge_handmade'));
    setText('about-badge-2', t('about_badge_timeless'));
    setText('about-badge-3', t('about_badge_custom'));

    // Product details labels (catalog view)
    setText('pd-desc-label', t('pd_desc_label'));
    setText('pd-quote-btn-text', t('pd_quote_btn'));
    setText('pd-back-btn-text', t('pd_back_to_products'));

    // Headings
    setText('catalog-title', t('catalog_title'));
    setText('blog-section-title', t('blog_section_title'));
    setText('blog-section-sub', t('blog_section_sub'));

    // Services section
    setText('services-title', t('services_title'));
    setText('service-1-title', t('service1_title'));
    setText('service-1-desc', t('service1_desc'));
    setHTML('service-1-link', t('service_link_more_html'));

    setText('service-2-title', t('service2_title'));
    setText('service-2-desc', t('service2_desc'));
    setHTML('service-2-link', t('service_link_more_html'));

    setText('service-3-title', t('service3_title'));
    setText('service-3-desc', t('service3_desc'));
    setHTML('service-3-link', t('service_link_more_html'));

    setText('service-4-title', t('service4_title'));
    setText('service-4-desc', t('service4_desc'));
    setHTML('service-4-link', t('service_link_estimate_html'));

    // Workshops section
    setText('workshops-title', t('workshops_title'));
    setText('workshops-desc', t('workshops_desc'));
    setText('workshops-li-1', t('workshops_li1'));
    setText('workshops-li-2', t('workshops_li2'));
    setText('workshops-li-3', t('workshops_li3'));
    setText('workshops-cta', t('workshops_cta'));


    // Quote modal
    setText('modal-quote-title', t('modal_title'));
    setText('modal-quote-sub', t('modal_sub'));
    setText('q-label-name', t('q_label_name'));
    setPlaceholder('q-input-name', t('q_ph_name'));
    setText('q-label-email', t('q_label_email'));
    setText('q-label-phone', t('q_label_phone'));
    setText('q-label-interest', t('q_label_interest'));
    setSelectOptions('q-select-interest', VC_I18N[normalized].q_opts);
    setText('q-label-message', t('q_label_message'));
    setPlaceholder('q-textarea-message', t('q_ph_message'));
    setText('q-submit', t('q_submit'));

    // Contact section
    setText('contact-title', t('contact_title'));
    setText('contact-desc', t('contact_desc'));
    // Contact info labels (correct IDs in HTML)
    setText('contact-info-address-label', t('contact_address_label'));
    setText('contact-info-phone-label', t('contact_phone_label'));
    setText('contact-info-email-label', t('contact_email_label'));

    // Contact form
    setText('c-label-name', t('c_label_name'));
    setPlaceholder('c-input-name', t('c_ph_name'));
    setText('c-label-email', t('c_label_email'));
    setText('c-label-phone', t('c_label_phone'));
    setText('c-label-subject', t('c_label_subject'));
    setSelectOptions('c-select-subject', VC_I18N[normalized].c_opts);
    setText('c-label-message', t('c_label_message'));
    setPlaceholder('c-textarea-message', t('c_ph_message'));
    setText('c-submit', t('c_submit'));

    updatePromoMarquee();
    updateFlagUI(normalized);

    // Normalize bilingual data (supports older saved data)
    try { if (typeof products !== 'undefined') products = window.VC_LANG.normalizeProducts(products); } catch(e) {}
    try { if (typeof blogPosts !== 'undefined') blogPosts = window.VC_LANG.normalizeBlogPosts(blogPosts); } catch(e) {}
    try { if (typeof globalTexts !== 'undefined') globalTexts = window.VC_LANG.normalizeGlobalTexts(globalTexts); } catch(e) {}

    // Re-render dynamic sections
    try { if (typeof renderProducts === 'function') renderProducts(); } catch(e) {}
    try { if (typeof renderBlogList === 'function') renderBlogList(); } catch(e) {}
    try { if (typeof updateAdminTables === 'function') updateAdminTables(); } catch(e) {}

    // If a single blog post is open, refresh it so it switches language too
    try {
      const single = document.getElementById('view-blog-single');
      if (single && !single.classList.contains('hidden') && typeof window.__currentBlogId !== 'undefined') {
        if (typeof openBlogPost === 'function') openBlogPost(window.__currentBlogId);
      }
    } catch(e) {}
  }

  function toggleLang() {
    const current = window.VC_LANG.get();
    apply(current === 'en' ? 'el' : 'en');
  }

  document.addEventListener('DOMContentLoaded', function () {
    apply(guessLang());

    const btn = byId('lang-toggle');
    if (btn) btn.addEventListener('click', toggleLang);

    const mBtn = byId('m-lang-toggle');
    if (mBtn) mBtn.addEventListener('click', toggleLang);
  });

})();
</script>


</body>
</html>
