<!DOCTYPE html>
<html lang="el" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VITRO CANVAS | Stained Glass Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        lead: '#1a1a1a',
                        ruby: '#b71c1c',
                        royal: '#0d47a1',
                        amber: 'var(--color-primary)', /* Dynamic Primary Color */
                        emerald: '#1b5e20',
                        glass: 'rgba(30, 30, 30, var(--glass-opacity))', /* Dynamic Opacity */
                    },
                    fontFamily: {
                        serif: ['Cinzel', 'serif'],
                        sans: ['Montserrat', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --color-primary: #fbc02d;
            --glass-opacity: 0.6;
            --glow-start: #fbc02d;
            --glow-end: #b71c1c;
            --spin-speed: 60s;
        }

        body {
            background-color: #0f0f0f;
            color: #e0e0e0;
            font-family: 'Montserrat', sans-serif;
        }
        h1, h2, h3, .nav-link {
            font-family: 'Cinzel', serif;
        }
        .stained-glass-bg {
            background-image: radial-gradient(circle at 50% 50%, #2a2a2a 0%, #0f0f0f 100%);
        }
        .glass-card {
            background: rgba(30, 30, 30, var(--glass-opacity));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-color: color-mix(in srgb, var(--color-primary) 30%, transparent);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            border-color: var(--color-primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        /* Dynamic Animation for "Î¦Ï‰Ï„ÏŒÏ‚" */
        @keyframes glowing-text {
            0% { color: var(--glow-start); text-shadow: 0 0 10px var(--glow-start); } 
            100% { color: var(--glow-end); text-shadow: 0 0 20px var(--glow-end); } 
        }
        .glowing-letter {
            display: inline-block;
            animation: glowing-text 3s ease-in-out infinite alternate;
        }

        .hero-overlay {
            background: linear-gradient(to bottom, rgba(26,26,26,0.3), rgba(15,15,15,1));
        }

        /* --- SEAL ANIMATIONS --- */
        @keyframes draw-seal-lines {
            from { stroke-dashoffset: 2000; }
            to { stroke-dashoffset: 0; }
        }
        @keyframes fade-seal-content {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .seal-stroke {
            stroke-dasharray: 2000;
            stroke-dashoffset: 2000;
            animation: draw-seal-lines 5s cubic-bezier(0.33, 1, 0.68, 1) forwards;
        }
        
        .seal-content {
            opacity: 0;
            animation: fade-seal-content 3s ease-out 1.5s forwards; /* Delayed fade in */
        }

        /* NEW ANIMATION: 3D Spin on Vertical Axis */
        @keyframes spin-vertical {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        .animate-spin-vertical {
            animation: spin-vertical 4s linear infinite;
        }

        /* NEW ANIMATION: Random Glass Flickering */
        @keyframes glass-flicker {
            0%, 100% { opacity: 0.6; filter: brightness(1); }
            50% { opacity: 1; filter: brightness(1.5) saturate(1.2); }
        }

        /* NEW ANIMATION: V Logo Color Wave */
        @keyframes wave-gradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        .v-wave {
            background: linear-gradient(to right, #ffffff 20%, var(--color-primary) 50%, #ffffff 80%);
            background-size: 200% auto;
            color: #fff; /* Fallback */
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: wave-gradient 1.5s linear infinite;
        }

        /* Dynamic Seal Spin */
        .dynamic-spin {
            animation: spin var(--spin-speed) linear infinite;
        }
        /* SEAL ROTATION KEYFRAMES */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ADMIN EDITABLE STYLE UPDATED - SOLID GREEN BORDER */
        .admin-editable-img {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        
        /* GLOBAL ADMIN HOVER EFFECT FOR IMAGES */
        body.admin-mode img.admin-editable-img:hover {
            outline: 6px solid #10b981; /* Solid green border */
            outline-offset: -6px;
            opacity: 0.9;
            cursor: pointer;
            filter: brightness(1.1);
            z-index: 50; 
        }
        
        body.admin-mode .admin-editable-bg:hover {
            outline: 6px solid #10b981;
            outline-offset: -6px;
            cursor: pointer;
        }

        /* Visual cue for drag over - HIGH PRIORITY */
        .drag-over {
            outline: 8px solid var(--color-primary) !important;
            outline-offset: -8px !important;
            filter: brightness(1.2) sepia(0.2) !important;
            transform: scale(1.02);
            z-index: 100;
            transition: all 0.1s;
        }

        /* Statistics Bars */
        .stat-bar {
            transition: width 1s ease-out;
            width: 0%;
        }

        /* AI Loading Animation */
        .ai-loading {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        /* Maintenance View Styles */
        .maintenance-bg {
            background: #000;
            background-image: 
                linear-gradient(rgba(251, 192, 45, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(251, 192, 45, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        @keyframes hammer-swing {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-45deg); }
        }
        .animate-hammer {
            animation: hammer-swing 1s ease-in-out infinite;
            transform-origin: bottom left;
        }
        
        /* Marquee Animation */
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .animate-marquee {
            animation: marquee 25s linear infinite;
            white-space: nowrap;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1a1a; 
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-primary); 
            border-radius: 4px;
        }
        
        /* Line Clamp for Blog Excerpts */
        .line-clamp-6 {
            display: -webkit-box;
            -webkit-line-clamp: 6;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="stained-glass-bg relative">

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-5 right-5 bg-amber text-lead px-6 py-4 rounded-lg shadow-[0_0_20px_rgba(251,192,45,0.4)] transform translate-y-20 opacity-0 transition-all duration-300 z-[100] font-bold hidden flex items-center gap-3">
        <i class="fas fa-check-circle text-xl"></i>
        <span id="toast-message"></span>
    </div>

    <!-- AI Generating Toast (Special) -->
    <div id="ai-toast" class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-indigo-900/90 text-white px-8 py-4 rounded-full shadow-[0_0_30px_rgba(99,102,241,0.6)] z-[120] font-bold hidden flex items-center gap-3 border border-indigo-500/50 backdrop-blur-md">
        <i class="fas fa-sparkles text-yellow-300 ai-loading"></i>
        <span>Î¤Î¿ AI Î³ÏÎ¬Ï†ÎµÎ¹ Î½Î­Î¿ Î¬ÏÎ¸ÏÎ¿...</span>
    </div>
    
    <!-- Maintenance Banner for Admin -->
    <div id="maintenance-banner" class="hidden fixed top-0 left-0 w-full bg-red-600 text-white text-xs font-bold text-center py-1 z-[200]">
        <i class="fas fa-tools mr-2"></i> WEBSITE IN MAINTENANCE MODE (Visible only to Admin)
    </div>

    <!-- CONTACT MODAL POPUP -->
    <div id="contact-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        <div class="relative bg-[#1a1a1a] border border-amber/30 p-8 rounded-2xl w-full max-w-lg shadow-[0_0_50px_rgba(251,192,45,0.2)] animate-[fade-seal-content_0.3s_ease-out_forwards]">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-amber transition text-2xl"><i class="fas fa-times"></i></button>
            <div class="text-center mb-6">
                <i class="fas fa-envelope-open-text text-amber text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white">Î¦ÏŒÏÎ¼Î± Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬Ï‚</h2>
                <p class="text-gray-400 text-sm mt-2">Î£Ï…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± ÏƒÎ±Ï‚ ÎºÎ±Î¹ Î¸Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎ¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ±.</p>
            </div>
            <form onsubmit="event.preventDefault(); showToast('Î¤Î¿ Î±Î¯Ï„Î·Î¼Î¬ ÏƒÎ±Ï‚ ÎµÏƒÏ„Î¬Î»Î· ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!'); closeModal();">
                <div class="space-y-4">
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿</label><input type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="Ï€.Ï‡. Î“Î¹Î¬Î½Î½Î·Ï‚ Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Email</label><input type="email" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="email@example.com"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label><input type="tel" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="+30 69XX XXX XXX"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î•Î½Î´Î¹Î±Ï†Î­ÏÎ¿Î¼Î±Î¹ Î³Î¹Î±</label><select class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"><option>Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ</option><option>Custom ÎšÏŒÏƒÎ¼Î·Î¼Î±</option><option>Î•Ï€Î¹ÏƒÎºÎµÏ…Î® / Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·</option><option>Î†Î»Î»Î¿</option></select></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎœÎ®Î½Ï…Î¼Î±</label><textarea class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition h-24" placeholder="Î ÎµÏÎ¹Î³ÏÎ¬ÏˆÏ„Îµ Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ..."></textarea></div>
                    <button type="submit" class="w-full bg-amber text-lead font-bold py-3 rounded-lg hover:bg-white transition duration-300">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î‘Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ADMIN LOGIN MODAL -->
    

    <!-- ADD/EDIT PRODUCT MODAL -->
    <div id="add-product-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity" onclick="closeAddProductModal()"></div>
        <div class="relative bg-[#1a1a1a] border border-amber/30 p-8 rounded-2xl w-full max-w-2xl shadow-[0_0_50px_rgba(251,192,45,0.2)]">
            <button onclick="closeAddProductModal()" class="absolute top-4 right-4 text-gray-400 hover:text-amber transition text-2xl"><i class="fas fa-times"></i></button>
            <div class="text-center mb-6">
                <i class="fas fa-plus-circle text-amber text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white" id="modal-product-title">ÎÎ­Î¿ Î ÏÎ¿ÏŠÏŒÎ½</h2>
            </div>
            <form onsubmit="event.preventDefault(); handleAddProduct();">
                <input type="hidden" id="prod-id"> <!-- Hidden ID field for edits -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎŒÎ½Î¿Î¼Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚</label><input id="prod-name" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î¹Î¼Î® (â‚¬)</label><input id="prod-price" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="Ï€.Ï‡. 120.00"></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label><select id="prod-category" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"><option value="stained-glass">Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ</option><option value="jewelry">ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±</option><option value="decor">Î”Î¹Î±ÎºÏŒÏƒÎ¼Î·ÏƒÎ·</option></select></div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î”Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±</label><select id="prod-stock" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition"><option value="in-stock">Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿</option><option value="made-to-order">ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚</option><option value="sold">Î Ï‰Î»Î®Î¸Î·ÎºÎµ</option></select></div>
                    <!-- NEW DISCOUNT FIELD -->
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">ÎˆÎºÏ€Ï„Ï‰ÏƒÎ· (%)</label><input id="prod-discount" type="number" min="0" max="100" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="0"></div>
                    
                    <div class="col-span-1 md:col-span-2"><label class="block text-gray-400 text-xs uppercase font-bold mb-1">URL Î•Î¹ÎºÏŒÎ½Î±Ï‚</label><input id="prod-image" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="https://example.com/image.jpg"></div>
                    <div class="col-span-1 md:col-span-2"><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®</label><textarea id="prod-desc" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-amber transition h-24"></textarea></div>
                </div>
                <button type="submit" class="w-full bg-amber text-lead font-bold py-3 rounded-lg hover:bg-white transition duration-300">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
            </form>
        </div>
    </div>

    <!-- ADD BLOG POST MODAL -->
    <div id="add-blog-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity" onclick="closeAddBlogModal()"></div>
        <div class="relative bg-[#1a1a1a] border border-emerald/30 p-8 rounded-2xl w-full max-w-3xl shadow-[0_0_50px_rgba(27,94,32,0.2)]">
            <button onclick="closeAddBlogModal()" class="absolute top-4 right-4 text-gray-400 hover:text-emerald transition text-2xl"><i class="fas fa-times"></i></button>
            <div class="text-center mb-6">
                <i class="fas fa-pen-nib text-emerald text-4xl mb-3"></i>
                <h2 class="text-2xl font-serif font-bold text-white">ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿ Blog</h2>
            </div>
            <form onsubmit="event.preventDefault(); handleAddBlogPost();">
                <div class="space-y-4">
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î¤Î¯Ï„Î»Î¿Ï‚ Î†ÏÎ¸ÏÎ¿Ï…</label><input id="blog-title" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition"></div>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</label><input id="blog-date" type="text" placeholder="Ï€.Ï‡. 25 ÎœÎ±Ï 2026" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition"></div>
                        <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">URL Î•Î¹ÎºÏŒÎ½Î±Ï‚</label><input id="blog-image" type="text" required class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition" placeholder="https://..."></div>
                    </div>
                    <div><label class="block text-gray-400 text-xs uppercase font-bold mb-1">Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ (HTML ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹)</label><textarea id="blog-content" class="w-full bg-black/40 border border-gray-700 rounded-lg py-2 px-4 text-white focus:outline-none focus:border-emerald transition h-48" placeholder="<p>Î“ÏÎ¬ÏˆÏ„Îµ Ï„Î¿ ÎºÎµÎ¯Î¼ÎµÎ½ÏŒ ÏƒÎ±Ï‚ ÎµÎ´Ï...</p>"></textarea></div>
                </div>
                <button type="submit" class="w-full bg-emerald text-white font-bold py-3 mt-6 rounded-lg hover:bg-emerald-700 transition duration-300">Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ· Î†ÏÎ¸ÏÎ¿Ï…</button>
            </form>
        </div>
    </div>

    <!-- UNDER CONSTRUCTION VIEW -->
    <div id="view-maintenance" class="hidden fixed inset-0 z-[200] maintenance-bg flex flex-col justify-between text-center">
        <div class="flex-grow flex flex-col items-center justify-center px-4">
            <div class="mb-8">
                <i class="fas fa-tools text-6xl text-amber animate-hammer"></i>
            </div>
            <h1 class="text-5xl md:text-7xl font-serif font-bold text-white mb-4 tracking-wider">UNDER CONSTRUCTION</h1>
            <p class="text-xl text-gray-400 font-sans max-w-2xl">
                We are crafting something beautiful. Our website is currently undergoing maintenance. Please check back soon.
            </p>
            <div class="mt-12">
                <div class="w-16 h-1 bg-amber mx-auto"></div>
            </div>
        </div>
        
        <!-- Footer for Maintenance Mode (Same as Main) -->
        <footer class="bg-transparent py-10 w-full">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <p class="text-gray-500 text-sm">
                    &copy; 2024 VITRO CANVAS. All rights reserved. | Created by Harris Eleftheriou
                    
                </p>
            </div>
        </footer>
    </div>

    <!-- Navigation -->
    <nav id="main-nav" class="fixed w-full z-50 bg-lead/90 backdrop-blur-md border-b border-white/10 transition-transform duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="javascript:void(0)" onclick="navigateToSection(event, 'home')" class="flex-shrink-0 flex items-center gap-3 group cursor-pointer">
                    <div class="w-10 h-10 rounded-full border-2 border-amber flex items-center justify-center bg-lead relative overflow-hidden group-hover:border-white transition-colors">
                        <div class="absolute inset-0 bg-gradient-to-tr from-ruby via-amber to-royal opacity-50 group-hover:opacity-80 transition"></div>
                        <span class="relative font-serif font-bold text-xl v-wave">V</span>
                    </div>
                    <span class="text-xl font-bold tracking-widest text-white group-hover:text-amber transition-colors">VITRO <span class="text-amber group-hover:text-white transition-colors">CANVAS</span><span class="text-sm font-normal text-white ml-0.5">.gr</span></span>
                </a>
                
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center space-x-2 lg:space-x-6 whitespace-nowrap">
                        <a href="#home" onclick="navigateToSection(event, 'home')" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition">Î‘ÏÏ‡Î¹ÎºÎ®</a>
                        <a href="#about" onclick="navigateToSection(event, 'about')" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition">Î¤Î¿ Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿</a>
                        <a href="javascript:void(0)" onclick="showCatalog(event)" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</a>
                        <a href="javascript:void(0)" onclick="showBlog(event)" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition">Blog</a>
                        <a href="#workshops" onclick="navigateToSection(event, 'workshops')" class="nav-link hover:text-amber px-2 lg:px-3 py-2 rounded-md text-sm font-medium transition">Workshops</a>
                        <button onclick="openModal()" class="mr-64 bg-amber text-lead hover:bg-white px-4 py-2 rounded-md text-sm font-bold transition shadow-lg border border-amber/20">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</button>
                    </div>
                </div>
                <!-- Mobile menu button -->
                <div class="-mr-2 flex md:hidden">
                    <button type="button" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div class="hidden md:hidden bg-lead border-t border-white/10" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#home" onclick="navigateToSection(event, 'home'); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium">Î‘ÏÏ‡Î¹ÎºÎ®</a>
                <a href="#about" onclick="navigateToSection(event, 'about'); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium">Î¤Î¿ Î•ÏÎ³Î±ÏƒÏ„Î®ÏÎ¹Î¿</a>
                <a href="javascript:void(0)" onclick="showCatalog(event); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</a>
                <a href="javascript:void(0)" onclick="showBlog(event); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium">Blog</a>
                <a href="#workshops" onclick="navigateToSection(event, 'workshops'); document.getElementById('mobile-menu').classList.add('hidden');" class="block hover:text-amber px-3 py-2 rounded-md text-base font-medium">Workshops</a>
                
                <a href="javascript:void(0)" onclick="showAdminDashboard(event); document.getElementById('mobile-menu').classList.add('hidden');" id="mobile-nav-admin-link" class="hidden block text-emerald px-3 py-2 rounded-md text-base font-bold">Î Î¯Î½Î±ÎºÎ±Ï‚ Î•Î»Î­Î³Ï‡Î¿Ï…</a>
                <a href="javascript:void(0)" onclick="adminLogout(event); document.getElementById('mobile-menu').classList.add('hidden');" id="mobile-nav-logout-link" class="hidden block text-ruby px-3 py-2 rounded-md text-base font-bold">ÎˆÎ¾Î¿Î´Î¿Ï‚</a>
                <button onclick="openModal()" class="block w-full text-left text-amber px-3 py-2 rounded-md text-base font-medium">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</button>
            </div>
        </div>
    </nav>

    <!-- WRAPPER FOR LANDING PAGE SECTIONS -->
    <div id="view-landing">
        <!-- Hero Section -->
        <section id="home" class="relative h-screen flex items-center justify-center overflow-hidden bg-lead pt-20">
            <!-- Background -->
            <div class="absolute inset-0 z-0">
                <svg class="w-full h-full object-cover opacity-[0.45]" preserveAspectRatio="xMidYMid slice" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- ... existing SVG code ... -->
                    <defs>
                        <filter id="glass-blur">
                            <feGaussianBlur in="SourceGraphic" stdDeviation="1" />
                        </filter>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#b71c1c;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#5c0000;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#0d47a1;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#002171;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad3" x1="100%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fbc02d;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#c49000;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="grad4" x1="0%" y1="100%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#1b5e20;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#003300;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <rect width="400" height="300" fill="#1a1a1a" />
                    <g stroke="#1a1a1a" stroke-width="4">
                        <path d="M150,100 L250,100 L200,180 Z" fill="url(#grad3)" style="animation: glass-flicker 3s ease-in-out infinite; animation-delay: 0s;" />
                        <path d="M0,0 L150,100 L100,200 L0,300 L0,0 Z" fill="url(#grad2)" opacity="0.8" style="animation: glass-flicker 4s ease-in-out infinite; animation-delay: 1.2s;" />
                        <path d="M250,100 L400,0 L400,300 L300,200 Z" fill="url(#grad1)" opacity="0.8" style="animation: glass-flicker 3.5s ease-in-out infinite; animation-delay: 2.5s;" />
                        <path d="M0,0 L400,0 L250,100 L150,100 Z" fill="#1a237e" opacity="0.6" style="animation: glass-flicker 4.5s ease-in-out infinite; animation-delay: 0.5s;" />
                        <path d="M100,200 L200,180 L300,200 L200,300 Z" fill="url(#grad4)" style="animation: glass-flicker 3.8s ease-in-out infinite; animation-delay: 3s;" />
                        <path d="M0,300 L100,200 L200,300 Z" fill="#b71c1c" opacity="0.5" style="animation: glass-flicker 2.5s ease-in-out infinite; animation-delay: 1.5s;" />
                        <path d="M400,300 L300,200 L200,300 Z" fill="#0d47a1" opacity="0.5" style="animation: glass-flicker 3.2s ease-in-out infinite; animation-delay: 0.8s;" />
                        <path d="M150,100 L100,200 L200,180 Z" fill="#f57f17" opacity="0.7" style="animation: glass-flicker 2s ease-in-out infinite; animation-delay: 1s;" />
                        <path d="M250,100 L300,200 L200,180 Z" fill="#f57f17" opacity="0.7" style="animation: glass-flicker 2.8s ease-in-out infinite; animation-delay: 2s;" />
                    </g>
                    <rect width="400" height="300" fill="url(#grad3)" opacity="0.05" style="mix-blend-mode: overlay;" />
                </svg>
            </div>
            <div class="hero-overlay absolute inset-0 z-10 pointer-events-none"></div>
        
            <!-- NEW MARQUEE PROMO TEXT - Positioned here -->
            <div id="hero-promo-text" class="hidden absolute top-20 left-0 w-full z-30 bg-black/5 overflow-hidden py-1 border-b border-white/5 backdrop-blur-sm">
                <div class="animate-marquee whitespace-nowrap text-ruby font-bold text-xs tracking-widest inline-block">
                    ğŸ”¥ LIMITED OFFERS: Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ­Ï‚ Î¼Î±Ï‚ ÎºÎ±Î¹ Î±Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ Î­ÏÎ³Î± ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ­Ï‚ Ï„Î¹Î¼Î­Ï‚! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ğŸ”¥ LIMITED OFFERS: Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ­Ï‚ Î¼Î±Ï‚ ÎºÎ±Î¹ Î±Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ Î­ÏÎ³Î± ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ­Ï‚ Ï„Î¹Î¼Î­Ï‚! &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ğŸ”¥ LIMITED OFFERS: Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ­Ï‚ Î¼Î±Ï‚ ÎºÎ±Î¹ Î±Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ Î­ÏÎ³Î± ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ­Ï‚ Ï„Î¹Î¼Î­Ï‚!
                </div>
            </div>

            <div class="relative z-20 text-center px-4 mt-8">
                <div class="mb-6 inline-block animate-pulse">
                    <i class="fas fa-gem text-amber text-5xl animate-spin-vertical"></i>
                </div>
                <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 tracking-wider drop-shadow-lg" id="editable-hero-title">
                    Î— Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… 
                    <span class="inline-block">
                        <span class="glowing-letter" style="animation-delay: 0s;">Î¦</span><span class="glowing-letter" style="animation-delay: 0.2s;">Ï‰</span><span class="glowing-letter" style="animation-delay: 0.4s;">Ï„</span><span class="glowing-letter" style="animation-delay: 0.6s;">ÏŒ</span><span class="glowing-letter" style="animation-delay: 0.8s;">Ï‚</span>
                    </span>
                </h1>
                <p class="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mb-10 font-serif italic tracking-wide" id="editable-hero-desc">
                    Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î± Î²Î¹Ï„ÏÏŒ, Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ ÎºÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ­Ï‚ Î»ÏÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î¼ÎµÏ„Î±Î¼Î¿ÏÏ†ÏÎ½Î¿Ï…Î½ Ï„Î¿Î½ Ï‡ÏÏÎ¿ ÏƒÎ±Ï‚.
                </p>
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <button onclick="showCatalog(event)" class="bg-amber text-lead px-8 py-3 rounded-full font-bold hover:bg-white transition duration-300 shadow-[0_0_20px_rgba(251,192,45,0.4)]">
                        Î”ÎµÎ¯Ï„Îµ Ï„Î· Î£Ï…Î»Î»Î¿Î³Î®
                    </button>
                    <button onclick="openModal()" class="border border-white/30 backdrop-blur-sm text-white px-8 py-3 rounded-full font-bold hover:bg-white/10 transition duration-300">
                        Î–Î·Ï„Î®ÏƒÏ„Îµ Î ÏÎ¿ÏƒÏ†Î¿ÏÎ¬
                    </button>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-20 bg-lead">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                    <div class="relative flex justify-center items-center">
                        <svg class="w-full max-w-[500px] h-auto dynamic-spin drop-shadow-2xl opacity-40" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
                            <!-- ... existing Seal SVG code ... -->
                            <defs>
                                <path id="textCircleTop" d="M 70,250 A 180,180 0 1,1 430,250" />
                                <path id="textCircleBottom" d="M 430,250 A 180,180 0 0,1 70,250" />
                                <!-- UPDATED EMBOSS FILTER AND GOLD GRADIENT -->
                                <filter id="emboss-gloss" x="-50%" y="-50%" width="200%" height="200%">
                                    <feGaussianBlur in="SourceAlpha" stdDeviation="2" result="blur"/>
                                    <feOffset in="blur" dx="2" dy="2" result="offsetBlur"/>
                                    <feSpecularLighting in="blur" surfaceScale="5" specularConstant="0.75" specularExponent="20" lighting-color="#ffffff" result="specOut">
                                        <fePointLight x="-5000" y="-10000" z="20000"/>
                                    </feSpecularLighting>
                                    <feComposite in="specOut" in2="SourceAlpha" operator="in" result="specOut"/>
                                    <feComposite in="SourceGraphic" in2="specOut" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="litPaint"/>
                                    <feMerge>
                                        <feMergeNode in="offsetBlur"/>
                                        <feMergeNode in="litPaint"/>
                                    </feMerge>
                                </filter>
                                <linearGradient id="gold-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stop-color="#bf953f" />
                                    <stop offset="50%" stop-color="#fcf6ba" />
                                    <stop offset="100%" stop-color="#b38728" />
                                </linearGradient>
                            </defs>
                            <!-- UPDATED CIRCLES AND TEXT WITH GOLD GRADIENT AND FILTER -->
                            <circle cx="250" cy="250" r="240" fill="none" stroke="url(#gold-grad)" stroke-width="2" class="seal-stroke" filter="url(#emboss-gloss)"/>
                            <circle cx="250" cy="250" r="230" fill="none" stroke="url(#gold-grad)" stroke-width="8" stroke-dasharray="10, 5" class="seal-content" filter="url(#emboss-gloss)"/>
                            <circle cx="250" cy="250" r="220" fill="none" stroke="url(#gold-grad)" stroke-width="2" class="seal-stroke" filter="url(#emboss-gloss)"/>
                            <circle cx="250" cy="250" r="220" fill="#fbc02d" fill-opacity="0.05" />
                            
                            <text fill="url(#gold-grad)" font-family="'Cinzel', serif" font-size="55" font-weight="bold" letter-spacing="10" class="seal-content" filter="url(#emboss-gloss)">
                                <textPath href="#textCircleTop" startOffset="50%" text-anchor="middle">
                                    VITRO CANVAS
                                </textPath>
                            </text>
                            <text fill="url(#gold-grad)" font-family="'Montserrat', sans-serif" font-size="24" font-weight="300" letter-spacing="8" class="seal-content" filter="url(#emboss-gloss)">
                                <textPath href="#textCircleBottom" startOffset="50%" text-anchor="middle">
                                    HANDMADE IN THESSALONIKI
                                </textPath>
                            </text>
                            <circle cx="250" cy="250" r="130" fill="none" stroke="url(#gold-grad)" stroke-width="3" class="seal-stroke" filter="url(#emboss-gloss)"/>
                            <g transform="translate(250, 250)">
                                <path d="M0,-110 L25,-25 L110,0 L25,25 L0,110 L-25,25 L-110,0 L-25,-25 Z" fill="none" stroke="url(#gold-grad)" stroke-width="2" class="seal-stroke" filter="url(#emboss-gloss)"/>
                                <path d="M0,-110 L0,110 M-110,0 L110,0" stroke="url(#gold-grad)" stroke-width="1" class="seal-stroke" filter="url(#emboss-gloss)"/>
                                <circle cx="0" cy="0" r="8" fill="url(#gold-grad)" class="seal-content" filter="url(#emboss-gloss)"/>
                                <path d="M0,-110 Q40,-40 110,0 Q40,40 0,110 Q-40,40 -110,0 Q-40,-40 0,-110" fill="none" stroke="url(#gold-grad)" stroke-width="1" opacity="0.6" class="seal-stroke" filter="url(#emboss-gloss)"/>
                                <text x="0" y="-45" text-anchor="middle" fill="url(#gold-grad)" font-family="'Cinzel', serif" font-size="20" font-weight="bold" class="seal-content" filter="url(#emboss-gloss)">EST.</text>
                                <text x="0" y="65" text-anchor="middle" fill="url(#gold-grad)" font-family="'Cinzel', serif" font-size="24" font-weight="bold" class="seal-content" filter="url(#emboss-gloss)">2024</text>
                            </g>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-white mb-6">Î£Ï‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î· <span class="text-amber">Vitro Canvas</span></h2>
                        <div id="editable-about-text">
                            <p class="text-gray-400 mb-6 leading-relaxed">
                                Î¤Î¿ ÎµÏÎ³Î±ÏƒÏ„Î®ÏÎ¹ÏŒ Î¼Î±Ï‚ ÏƒÏ„Î· ÎÎ­Î± ÎšÎµÏÎ±ÏƒÎ¹Î¬ ÏƒÏ…Î½Î´Ï…Î¬Î¶ÎµÎ¹ Ï„Î·Î½ Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ® Î´ÎµÎ¾Î¹ÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î· ÏƒÏÎ³Ï‡ÏÎ¿Î½Î· Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ®. ÎŸÎ½Î¿Î¼Î¬Î¶Î¿Î¼Î±Î¹ <strong class="text-white">Î§Î¬ÏÎ·Ï‚ Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î¿Ï…</strong> ÎºÎ±Î¹ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ Î¼Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î· Ï€Î±ÏÎ¿Ï‡Î® Î»ÏÏƒÎµÏ‰Î½ Î³Ï…Î±Î»Î¹Î¿Ï Ï…ÏˆÎ·Î»Î®Ï‚ Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ®Ï‚ Î³Î¹Î± Î¹Î´Î¹ÏÏ„ÎµÏ‚ ÎºÎ±Î¹ ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚.
                            </p>
                            <p class="text-gray-400 mb-8 leading-relaxed">
                                Î‘Ï€ÏŒ Ï„Î·Î½ ÎºÎ»Î±ÏƒÎ¹ÎºÎ® Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î¼Î¿Î»ÏÎ²Î´Î¿Ï… Î¼Î­Ï‡ÏÎ¹ Ï„Î·Î½ Î»ÎµÏ€Ï„ÎµÏ€Î¯Î»ÎµÏ€Ï„Î· Î¼Î­Î¸Î¿Î´Î¿ Tiffany, ÎºÎ¬Î¸Îµ Î­ÏÎ³Î¿ ÎµÎ¯Î½Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ, ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î¿ Î³Î¹Î± Î½Î± Ï€Î±Î¯Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Ï†Ï‰Ï‚ ÎºÎ±Î¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï„Î¼ÏŒÏƒÏ†Î±Î¹ÏÎ±.
                            </p>
                        </div>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="p-4 border border-white/10 rounded-lg">
                                <i class="fas fa-hand-holding-heart text-ruby text-2xl mb-2"></i>
                                <h4 class="font-bold text-sm">Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î¿</h4>
                            </div>
                            <div class="p-4 border border-white/10 rounded-lg">
                                <i class="fas fa-history text-royal text-2xl mb-2"></i>
                                <h4 class="font-bold text-sm">Î”Î¹Î±Ï‡ÏÎ¿Î½Î¹ÎºÏŒ</h4>
                            </div>
                            <div class="p-4 border border-white/10 rounded-lg">
                                <i class="fas fa-tools text-emerald text-2xl mb-2"></i>
                                <h4 class="font-bold text-sm">Custom</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Preview -->
        <section id="services" class="py-20 bg-[#121212]">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯ÎµÏ‚ & Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚</h2>
                    <div class="w-24 h-1 bg-amber mx-auto"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Products/Services Images - Now Drop Zones -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-1" onclick="handleImageClick(this, 'static', 'img-service-1')" src="https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=800&q=65" alt="Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-1" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Vitro+Art';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-white mb-2">Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÏŒ Î’Î¹Ï„ÏÏŒ</h3>
                            <p class="text-gray-400 text-sm mb-4">Î Î±ÏÎ¬Î¸Ï…ÏÎ±, Ï†ÎµÎ³Î³Î¯Ï„ÎµÏ‚ ÎºÎ±Î¹ Ï€ÏŒÏÏ„ÎµÏ‚ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… Ï€Î¿Ï… Î±Î»Î»Î¬Î¶Î¿Ï…Î½ Ï„Î·Î½ ÏŒÏˆÎ· Ï„Î¿Ï… ÎºÏ„Î¹ÏÎ¯Î¿Ï….</p>
                            <a href="javascript:void(0)" onclick="showCatalog(event)" class="text-amber text-sm font-bold hover:underline">Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                    <!-- Product 2 -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-2" onclick="handleImageClick(this, 'static', 'img-service-2')" src="https://images.unsplash.com/photo-jQdj6IEPbnc?auto=format&fit=crop&w=800&q=65" alt="ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-2" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Glass+Jewelry';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-white mb-2">ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±</h3>
                            <p class="text-gray-400 text-sm mb-4">ÎœÎ¿Î½Î±Î´Î¹ÎºÎ¬ Ï‡ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î± ÎºÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î± ÎºÎ±Î¹ Î±Î¾ÎµÏƒÎ¿Ï…Î¬Ï Î±Ï€ÏŒ Î³Ï…Î±Î»Î¯ Î³Î¹Î± Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹Ï‚.</p>
                            <a href="javascript:void(0)" onclick="showCatalog(event)" class="text-amber text-sm font-bold hover:underline">Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                    <!-- Product 3 -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-3" onclick="handleImageClick(this, 'static', 'img-service-3')" src="https://images.unsplash.com/photo-JAQmddE76RY?auto=format&fit=crop&w=800&q=65" alt="Suncatchers" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-3" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Suncatchers';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-white mb-2">Suncatchers & Decor</h3>
                            <p class="text-gray-400 text-sm mb-4">ÎœÎ¹ÎºÏÎ¬ Î´Î¹Î±ÎºÎ¿ÏƒÎ¼Î·Ï„Î¹ÎºÎ¬, Ï†Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ Tiffany ÎºÎ±Î¹ ÎºÎ±Î¸ÏÎ­Ï†Ï„ÎµÏ‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ Î³Ï‰Î½Î¹Î¬.</p>
                            <a href="javascript:void(0)" onclick="showCatalog(event)" class="text-amber text-sm font-bold hover:underline">Î”ÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                    <!-- Service 4 -->
                    <div class="glass-card rounded-xl overflow-hidden group">
                        <div class="h-64 overflow-hidden relative">
                            <img id="img-service-4" onclick="handleImageClick(this, 'static', 'img-service-4')" src="https://images.unsplash.com/photo-REEUPkG0WoU?auto=format&fit=crop&w=800&q=65" alt="Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="static" data-id="img-service-4" onerror="this.src='https://placehold.co/400x300/333/FFF?text=Restoration';">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-transparent transition pointer-events-none"></div>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-white mb-2">Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ· & Î‘Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</h3>
                            <p class="text-gray-400 text-sm mb-4">Î•Î¾ÎµÎ¹Î´Î¹ÎºÎµÏ…Î¼Î­Î½Î· ÎµÏ€Î¹ÏƒÎºÎµÏ…Î® Ï€Î±Î»Î±Î¹ÏÎ½ Î²Î¹Ï„ÏÏŒ ÏƒÎµ Î½ÎµÎ¿ÎºÎ»Î±ÏƒÎ¹ÎºÎ¬ ÎºÎ±Î¹ ÎµÎºÎºÎ»Î·ÏƒÎ¯ÎµÏ‚.</p>
                            <a href="javascript:void(0)" onclick="openModal()" class="text-amber text-sm font-bold hover:underline">Î–Î·Ï„Î®ÏƒÏ„Îµ ÎµÎºÏ„Î¯Î¼Î·ÏƒÎ· <i class="fas fa-arrow-right ml-1"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Workshops Section -->
        <section id="workshops" data-id="workshops-bg" class="admin-editable-bg py-20 relative bg-fixed bg-cover bg-center" onclick="handleImageClick(this, 'static', 'workshops-bg')" style="background-image: url('https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=1920&q=65');">
            <div class="absolute inset-0 bg-lead/90 pointer-events-none"></div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 pointer-events-none">
                <div class="flex flex-col md:flex-row items-center justify-between gap-10">
                    <div class="md:w-1/2 pointer-events-auto">
                        <h2 class="text-3xl md:text-5xl font-bold text-white mb-6">ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î·Î½ Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… Î’Î¹Ï„ÏÏŒ</h2>
                        <p class="text-gray-300 text-lg mb-8">
                            Î”Î¹Î¿ÏÎ³Î±Î½ÏÎ½Î¿Ï…Î¼Îµ Î´Î¹Î®Î¼ÎµÏÎ± workshops Î³Î¹Î± Î±ÏÏ‡Î¬ÏÎ¹Î¿Ï…Ï‚. ÎœÎ¬Î¸ÎµÏ„Îµ Î½Î± ÎºÏŒÎ²ÎµÏ„Îµ, Î½Î± Ï„ÏÎ¿Ï‡Î¯Î¶ÎµÏ„Îµ ÎºÎ±Î¹ Î½Î± ÎºÎ¿Î»Î»Î¬Ï„Îµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ±Ï‚ Î­ÏÎ³Î¿ Ï„Î­Ï‡Î½Î·Ï‚.
                        </p>
                        <!-- ... list ... -->
                        <ul class="space-y-4 mb-8">
                            <li class="flex items-center text-gray-300"><i class="fas fa-check text-amber mr-3"></i> ÎŒÎ»Î± Ï„Î± Ï…Î»Î¹ÎºÎ¬ Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Î¹</li>
                            <li class="flex items-center text-gray-300"><i class="fas fa-check text-amber mr-3"></i> ÎŸÎ»Î¹Î³Î¿Î¼ÎµÎ»Î® Ï„Î¼Î®Î¼Î±Ï„Î±</li>
                            <li class="flex items-center text-gray-300"><i class="fas fa-check text-amber mr-3"></i> Î Î±Î¯ÏÎ½ÎµÏ„Îµ Ï„Î¿ Î­ÏÎ³Î¿ ÏƒÏ€Î¯Ï„Î¹ ÏƒÎ±Ï‚</li>
                        </ul>
                        <a href="#contact" class="bg-ruby text-white px-8 py-3 rounded-full font-bold hover:bg-red-700 transition duration-300">
                            ÎšÎ»ÎµÎ¯ÏƒÏ„Îµ Î˜Î­ÏƒÎ· Î¤ÏÏÎ±
                        </a>
                    </div>
                    <div class="md:w-1/2 pointer-events-auto">
                        <div class="bg-white/5 p-2 rounded-lg backdrop-blur-sm border border-white/10">
                            <img id="img-workshops" onclick="handleImageClick(this, 'static', 'img-workshops')" src="https://images.unsplash.com/photo-aNdR7FKIg5w?auto=format&fit=crop&w=800&q=65" alt="Workshop Class" class="admin-editable-img rounded w-full" data-type="static" data-id="img-workshops" onerror="this.src='https://placehold.co/600x400/222/FFF?text=Workshop+Session';">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-20 bg-lead">
            <!-- ... existing contact content ... -->
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-white mb-8">Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±</h2>
                        <p class="text-gray-400 mb-10">Î•Î½Î´Î¹Î±Ï†Î­ÏÎµÏƒÏ„Îµ Î³Î¹Î± Î¼Î¹Î± custom Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î® Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹Î± Ï„Î± Î¼Î±Î¸Î®Î¼Î±Ï„Î±; Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÏ„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚.</p>
                        <div class="space-y-6">
                            <div class="flex items-start">
                                <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-amber text-xl flex-shrink-0"><i class="fas fa-map-marker-alt"></i></div>
                                <div class="ml-4"><h4 class="text-white font-bold">Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·</h4><p class="text-gray-400">ÎÎ­Î± ÎšÎµÏÎ±ÏƒÎ¹Î¬, Î˜ÎµÏƒÏƒÎ±Î»Î¿Î½Î¯ÎºÎ·</p></div>
                            </div>
                            <div class="flex items-start">
                                <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-amber text-xl flex-shrink-0"><i class="fas fa-phone-alt"></i></div>
                                <div class="ml-4"><h4 class="text-white font-bold">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</h4><p class="text-gray-400" id="editable-phone">+30 6973 807 097</p></div>
                            </div>
                            <div class="flex items-start">
                                <div class="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center text-amber text-xl flex-shrink-0"><i class="fas fa-envelope"></i></div>
                                <div class="ml-4"><h4 class="text-white font-bold">Email</h4><p class="text-gray-400">info@vitrocanvas.gr</p></div>
                            </div>
                        </div>
                        <!-- ... social icons ... -->
                        <div class="mt-10 flex space-x-6">
                            <a href="#" class="text-gray-400 hover:text-amber text-2xl transition link-instagram"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="text-gray-400 hover:text-blue-600 text-2xl transition link-facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="text-gray-400 hover:text-red-600 text-2xl transition link-pinterest"><i class="fab fa-pinterest-p"></i></a>
                        </div>
                    </div>
                    <div class="glass-card p-8 rounded-2xl">
                        <form onsubmit="event.preventDefault(); showToast('Î¤Î¿ Î¼Î®Î½Ï…Î¼Î¬ ÏƒÎ±Ï‚ ÎµÏƒÏ„Î¬Î»Î·! Î˜Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎ¿Ï…Î¼Îµ ÏƒÏÎ½Ï„Î¿Î¼Î±.');">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div><label class="block text-gray-400 text-sm mb-2">ÎŒÎ½Î¿Î¼Î±</label><input type="text" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="Î¤Î¿ ÏŒÎ½Î¿Î¼Î¬ ÏƒÎ±Ï‚"></div>
                                <div><label class="block text-gray-400 text-sm mb-2">Email</label><input type="email" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="email@example.com"></div>
                            </div>
                            <div class="mb-6"><label class="block text-gray-400 text-sm mb-2">Î¤Î·Î»Î­Ï†Ï‰Î½Î¿</label><input type="tel" class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition" placeholder="+30 69XX XXX XXX"></div>
                            <div class="mb-6"><label class="block text-gray-400 text-sm mb-2">Î˜Î­Î¼Î±</label><select class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition"><option>Î“ÎµÎ½Î¹ÎºÎ® Î•ÏÏÏ„Î·ÏƒÎ·</option><option>Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î’Î¹Ï„ÏÏŒ</option><option>ÎšÎ¿ÏƒÎ¼Î®Î¼Î±Ï„Î±</option><option>Î•Ï€Î¹ÏƒÎºÎµÏ…Î®</option><option>Î£Ï…Î¼Î¼ÎµÏ„Î¿Ï‡Î® ÏƒÎµ Workshop</option></select></div>
                            <div class="mb-6"><label class="block text-gray-400 text-sm mb-2">ÎœÎ®Î½Ï…Î¼Î±</label><textarea class="w-full bg-black/30 border border-gray-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-amber transition h-32" placeholder="Î ÏÏ‚ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î¼Îµ;"></textarea></div>
                            <button type="submit" class="w-full bg-amber text-lead font-bold py-4 rounded-lg hover:bg-white transition duration-300">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎœÎ·Î½ÏÎ¼Î±Ï„Î¿Ï‚</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- PRODUCTS CATALOG VIEW (Hidden by default) -->
    <div id="view-catalog" class="hidden pt-32 pb-20 min-h-screen bg-lead">
        <!-- ... existing catalog code ... -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center mb-10">
                <div>
                    <h2 class="text-3xl md:text-4xl font-bold text-white">ÎšÎ±Ï„Î¬Î»Î¿Î³Î¿Ï‚ Î ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½</h2>
                    <div class="w-20 h-1 bg-amber mt-2"></div>
                </div>
                <!-- Admin Button (Shows in Dashboard instead) -->
            </div>

            <!-- Products Grid -->
            <div id="catalog-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- Initial Products will be rendered here by JS -->
            </div>
        </div>
    </div>

    <!-- NEW BLOG LIST VIEW (Hidden by default) -->
    <div id="view-blog" class="hidden pt-32 pb-20 min-h-screen bg-lead">
        <!-- ... existing blog list code ... -->
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-end mb-16">
                <div class="text-center w-full relative">
                    <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Î¤Î¿ Blog Î¼Î±Ï‚</h2>
                    <div class="w-24 h-1 bg-amber mx-auto"></div>
                    <p class="text-gray-400 mt-4 font-serif italic">Î™ÏƒÏ„Î¿ÏÎ¯Î±, Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ ÎºÎ±Î¹ Î½Î­Î± Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏŒÏƒÎ¼Î¿ Ï„Î¿Ï… Î³Ï…Î±Î»Î¹Î¿Ï.</p>
                </div>
            </div>

            <!-- Blog Timeline Grid (Populated by JS) -->
            <div id="blog-list-container" class="space-y-12">
                <!-- Blog posts will be injected here -->
            </div>
        </div>
    </div>

    <!-- NEW SINGLE BLOG POST VIEW (Hidden by default) -->
    <div id="view-blog-single" class="hidden pt-32 pb-20 min-h-screen bg-lead">
        <!-- ... existing single blog code ... -->
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Back Button -->
            <button onclick="showBlog(event)" class="mb-8 flex items-center text-amber hover:text-white transition font-bold">
                <i class="fas fa-arrow-left mr-2"></i> Î Î¯ÏƒÏ‰ ÏƒÏ„Î¿ Blog
            </button>

            <!-- Article Content (Populated by JS) -->
            <article id="blog-single-content" class="glass-card p-8 md:p-12 rounded-2xl border border-white/5">
                <!-- Content injected here -->
            </article>
        </div>
    </div>

    <!-- ADMIN DASHBOARD VIEW (NEW) -->
    

    <!-- Footer -->
    <footer class="bg-black py-10 border-t border-white/10">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-gray-500 text-sm">
                &copy; 2024 VITRO CANVAS. All rights reserved. | Created by Harris Eleftheriou
                <!-- HIDDEN ADMIN TRIGGER -->
                
            </p>
        </div>
    </footer>

    <script>
        function showToast(message) {
            const toast = document.getElementById('toast');
            const msgElement = document.getElementById('toast-message');
            msgElement.textContent = message;
            toast.classList.remove('hidden');
            setTimeout(() => { toast.classList.remove('translate-y-20', 'opacity-0'); }, 10);
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
                setTimeout(() => { toast.classList.add('hidden'); }, 3000); // Wait 3s then hide
            }, 3000);
        }

// --- THEME PRESETS (optional, zero-impact unless used) ---
        // Keeps the current visuals unchanged by default.
        const THEME_PRESETS = {
            vitro: {
                "--color-primary": "#fbc02d",
                "--glass-opacity": "0.6",
                "--glow-start": "#fbc02d",
                "--glow-end": "#b71c1c",
                "--spin-speed": "60s"
            },
            handmade: {
                "--color-primary": "#d97706",
                "--glass-opacity": "0.55",
                "--glow-start": "#f59e0b",
                "--glow-end": "#10b981",
                "--spin-speed": "70s"
            }
        };

        const THEME_PRESET_IMAGES = {
            vitro: {
                "img-service-1": "https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=800&q=65",
                "img-service-2": "https://images.unsplash.com/photo-jQdj6IEPbnc?auto=format&fit=crop&w=800&q=65",
                "img-service-3": "https://images.unsplash.com/photo-JAQmddE76RY?auto=format&fit=crop&w=800&q=65",
                "img-service-4": "https://images.unsplash.com/photo-REEUPkG0WoU?auto=format&fit=crop&w=800&q=65",
                "img-workshops": "https://images.unsplash.com/photo-aNdR7FKIg5w?auto=format&fit=crop&w=800&q=65",
                "workshops-bg": "https://images.unsplash.com/photo-GA9MQa1we4I?auto=format&fit=crop&w=1920&q=65"
            },
            handmade: {
                "img-service-1": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=800&q=65",
                "img-service-2": "https://images.unsplash.com/photo-V1Gry60Knlo?auto=format&fit=crop&w=800&q=65",
                "img-service-3": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=800&q=65",
                "img-service-4": "https://images.unsplash.com/photo-V1Gry60Knlo?auto=format&fit=crop&w=800&q=65",
                "img-workshops": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=800&q=65",
                "workshops-bg": "https://images.unsplash.com/photo-CDPqPy-wnxM?auto=format&fit=crop&w=1920&q=65"
            }
        };

        function applyThemeImages(name) {
            const imgs = THEME_PRESET_IMAGES[name];
            if (!imgs) return;
            // Overwrite staticImages and persist so the admin panel sees them too
            staticImages = { ...staticImages, ...imgs };
            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
            applyStaticImages();
        }



        // Apply a preset theme by setting CSS variables. Does NOT touch your layout/components.
        function applyThemePreset(name) {
            const preset = THEME_PRESETS[name];
            if (!preset) return;
            const root = document.documentElement;
            for (const [k, v] of Object.entries(preset)) root.style.setProperty(k, v);
            document.documentElement.setAttribute('data-theme', name);
            applyThemeImages(name);
            showToast(`Theme: ${name}`);
        }

        // One-click reset for non-technical users:
        // - forces the current theme's default images
        // - clears any stored overrides for images
        window.resetDefaultImagesForTheme = function(themeName) {
            const name = themeName || document.documentElement.getAttribute('data-theme') || 'vitro';
            const pack = THEME_PRESET_IMAGES[name] || THEME_PRESET_IMAGES.vitro;
            staticImages = { ...pack };
            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
            localStorage.setItem('vitro_assets_version', DEFAULT_ASSETS_VERSION);
            applyStaticImages();
            showToast('ÎˆÎ³Î¹Î½Îµ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬ Ï†Ï‰Ï„Î¿Î³ÏÎ±Ï†Î¹ÏÎ½.');
        };



        function toggleAiLoader(show) {
            const el = document.getElementById('ai-toast');
            if(show) el.classList.remove('hidden');
            else el.classList.add('hidden');
        }
        
        function toggleKeyVisibility() {
            const input = document.getElementById('gemini-api-key');
            const icon = document.getElementById('eye-icon');
            if (input.type === "password") {
                input.type = "text";
                icon.classList.replace("fa-eye", "fa-eye-slash");
            } else {
                input.type = "password";
                icon.classList.replace("fa-eye-slash", "fa-eye");
            }
        }

        // --- AUTH & ANALYTICS INIT ---
        let isAdmin = localStorage.getItem('vitro_isAdmin') === 'true';
        let isMaintenance = localStorage.getItem('vitro_maintenance') === 'true';
        
        // Init Analytics Counters
        let analytics = JSON.parse(localStorage.getItem('vitro_analytics')) || {
            totalVisits: 0,
            pageViews: { home: 0, catalog: 0, blog: 0, workshops: 0 }
        };
        if(!sessionStorage.getItem('session_started')) {
            analytics.totalVisits++;
            localStorage.setItem('vitro_analytics', JSON.stringify(analytics));
            sessionStorage.setItem('session_started', 'true');
        }

        // Load Data - Changed to LET to allow re-assignment during import
        let staticImages = JSON.parse(localStorage.getItem('vitro_static_images')) || {};
        // --- Default image pack versioning (so new image sets actually show up) ---
        const DEFAULT_ASSETS_VERSION = '2026-01-31-images-v1';
        const currentAssetsVersion = localStorage.getItem('vitro_assets_version');

        // If you have old saved images in your browser (LocalStorage), they override the file.
        // This block safely migrates to the new default images once, while keeping a backup.
        if (currentAssetsVersion !== DEFAULT_ASSETS_VERSION) {
            try {
                const old = localStorage.getItem('vitro_static_images');
                if (old) localStorage.setItem('vitro_static_images_backup_' + Date.now(), old);
            } catch (e) {}
            staticImages = { ...(THEME_PRESET_IMAGES?.vitro || {}) };
            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
            localStorage.setItem('vitro_assets_version', DEFAULT_ASSETS_VERSION);
        }

        let globalTexts = JSON.parse(localStorage.getItem('vitro_texts')) || {};
        let globalGraphics = JSON.parse(localStorage.getItem('vitro_graphics')) || { 
            primary: '#fbc02d',
            opacity: '0.6',
            glowStart: '#fbc02d', 
            glowEnd: '#b71c1c', 
            spinSpeed: '60' 
        };
        // AI State
        let geminiKey = localStorage.getItem('vitro_gemini_key') || "";
        let geminiModel = localStorage.getItem('vitro_gemini_model') || "";

        let lastAiDate = parseInt(localStorage.getItem('vitro_last_ai_date')) || 0;

        // --- DRAG AND DROP LOGIC ---
        function initDragAndDrop() {
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
        }

        // Explicitly called after renders to attach drag events to new elements
        function enableImageDropZones() {
            if (!isAdmin) return;
            // Only add if not inline-handled (static imgs or specific zones)
            const images = document.querySelectorAll('.admin-editable-img, .admin-editable-bg, #drop-zone-info');
            images.forEach(img => {
                // Check if already bound to avoid duplicates on static elements
                if(img.dataset.bound === 'true') return; 
                
                img.addEventListener('dragenter', highlight, false);
                img.addEventListener('dragover', highlight, false);
                img.addEventListener('dragleave', unhighlight, false);
                img.addEventListener('drop', handleDrop, false);
                
                img.dataset.bound = 'true'; // Mark as bound
            });
        }

        function highlight(e) { this.classList.add('drag-over'); }
        function unhighlight(e) { this.classList.remove('drag-over'); }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.name.endsWith('.json')) {
                    importData(file);
                    this.classList.remove('drag-over');
                    return;
                }
                if (file.type.startsWith('image/')) {
                    if (this.id === 'drop-zone-info') showToast('Î£ÏÏÎµÏ„Îµ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿ Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î±Î»Î»Î¬Î¾ÎµÏ„Îµ.');
                    else handleFileSelect(file, this);
                } else {
                    showToast('Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏÏÎµÏ„Îµ Î¼ÏŒÎ½Î¿ Î±ÏÏ‡ÎµÎ¯Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ Î® .json backup.');
                }
            }
            this.classList.remove('drag-over');
        }

        function handleFileSelect(file, element) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const result = e.target.result;
                
                // Safe check for quota
                try {
                    // Static ID Check
                    const id = element.id || element.dataset.id;
                    
                    if (element.classList.contains('admin-editable-bg') || (id && id.endsWith('-bg'))) {
                        element.style.backgroundImage = `url('${result}')`;
                        if (id) {
                             staticImages[id] = result;
                             localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                        }
                    } else {
                        element.src = result;
                         // Specific static images
                        if (id && (id.startsWith('img-service') || id.startsWith('img-about') || id.startsWith('img-workshops'))) {
                            staticImages[id] = result;
                            localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                            showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!');
                            return;
                        }
                    }

                    // Dynamic Data Attributes Check
                    if (element.dataset.type === 'product') {
                        const prodId = parseInt(element.dataset.id);
                        const prod = products.find(p => p.id === prodId);
                        if (prod) { 
                            prod.image = result; 
                            saveProducts(); 
                            renderProducts(); // Re-render to ensure persistence visual
                            showToast('Î ÏÎ¿ÏŠÏŒÎ½ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!'); 
                        }
                    } else if (element.dataset.type === 'blog') {
                        const postId = parseInt(element.dataset.id);
                        const post = blogPosts.find(p => p.id === postId);
                        if (post) { 
                            post.image = result; 
                            saveBlogPosts(); 
                            renderBlogList(); // Re-render
                            showToast('Î†ÏÎ¸ÏÎ¿ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!'); 
                        }
                    }
                } catch (err) {
                    if (err.name === 'QuotaExceededError') {
                        showToast('Î£Ï†Î¬Î»Î¼Î±: Î— Î¼Î½Î®Î¼Î· Ï„Î¿Ï… browser Î³Î­Î¼Î¹ÏƒÎµ. Î— ÎµÎ¹ÎºÏŒÎ½Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î¼ÎµÎ³Î¬Î»Î·.');
                    } else {
                        console.error(err);
                    }
                }
            };
            reader.readAsDataURL(file);
        }

        // --- BACKUP & RESTORE ---
        function exportData() {
            const data = {
                products, blogPosts, staticImages, globalTexts, globalGraphics, analytics,
                lastAiDate, // Save AI state
                timestamp: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data)], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "vitro_backup.json";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('Î¤Î¿ backup ÎºÎ±Ï„Î­Î²Î·ÎºÎµ!');
        }

        function importData(file) {
            if(!file) return;
            showToast('Î‘Î½Î¬Î³Î½Ï‰ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Î¿Ï…...');
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const data = JSON.parse(event.target.result);
                    
                    // 1. Update In-Memory Variables Immediately (Hot Load)
                    if (data.products) products = data.products;
                    if (data.blogPosts) blogPosts = data.blogPosts;
                    if (data.staticImages) staticImages = data.staticImages;
                    if (data.globalTexts) globalTexts = data.globalTexts;
                    if (data.globalGraphics) globalGraphics = data.globalGraphics;
                    if (data.analytics) analytics = data.analytics;
                    if (data.lastAiDate) lastAiDate = data.lastAiDate;

                    // 2. Re-render everything immediately
                    renderProducts();
                    renderBlogList();
                    applyStaticImages();
                    applyGlobalSettings();
                    updateAdminTables();
                    
                    showToast('Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎ±Î½ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!');

                    // 3. Try to save to LocalStorage (Might fail if too big)
                    try {
                        localStorage.setItem('vitro_products', JSON.stringify(products));
                        localStorage.setItem('vitro_blog', JSON.stringify(blogPosts));
                        localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                        localStorage.setItem('vitro_texts', JSON.stringify(globalTexts));
                        localStorage.setItem('vitro_graphics', JSON.stringify(globalGraphics));
                        localStorage.setItem('vitro_analytics', JSON.stringify(analytics));
                        localStorage.setItem('vitro_last_ai_date', lastAiDate);
                        
                        // If we reached here, save was successful. We can reload to be clean.
                        showToast('Î•Ï€Î¹Ï„Ï…Ï‡Î®Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·! Î— ÏƒÎµÎ»Î¯Î´Î± Î¸Î± Î±Î½Î±Î½ÎµÏ‰Î¸ÎµÎ¯.');
                        setTimeout(() => location.reload(), 1000);
                        
                    } catch (storageError) {
                        if (storageError.name === 'QuotaExceededError') {
                            alert("Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ backup Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎµ, Î±Î»Î»Î¬ ÎµÎ¯Î½Î±Î¹ Î ÎŸÎ›Î¥ ÎœÎ•Î“Î‘Î›ÎŸ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ Î¼ÏŒÎ½Î¹Î¼Î± ÏƒÏ„Î· Î¼Î½Î®Î¼Î· Ï„Î¿Ï… browser.\n\nÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„ÏÏÎ±, Î±Î»Î»Î¬ Î±Î½ ÎºÎ¬Î½ÎµÏ„Îµ Î±Î½Î±Î½Î­Ï‰ÏƒÎ· (refresh), Î¸Î± Ï‡Î±Î¸Î¿ÏÎ½.");
                        } else {
                            console.error(storageError);
                        }
                    }

                } catch (e) {
                    showToast('Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿. Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î· Î¼Î¿ÏÏ†Î®.');
                    console.error(e);
                    alert("Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®: " + e.message);
                }
            };
            reader.readAsText(file);
        }

        // --- MAINTENANCE MODE ---
        function toggleMaintenanceMode() {
            isMaintenance = document.getElementById('maintenance-toggle').checked;
            localStorage.setItem('vitro_maintenance', isMaintenance);
            const statusText = document.getElementById('maintenance-status-text');
            
            if (isMaintenance) {
                statusText.innerText = "Î•Î½ÎµÏÎ³ÏŒ (Site ÎšÎ»ÎµÎ¹ÏƒÏ„ÏŒ)";
                statusText.classList.add('text-red-400');
                document.getElementById('maintenance-banner').classList.remove('hidden');
                showToast('Maintenance Mode Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ.');
            } else {
                statusText.innerText = "Î‘Î½ÎµÎ½ÎµÏÎ³ÏŒ (Site Î‘Î½Î¿Î¹Ï‡Ï„ÏŒ)";
                statusText.classList.remove('text-red-400');
                document.getElementById('maintenance-banner').classList.add('hidden');
                showToast('Maintenance Mode Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ.');
            }
        }
        
        function checkMaintenance() {
            // Setup toggle switch UI state
            const toggle = document.getElementById('maintenance-toggle');
            if(toggle) {
                toggle.checked = isMaintenance;
                const statusText = document.getElementById('maintenance-status-text');
                if (isMaintenance) {
                    statusText.innerText = "Î•Î½ÎµÏÎ³ÏŒ (Site ÎšÎ»ÎµÎ¹ÏƒÏ„ÏŒ)";
                    statusText.classList.add('text-red-400');
                }
            }

            if (isMaintenance) {
                if (!isAdmin) {
                    // Visitor: Show only maintenance screen
                    document.getElementById('view-landing').classList.add('hidden');
                    document.getElementById('view-catalog').classList.add('hidden');
                    document.getElementById('view-blog').classList.add('hidden');
                    document.getElementById('view-blog-single').classList.add('hidden');
                    document.getElementById('view-admin-dashboard')?.classList.add('hidden');
                    document.getElementById('main-nav').classList.add('hidden'); // Hide menu
                    
                    document.getElementById('view-maintenance').classList.remove('hidden');
                } else {
                    // Admin: Show banner
                    document.getElementById('maintenance-banner').classList.remove('hidden');
                }
            } else {
                document.getElementById('view-maintenance').classList.add('hidden');
                document.getElementById('maintenance-banner').classList.add('hidden');
                document.getElementById('main-nav').classList.remove('hidden');
            }
        }

        // --- AI BLOG GENERATION LOGIC ---
        // Gemini helper: list models and pick a generateContent-capable model (client-side)
        async function getBestGeminiModel(key) {
            const preferred = [
                "gemini-2.5-flash",
                "gemini-2.0-flash",
                "gemini-1.5-flash",
                "gemini-1.5-pro",
            ];
            const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${key}`);
            if (!resp.ok) {
                const err = await resp.json().catch(() => ({}));
                throw new Error(err?.error?.message || `Î£Ï†Î¬Î»Î¼Î± Google (ListModels): ${resp.status}`);
            }
            const data = await resp.json();
            const models = Array.isArray(data.models) ? data.models : [];
            // filter models that support generateContent
            const eligible = models.filter(m => Array.isArray(m.supportedGenerationMethods) && m.supportedGenerationMethods.includes("generateContent"));
            if (!eligible.length) throw new Error("Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿ Ï€Î¿Ï… Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ generateContent.");
            // choose preferred if exists
            for (const p of preferred) {
                const found = eligible.find(m => (m.name || "").endsWith(p));
                if (found) return found.name; // e.g. "models/gemini-2.5-flash"
            }
            return eligible[0].name;
        }


        async function saveGeminiKey(event) {
            if(event) event.preventDefault();
            const btn = event?.currentTarget || document.querySelector('button[onclick*="saveGeminiKey"]'); 
            const keyInput = document.getElementById('gemini-api-key');
            let key = keyInput.value.trim();
            
            if(!key) {
                showToast('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯.');
                return;
            }

            // Client-side quick check
            if (!key.startsWith('AIza')) {
                 showToast('Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¾ÎµÎºÎ¹Î½Î¬ Î¼Îµ "AIza".');
                 return;
            }
            
            // Validate key
            const originalText = btn.innerText;
            btn.innerText = "ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚...";
            btn.disabled = true;

            try {
                // Validation Request using generateContent with gemini-1.5-flash-latest
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${key}`);
if (!response.ok) {
                   const errorData = await response.json();
                   console.warn("Gemini Validation Error:", errorData);
                   
                   // Check for common error codes
                   if (response.status === 400 && errorData.error?.status === 'INVALID_ARGUMENT') {
                        throw new Error('Î›Î¬Î¸Î¿Ï‚ ÎšÎ»ÎµÎ¹Î´Î¯ (Invalid Key). Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î·Î½ Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î®.');
                   } else if (response.status === 403) {
                       throw new Error('Î‘Ï€Î±Î³Î¿ÏÎµÏÎµÏ„Î±Î¹ Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·. Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ Ï„Î¿Ï… ÎºÎ»ÎµÎ¹Î´Î¹Î¿Ï.');
                   }
                   
                   throw new Error(`Î£Ï†Î¬Î»Î¼Î± Google: ${errorData.error?.message || response.status}`);
                }

                // Pick a working model dynamically (Google changes names/availability often)
                const selectedModel = await getBestGeminiModel(key);
                geminiKey = key;
                geminiModel = selectedModel; // e.g. "models/gemini-2.5-flash"
                localStorage.setItem('vitro_gemini_key', key);
                localStorage.setItem('vitro_gemini_model', selectedModel);
                showToast('Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ ÎµÎ¯Î½Î±Î¹ Î­Î³ÎºÏ…ÏÎ¿ ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!');
                
                // Update UI
                const dateEl = document.getElementById('next-ai-date');
                if(dateEl && lastAiDate === 0) dateEl.innerText = "Î†Î¼ÎµÏƒÎ±";
                
                checkWeeklyAI(); 

            } catch (error) {
                console.error(error);
                let msg = error.message;
                if (msg === 'Failed to fetch') {
                    msg = 'Î ÏÏŒÎ²Î»Î·Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚. Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿ Î¯Î½Ï„ÎµÏÎ½ÎµÏ„ Î® AdBlock.';
                }
                showToast(msg);
            } finally {
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }

        async function fetchAIBlogPost() {
            if(!geminiModel){
                try { geminiModel = await getBestGeminiModel(geminiKey); localStorage.setItem('vitro_gemini_model', geminiModel); }
                catch(e){ console.warn(e); }
            }

            if(!geminiKey) return;
            toggleAiLoader(true);

            const prompt = `Î“ÏÎ¬ÏˆÎµ Î­Î½Î± Î½Î­Î¿, ÏƒÏÎ½Ï„Î¿Î¼Î¿, ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½ Î¬ÏÎ¸ÏÎ¿ Î³Î¹Î± blog ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒ Î¼Îµ Ï„Î·Î½ Ï„Î­Ï‡Î½Î· Ï„Î¿Ï… Î²Î¹Ï„ÏÏŒ (Stained Glass), Î¹ÏƒÏ„Î¿ÏÎ¯Î±, Î® Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚. Î ÎµÏÎ¯Ï€Î¿Ï… 150 Î»Î­Î¾ÎµÎ¹Ï‚.
            Î•Ï€Î¯ÏƒÏ„ÏÎµÏˆÎµ ÎœÎŸÎÎŸ JSON Î¼Î¿ÏÏ†Î® Ï‡Ï‰ÏÎ¯Ï‚ markdown (backticks):
            {
             "title": "Î¤Î¯Ï„Î»Î¿Ï‚ Î¬ÏÎ¸ÏÎ¿Ï…",
             "content": "Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ ÏƒÎµ HTML Ï€Î±ÏÎ±Î³ÏÎ¬Ï†Î¿Ï…Ï‚...",
             "image_keyword": "Î¼Î¹Î± Î±Î³Î³Î»Î¹ÎºÎ® Î»Î­Î¾Î· ÎºÎ»ÎµÎ¹Î´Î¯ Î³Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î± Ï€Ï‡ stained glass flower"
            }`;

            try {
                // Use gemini-1.5-flash-latest as standard
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/${(geminiModel || 'models/gemini-2.0-flash')}:generateContent?key=${geminiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                
                if (!response.ok) {
                   const errorData = await response.json();
                   console.warn("AI Generation Warning:", errorData); 
                   throw new Error('API Request Failed: ' + (errorData.error?.message || response.status));
                }

                const data = await response.json();
                const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                
                if (rawText) {
                    const cleanText = rawText.replace(/```json/g, '').replace(/```/g, '').trim();
                    const jsonPost = JSON.parse(cleanText);
                    
                    const newPost = {
                        id: Date.now(),
                        title: jsonPost.title || "ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿ AI",
                        date: new Date().toLocaleDateString('el-GR', { day: 'numeric', month: 'short', year: 'numeric' }),
                        image: `https://image.pollinations.ai/prompt/${jsonPost.image_keyword || 'stained glass'}%20art%20high%20quality`, 
                        content: jsonPost.content || "<p>Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î¼Î· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿.</p>"
                    };

                    blogPosts.unshift(newPost);
                    saveBlogPosts();
                    renderBlogList();
                    
                    lastAiDate = Date.now();
                    localStorage.setItem('vitro_last_ai_date', lastAiDate);
                    updateStats(); 
                    
                    showToast('ÎÎ­Î¿ Î¬ÏÎ¸ÏÎ¿ AI Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!');
                }
            } catch (error) {
                console.warn("AI Error:", error); 
                showToast('Î£Ï†Î¬Î»Î¼Î±: ' + error.message);
            } finally {
                toggleAiLoader(false);
            }
        }

        function checkWeeklyAI() {
            if(!geminiKey) return;
            const now = Date.now();
            const oneWeek = 7 * 24 * 60 * 60 * 1000;
            
            if (now - lastAiDate > oneWeek) {
                console.log("Triggering Weekly AI Blog Post...");
                fetchAIBlogPost();
            }
        }

        function forceAiBlogGeneration() {
            if(!geminiKey) { showToast('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€ÏÏÏ„Î± API Key.'); return; }
            if(confirm('Î˜Î­Î»ÎµÏ„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î¬ÏÎ¸ÏÎ¿ Ï„ÏÏÎ±;')) {
                fetchAIBlogPost();
            }
        }

        // --- LIVE PREVIEW & SETTINGS ---
        function updateLivePreview() {
            const root = document.documentElement;
            const getVal = (id) => { const el = document.getElementById(id); return el ? el.value : null; };

            const primary = getVal('admin-color-primary');
            const opacity = getVal('admin-glass-opacity');
            const glowStart = getVal('admin-glow-start');
            const glowEnd = getVal('admin-glow-end');
            const spinSpeed = getVal('admin-spin-speed');

            if (primary) root.style.setProperty('--color-primary', primary);
            if (opacity) root.style.setProperty('--glass-opacity', opacity);
            if (glowStart) root.style.setProperty('--glow-start', glowStart);
            if (glowEnd) root.style.setProperty('--glow-end', glowEnd);
            if (spinSpeed) root.style.setProperty('--spin-speed', spinSpeed + 's');
        }

        function applyGlobalSettings() {
            if (globalTexts.heroTitle) { const elTitle = document.getElementById('editable-hero-title'); if (elTitle) elTitle.innerHTML = globalTexts.heroTitle; }
            if (globalTexts.phone) { const phoneEls = document.querySelectorAll('.fa-phone-alt + div p, #editable-phone'); phoneEls.forEach(el => el.textContent = globalTexts.phone); }
            if (globalTexts.instagram) document.querySelectorAll('.link-instagram').forEach(el => el.href = globalTexts.instagram);
            if (globalTexts.facebook) document.querySelectorAll('.link-facebook').forEach(el => el.href = globalTexts.facebook);
            if (globalTexts.pinterest) document.querySelectorAll('.link-pinterest').forEach(el => el.href = globalTexts.pinterest);

            const root = document.documentElement;
            root.style.setProperty('--color-primary', globalGraphics.primary || '#fbc02d');
            root.style.setProperty('--glass-opacity', globalGraphics.opacity || '0.6');
            root.style.setProperty('--glow-start', globalGraphics.glowStart || '#fbc02d');
            root.style.setProperty('--glow-end', globalGraphics.glowEnd || '#b71c1c');
            root.style.setProperty('--spin-speed', (globalGraphics.spinSpeed || '60') + 's');
            
            const setVal = (id, val) => { const el = document.getElementById(id); if (el) el.value = val; };
            setVal('admin-hero-title', globalTexts.heroTitle ? globalTexts.heroTitle.replace(/<[^>]*>?/gm, '') : "Î— Î¤Î­Ï‡Î½Î· Ï„Î¿Ï… Î¦Ï‰Ï„ÏŒÏ‚");
            setVal('admin-phone', globalTexts.phone || "+30 6973 807 097");
            setVal('admin-insta', globalTexts.instagram || "#");
            setVal('admin-fb', globalTexts.facebook || "#");
            setVal('admin-pin', globalTexts.pinterest || "#");
            setVal('admin-color-primary', globalGraphics.primary || '#fbc02d');
            setVal('admin-glass-opacity', globalGraphics.opacity || '0.6');
            setVal('admin-glow-start', globalGraphics.glowStart || '#fbc02d');
            setVal('admin-glow-end', globalGraphics.glowEnd || '#b71c1c');
            setVal('admin-spin-speed', globalGraphics.spinSpeed || '60');
            
            // AI Key
            if(document.getElementById('gemini-api-key')) document.getElementById('gemini-api-key').value = geminiKey;
        }

        function saveGlobalSettings() {
            const getVal = (id) => { const el = document.getElementById(id); return el ? el.value : ""; };
            globalTexts.heroTitle = getVal('admin-hero-title');
            globalTexts.phone = getVal('admin-phone');
            globalTexts.instagram = getVal('admin-insta');
            globalTexts.facebook = getVal('admin-fb');
            globalTexts.pinterest = getVal('admin-pin');
            globalGraphics.primary = getVal('admin-color-primary');
            globalGraphics.opacity = getVal('admin-glass-opacity');
            globalGraphics.glowStart = getVal('admin-glow-start');
            globalGraphics.glowEnd = getVal('admin-glow-end');
            globalGraphics.spinSpeed = getVal('admin-spin-speed');
            localStorage.setItem('vitro_texts', JSON.stringify(globalTexts));
            localStorage.setItem('vitro_graphics', JSON.stringify(globalGraphics));
            showToast('ÎŸÎ¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½!');
        }

        // --- AUTH FUNCTIONS ---
        function openAdminLogin() { 
            document.getElementById('admin-login-modal').classList.remove('hidden'); 
            if (isAdmin) {
                document.getElementById('admin-login-form').classList.add('hidden');
                document.getElementById('admin-logout-view').classList.remove('hidden');
            } else {
                document.getElementById('admin-login-form').classList.remove('hidden');
                document.getElementById('admin-logout-view').classList.add('hidden');
                setTimeout(() => document.getElementById('admin-password').focus(), 100);
            }
        }
        function closeAdminLogin() { document.getElementById('admin-login-modal').classList.add('hidden'); }

        function attemptAdminLogin() {
            const pass = document.getElementById('admin-password').value;
            if (pass === '1111') {
                isAdmin = true;
                localStorage.setItem('vitro_isAdmin', 'true'); 
                document.getElementById('nav-admin-link').classList.remove('hidden');
                document.getElementById('nav-logout-link').classList.remove('hidden');
                document.getElementById('mobile-nav-admin-link').classList.remove('hidden');
                document.getElementById('mobile-nav-logout-link').classList.remove('hidden');
                document.body.classList.add('admin-mode');
                enableImageDropZones();
                checkMaintenance(); // Refresh maintenance view
                showToast('ÎšÎ±Î»Ï‰ÏƒÎ®ÏÎ¸Î±Ï„Îµ! Î¤Î¿ Drag & Drop ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ.');
                closeAdminLogin();
                document.getElementById('admin-password').value = ''; 
                showAdminDashboard(null);
            } else {
                showToast('Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!');
                document.getElementById('admin-password').value = '';
            }
        }

        if (isAdmin) {
            document.getElementById('nav-admin-link').classList.remove('hidden');
            document.getElementById('nav-logout-link').classList.remove('hidden');
            document.getElementById('mobile-nav-admin-link').classList.remove('hidden');
            document.getElementById('mobile-nav-logout-link').classList.remove('hidden');
            document.body.classList.add('admin-mode');
            enableImageDropZones();
        }

        function adminLogout(e) {
            if(e) e.preventDefault();
            isAdmin = false;
            localStorage.removeItem('vitro_isAdmin'); 
            localStorage.removeItem('vitro_active_view');
            document.getElementById('nav-admin-link').classList.add('hidden');
            document.getElementById('nav-logout-link').classList.add('hidden');
            document.getElementById('mobile-nav-admin-link').classList.add('hidden');
            document.getElementById('mobile-nav-logout-link').classList.add('hidden');
            document.body.classList.remove('admin-mode');
            showToast('Î‘Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸Î®ÎºÎ±Ï„Îµ.');
            closeAdminLogin();
            
            // Check maintenance again - if active, user will see under construction
            checkMaintenance();
            if(!isMaintenance) showLanding(true);
        }

        // --- PLACEHOLDER LINKS ---
        // Add listeners to empty links
        function initEmptyLinks() {
            document.querySelectorAll('a[href="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    showToast('Coming Soon / Î¥Ï€ÏŒ ÎšÎ±Ï„Î±ÏƒÎºÎµÏ…Î®');
                });
            });
        }

        // --- IMAGE EDITING & STOCK TOGGLE CLICK ---
        function handleImageClick(element, type, id) {
            if (!isAdmin) return;
            if (event) event.preventDefault();
            if (event) event.stopPropagation();

            if (type === 'product') {
                const prod = products.find(p => p.id === id);
                if (prod) {
                    if (prod.stock === 'in-stock') prod.stock = 'made-to-order';
                    else if (prod.stock === 'made-to-order') prod.stock = 'sold';
                    else prod.stock = 'in-stock';
                    saveProducts();
                    renderProducts(); 
                    let label = "";
                    if (prod.stock === 'in-stock') label = "Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿";
                    else if (prod.stock === 'made-to-order') label = "ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚";
                    else label = "Î•Î¾Î±Î½Ï„Î»Î·Î¼Î­Î½Î¿";
                    showToast(`ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·: ${label}`);
                }
                return;
            }

            const currentUrl = type === 'static' ? (id.endsWith('-bg') ? element.style.backgroundImage.slice(5, -2) : element.src) : element.src;
            const newUrl = prompt("Î•Ï€Î¹ÎºÎ¿Î»Î»Î®ÏƒÏ„Îµ URL Î® Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Drag & Drop:", currentUrl);

            if (newUrl && newUrl !== currentUrl) {
                if (type === 'static') {
                    if (id.endsWith('-bg')) element.style.backgroundImage = `url('${newUrl}')`;
                    else element.src = newUrl;
                    staticImages[id] = newUrl;
                    localStorage.setItem('vitro_static_images', JSON.stringify(staticImages));
                    showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!');
                } else if (type === 'blog') {
                    const post = blogPosts.find(p => p.id === id);
                    if (post) { post.image = newUrl; saveBlogPosts(); renderBlogList(); showToast('Î— ÎµÎ¹ÎºÏŒÎ½Î± Î¬ÏÎ¸ÏÎ¿Ï… Î¬Î»Î»Î±Î¾Îµ!'); }
                }
            }
        }

        // --- DATA PERSISTENCE HELPERS ---
        function saveProducts() { localStorage.setItem('vitro_products', JSON.stringify(products)); updateAdminTables(); }
        function saveBlogPosts() { localStorage.setItem('vitro_blog', JSON.stringify(blogPosts)); updateAdminTables(); }

        // --- MODAL LOGIC ---
        function openModal() { document.getElementById('contact-modal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('contact-modal').classList.add('hidden'); }
        // NEW: Open Add Modal logic handles both ADD and EDIT now
        function openAddProductModal(editMode = false, productId = null) {
            const modal = document.getElementById('add-product-modal');
            const title = document.getElementById('modal-product-title');
            const idField = document.getElementById('prod-id');
            
            // Reset form
            document.getElementById('prod-name').value = '';
            document.getElementById('prod-price').value = '';
            document.getElementById('prod-discount').value = ''; // Reset discount
            document.getElementById('prod-image').value = '';
            document.getElementById('prod-desc').value = '';
            idField.value = '';

            if (editMode && productId) {
                const prod = products.find(p => p.id === productId);
                if (prod) {
                    title.innerText = "Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚";
                    idField.value = prod.id;
                    document.getElementById('prod-name').value = prod.name;
                    document.getElementById('prod-price').value = prod.price;
                    document.getElementById('prod-discount').value = prod.discount || 0;
                    document.getElementById('prod-category').value = prod.category;
                    document.getElementById('prod-stock').value = prod.stock;
                    document.getElementById('prod-image').value = prod.image;
                    document.getElementById('prod-desc').value = prod.desc;
                }
            } else {
                title.innerText = "ÎÎ­Î¿ Î ÏÎ¿ÏŠÏŒÎ½";
            }
            modal.classList.remove('hidden'); 
        }
        function closeAddProductModal() { document.getElementById('add-product-modal').classList.add('hidden'); }
        function openAddBlogModal() { document.getElementById('add-blog-modal').classList.remove('hidden'); }
        function closeAddBlogModal() { document.getElementById('add-blog-modal').classList.add('hidden'); }

        // --- NAVIGATION & TRACKING ---
        function trackView(page) {
            if (analytics.pageViews[page] !== undefined) analytics.pageViews[page]++;
            else analytics.pageViews[page] = 1;
            localStorage.setItem('vitro_analytics', JSON.stringify(analytics));
        }

        function hideAllViews() {
            const ids = [
                'view-landing',
                'view-catalog',
                'view-blog',
                'view-blog-single',
                'view-admin-dashboard',
                'view-maintenance',
            ];
            ids.forEach((id) => {
                const el = document.getElementById(id);
                if (el) el.classList.add('hidden');
            });
        }
        function saveViewState(viewId) { localStorage.setItem('vitro_active_view', viewId); }

        function navigateToSection(e, sectionId) {
            if(e) e.preventDefault();
            if(isMaintenance && !isAdmin) return; // Block nav in maintenance
            hideAllViews();
            document.getElementById('view-landing').classList.remove('hidden');
            saveViewState('view-landing');
            trackView('home');
            if (sectionId) {
                const element = document.getElementById(sectionId);
                if(element) element.scrollIntoView({ behavior: 'smooth' });
                else window.scrollTo({ top: 0, behavior: 'smooth' });
            } else window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Check promo text on view change
            updatePromoText();
        }

        function showLanding(scrollToTop = true) {
            if(isMaintenance && !isAdmin) return;
            hideAllViews();
            document.getElementById('view-landing').classList.remove('hidden');
            saveViewState('view-landing');
            trackView('home');
            if(scrollToTop) window.scrollTo({ top: 0, behavior: 'smooth' });
            updatePromoText();
        }

        function showCatalog(e) {
            if(e) e.preventDefault();
            if(isMaintenance && !isAdmin) return;
            hideAllViews();
            document.getElementById('view-catalog').classList.remove('hidden');
            saveViewState('view-catalog');
            trackView('catalog');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            renderProducts(); 
        }

        function showBlog(e) {
            if(e) e.preventDefault();
            if(isMaintenance && !isAdmin) return;
            hideAllViews();
            document.getElementById('view-blog').classList.remove('hidden');
            saveViewState('view-blog');
            trackView('blog');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            renderBlogList();
        }

        function showAdminDashboard(e) {
            if (e) e.preventDefault();
            // Admin lives at the server-protected /admin route
            window.location.href = '/admin/';
        }

        // --- ADMIN DASHBOARD ---
        function switchAdminTab(tab) {
            const panels = ['products', 'blog', 'general', 'stats', 'system'];
            panels.forEach(p => {
                document.getElementById('admin-panel-' + p).classList.add('hidden');
                const btn = document.getElementById('tab-btn-' + p);
                btn.classList.replace('bg-amber', 'bg-gray-800');
                btn.classList.replace('text-lead', 'text-gray-400');
            });

            document.getElementById('admin-panel-' + tab).classList.remove('hidden');
            const activeBtn = document.getElementById('tab-btn-' + tab);
            activeBtn.classList.replace('bg-gray-800', 'bg-amber');
            activeBtn.classList.replace('text-gray-400', 'text-lead');
            
            if(tab === 'stats') updateStats();
            if(tab === 'system') {
                const dateEl = document.getElementById('next-ai-date');
                if(lastAiDate === 0) dateEl.innerText = "Î†Î¼ÎµÏƒÎ± (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ»ÎµÎ¹Î´Î¯)";
                else {
                    const next = new Date(lastAiDate + (7 * 24 * 60 * 60 * 1000));
                    dateEl.innerText = next.toLocaleDateString('el-GR');
                }
            }
        }

        function updateStats() {
            // Random Online Users (Simulation)
            const online = Math.floor(Math.random() * 10) + 2; 
            document.getElementById('stat-online-users').innerText = online;
            document.getElementById('stat-total-visits').innerText = analytics.totalVisits;
            
            // Bars
            const container = document.getElementById('stats-bars');
            container.innerHTML = '';
            const maxViews = Math.max(...Object.values(analytics.pageViews), 1);
            
            const labels = { 'home': 'Î‘ÏÏ‡Î¹ÎºÎ®', 'catalog': 'Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±', 'blog': 'Blog', 'workshops': 'Workshops' };
            
            for (const [key, value] of Object.entries(analytics.pageViews)) {
                if (!labels[key]) continue;
                const percent = (value / maxViews) * 100;
                container.innerHTML += `
                    <div>
                        <div class="flex justify-between text-xs text-gray-400 mb-1">
                            <span>${labels[key]}</span>
                            <span>${value} views</span>
                        </div>
                        <div class="w-full bg-black/50 rounded-full h-2">
                            <div class="stat-bar bg-emerald h-2 rounded-full" style="width: ${percent}%"></div>
                        </div>
                    </div>
                `;
            }
        }

        function updateAdminTables() {
            document.getElementById('stats-products').innerText = products.length;
            document.getElementById('stats-blog').innerText = blogPosts.length;

            const prodTable = document.getElementById('admin-products-table');
            prodTable.innerHTML = '';
            products.forEach(p => {
                prodTable.innerHTML += `
                    <tr class="border-b border-white/5 hover:bg-white/5 transition">
                        <td class="p-3"><img src="${p.image}" class="w-10 h-10 object-cover rounded"></td>
                        <td class="p-3 font-bold text-white">${p.name}</td>
                        <td class="p-3">â‚¬${p.price}</td>
                        <td class="p-3 text-red-400 font-bold">${p.discount > 0 ? '-' + p.discount + '%' : '-'}</td>
                        <td class="p-3 flex gap-2">
                            <button onclick="openAddProductModal(true, ${p.id})" class="text-amber hover:text-yellow-300" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±"><i class="fas fa-edit"></i></button>
                            <button onclick="deleteProduct(${p.id})" class="text-ruby hover:text-red-400" title="Î”Î¹Î±Î³ÏÎ±Ï†Î®"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });

            const blogTable = document.getElementById('admin-blog-table');
            blogTable.innerHTML = '';
            blogPosts.forEach(p => {
                blogTable.innerHTML += `
                    <tr class="border-b border-white/5 hover:bg-white/5 transition">
                        <td class="p-3"><img src="${p.image}" class="w-10 h-10 object-cover rounded"></td>
                        <td class="p-3 font-bold text-white">${p.title}</td>
                        <td class="p-3">${p.date}</td>
                        <td class="p-3"><button onclick="deleteBlogPost(${p.id})" class="text-ruby hover:text-red-400"><i class="fas fa-trash"></i></button></td>
                    </tr>
                `;
            });
        }

        function deleteProduct(id) { if(confirm('Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Ï‚;')) { products = products.filter(p => p.id !== id); saveProducts(); showToast('Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ.'); } }
        function deleteBlogPost(id) { if(confirm('Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Ï‚;')) { blogPosts = blogPosts.filter(p => p.id !== id); saveBlogPosts(); showToast('Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ.'); } }

        // --- DATA INIT ---
        let storedProducts = localStorage.getItem('vitro_products');
        let products = storedProducts ? JSON.parse(storedProducts) : [
            {
                id: 1,
                name: "ÎšÏÎµÎ¼Î±ÏƒÏ„ÏŒ Î¦Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÏŒ Tiffany",
                price: "240.00",
                discount: 0, // Default discount
                category: "stained-glass",
                stock: "made-to-order",
                image: "https://images.unsplash.com/photo-1579965342575-16428a7c8d71?auto=format&fit=crop&w=600&q=80",
                desc: "Î§ÎµÎ¹ÏÎ¿Ï€Î¿Î¯Î·Ï„Î¿ Ï†Ï‰Ï„Î¹ÏƒÏ„Î¹ÎºÏŒ Î¿ÏÎ¿Ï†Î®Ï‚ Î¼Îµ Î¼Î¿Ï„Î¯Î²Î¿ Î»Î¿Ï…Î»Î¿Ï…Î´Î¹ÏÎ½."
            },
            {
                id: 2,
                name: "ÎšÎ±ÏÎ´Î¹Î¬ Suncatcher",
                price: "45.00",
                discount: 0,
                category: "decor",
                stock: "in-stock",
                image: "https://images.unsplash.com/photo-1611082352219-4820875e533c?auto=format&fit=crop&w=600&q=80",
                desc: "Î”Î¹Î±ÎºÎ¿ÏƒÎ¼Î·Ï„Î¹ÎºÏŒ Î³Î¹Î± Ï„Î¿ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ ÏƒÎµ ÏƒÏ‡Î®Î¼Î± ÎºÎ±ÏÎ´Î¹Î¬Ï‚."
            },
            {
                id: 3,
                name: "ÎœÎµÎ½Ï„Î±Î³Î¹ÏŒÎ½ ÎœÏ€Î»Îµ Î“Ï…Î±Î»Î¯",
                price: "35.00",
                discount: 0,
                category: "jewelry",
                stock: "in-stock",
                image: "https://images.unsplash.com/photo-1602173574767-37ac01994b2a?auto=format&fit=crop&w=600&q=80",
                desc: "ÎœÎ¿Î½Î±Î´Î¹ÎºÏŒ Î¼ÎµÎ½Ï„Î±Î³Î¹ÏŒÎ½ Î±Ï€ÏŒ Î±Î½Î±ÎºÏ…ÎºÎ»Ï‰Î¼Î­Î½Î¿ Î³Ï…Î±Î»Î¯ Î²Î¹Ï„ÏÏŒ."
            },
            {
                id: 4,
                name: "Î¥Ï€Î·ÏÎµÏƒÎ¯Î± Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ·Ï‚",
                price: "ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î•ÎºÏ„Î¯Î¼Î·ÏƒÎ·Ï‚",
                discount: 0,
                category: "stained-glass",
                stock: "made-to-order",
                image: "https://images.unsplash.com/photo-1520699918507-3c3e05c46b90?auto=format&fit=crop&w=600&q=80",
                desc: "Î•Ï€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÎ® Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï€Î±Î»Î±Î¹ÏÎ½ Î²Î¹Ï„ÏÏŒ."
            }
        ];

        function renderProducts() {
            const grid = document.getElementById('catalog-grid');
            if(!grid) return;
            grid.innerHTML = ''; 
            products.forEach(prod => {
                let stockColor = prod.stock === 'in-stock' ? 'text-emerald' : (prod.stock === 'sold' ? 'text-ruby' : 'text-amber');
                let stockText = prod.stock === 'in-stock' ? 'Î†Î¼ÎµÏƒÎ± Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿' : (prod.stock === 'sold' ? 'Î•Î¾Î±Î½Ï„Î»Î®Î¸Î·ÎºÎµ' : 'ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±Ï‚');
                
                // PRICE CALCULATION LOGIC
                let priceDisplay = `<span class="text-amber font-serif font-bold text-xl">â‚¬${prod.price}</span>`;
                let discountBadge = '';
                
                // Convert string prices to float safely if needed (though inputs are number)
                let numericPrice = parseFloat(prod.price);
                
                if (prod.discount && prod.discount > 0 && !isNaN(numericPrice)) {
                    let discountedPrice = (numericPrice * (1 - (prod.discount / 100))).toFixed(2);
                    priceDisplay = `
                        <div class="flex flex-col items-end">
                             <span class="text-xs text-gray-500 line-through decoration-red-500/50">â‚¬${prod.price}</span>
                             <span class="text-ruby font-serif font-bold text-xl">â‚¬${discountedPrice}</span>
                        </div>
                    `;
                    discountBadge = `<div class="absolute top-2 left-2 bg-ruby text-white px-2 py-1 rounded text-xs font-bold shadow-lg z-10 animate-pulse">-${prod.discount}%</div>`;
                }

                // If price is text (e.g. "ÎšÎ±Ï„ÏŒÏ€Î¹Î½ Î•ÎºÏ„Î¯Î¼Î·ÏƒÎ·Ï‚"), display as is
                if (isNaN(numericPrice)) {
                    priceDisplay = `<span class="text-amber font-serif font-bold text-sm">${prod.price}</span>`;
                    discountBadge = '';
                }

                // ADDED EDIT BUTTON FOR ADMIN
                let adminEditBtn = '';
                if(isAdmin) {
                    adminEditBtn = `<button onclick="event.stopPropagation(); openAddProductModal(true, ${prod.id})" class="text-emerald hover:text-white mr-3 p-2 rounded-full hover:bg-white/10 transition" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î¤Î¹Î¼Î®Ï‚/ÎˆÎºÏ€Ï„Ï‰ÏƒÎ·Ï‚"><i class="fas fa-pencil-alt"></i></button>`;
                }

                grid.innerHTML += `
                    <div class="glass-card rounded-xl overflow-hidden group flex flex-col h-full relative">
                        ${discountBadge}
                        <div class="h-64 overflow-hidden relative">
                            <img src="${prod.image}" alt="${prod.name}" onclick="handleImageClick(this, 'product', ${prod.id})" class="admin-editable-img w-full h-full object-cover group-hover:scale-110 transition duration-500" data-type="product" data-id="${prod.id}">
                            <div class="absolute top-2 right-2 bg-black/70 px-2 py-1 rounded text-xs font-bold ${stockColor} pointer-events-none">${stockText}</div>
                        </div>
                        <div class="p-5 flex-grow flex flex-col">
                            <h3 class="text-lg font-bold text-white mb-1">${prod.name}</h3>
                            <p class="text-gray-400 text-xs mb-3 flex-grow">${prod.desc}</p>
                            <div class="mt-auto flex items-center justify-between border-t border-white/10 pt-3">
                                ${priceDisplay}
                                <div class="flex items-center">
                                    ${adminEditBtn}
                                    <button onclick="openModal()" class="text-white hover:text-amber transition"><i class="fas fa-shopping-bag"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>`;
            });
            enableImageDropZones(); 
        }

        // PROMO TEXT LOGIC
        function updatePromoText() {
            const promo = document.getElementById('hero-promo-text');
            if(!promo) return;
            
            // Check if any product has discount > 0
            const hasDiscounts = products.some(p => p.discount > 0);
            
            if (hasDiscounts) {
                promo.classList.remove('hidden');
            } else {
                promo.classList.add('hidden');
            }
        }

        // GLOBAL DISCOUNT LOGIC
        function applyGlobalDiscount() {
            const inputVal = document.getElementById('global-discount').value;
            if (!inputVal) { showToast("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€Î¿ÏƒÎ¿ÏƒÏ„ÏŒ."); return; }
            
            const percent = parseInt(inputVal);
            if (isNaN(percent) || percent < 0 || percent > 100) {
                showToast("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Ï€Î¿ÏƒÎ¿ÏƒÏ„ÏŒ (0-100).");
                return;
            }
            
            if(confirm(`Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Î¹ ÏŒÏ„Î¹ Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÏ„Îµ Î­ÎºÏ€Ï„Ï‰ÏƒÎ· ${percent}% ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î±;`)) {
                products.forEach(p => {
                    // Only apply to numeric prices
                    if (!isNaN(parseFloat(p.price))) {
                        p.discount = percent;
                    }
                });
                saveProducts();
                renderProducts(); // Update catalog view (if visible or cached)
                updateAdminTables(); // IMPORTANT: Update admin table immediately
                updatePromoText(); // Update hero text
                showToast(`Î— Î­ÎºÏ€Ï„Ï‰ÏƒÎ· ${percent}% ÎµÏ†Î±ÏÎ¼ÏŒÏƒÏ„Î·ÎºÎµ ÏƒÎµ ÏŒÎ»Î±!`);
            }
        }

        let storedBlog = localStorage.getItem('vitro_blog');
        let blogPosts = storedBlog ? JSON.parse(storedBlog) : [
            {
                id: 1,
                date: "20 Î™Î±Î½ 2026",
                image: "https://images.unsplash.com/photo-1579965342575-16428a7c8d71?auto=format&fit=crop&w=800&q=80",
                title: "Î— Î•Ï€Î±Î½Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ Î¤ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Tiffany",
                content: `...`
            },
            // ... (rest of default blog posts) ...
        ];
        // Ensure default blog content is populated
         if (!storedBlog) {
            blogPosts = [
                {
                    id: 1,
                    date: "20 Î™Î±Î½ 2026",
                    image: "https://images.unsplash.com/photo-1579965342575-16428a7c8d71?auto=format&fit=crop&w=800&q=80",
                    title: "Î— Î•Ï€Î±Î½Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ Î¤ÎµÏ‡Î½Î¹ÎºÎ®Ï‚ Tiffany",
                    content: `<p class="mb-4">ÎŸ Louis Comfort Tiffany, Î³Î¹Î¿Ï‚ Ï„Î¿Ï… Î´Î¹Î¬ÏƒÎ·Î¼Î¿Ï… ÎºÎ¿ÏƒÎ¼Î·Î¼Î±Ï„Î¿Ï€ÏÎ»Î· Charles Lewis Tiffany, Î¬Î»Î»Î±Î¾Îµ Î³Î¹Î± Ï€Î¬Î½Ï„Î± Ï„Î·Î½ Î¹ÏƒÏ„Î¿ÏÎ¯Î± Ï„Î¿Ï… Î²Î¹Ï„ÏÏŒ ÏƒÏ„Î± Ï„Î­Î»Î· Ï„Î¿Ï… 19Î¿Ï… Î±Î¹ÏÎ½Î±. ÎœÎ­Ï‡ÏÎ¹ Ï„ÏŒÏ„Îµ, Î· ÎºÏ…ÏÎ¯Î±ÏÏ‡Î· Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î®Ï„Î±Î½ Î±Ï…Ï„Î® Ï„Î¿Ï… Î¼Î¿Î»ÏÎ²Î´Î¿Ï… (lead came), Î· Î¿Ï€Î¿Î¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÏƒÎµ Ï‡Î¿Î½Ï„ÏÎ¬ Ï€ÏÎ¿Ï†Î¯Î» Î¼Î¿Î»ÏÎ²Î´Î¿Ï… Î³Î¹Î± Î½Î± ÏƒÏ…Î³ÎºÏÎ±Ï„ÎµÎ¯ Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Ï„Î¿Ï… Î³Ï…Î±Î»Î¹Î¿Ï. Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚, Î±Î½ ÎºÎ±Î¹ ÏƒÏ„Î¹Î²Î±ÏÎ® ÎºÎ±Î¹ Î¹Î´Î±Î½Î¹ÎºÎ® Î³Î¹Î± Î¼ÎµÎ³Î¬Î»Î± ÎµÎºÎºÎ»Î·ÏƒÎ¹Î±ÏƒÏ„Î¹ÎºÎ¬ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ±, Ï€ÎµÏÎ¹ÏŒÏÎ¹Î¶Îµ Ï„Î· Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹Î± ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î¿Î»Ï…Ï€Î»Î¿ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ ÏƒÏ‡ÎµÎ´Î¯Ï‰Î½.</p>
                    <p class="mb-4">ÎŸ Tiffany ÎµÎ¹ÏƒÎ®Î³Î±Î³Îµ Ï„Î·Î½ ÎµÏ€Î±Î½Î±ÏƒÏ„Î±Ï„Î¹ÎºÎ® Ï„ÎµÏ‡Î½Î¹ÎºÎ® Ï„Î¿Ï… Ï†ÏÎ»Î»Î¿Ï… Ï‡Î±Î»ÎºÎ¿Ï (copper foil). Î‘Î½Ï„Î¯ Î³Î¹Î± Î¼ÏŒÎ»Ï…Î²Î´Î¿, ÎºÎ¬Î¸Îµ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î³Ï…Î±Î»Î¹Î¿Ï Ï„Ï…Î»Î¯Î³ÎµÏ„Î±Î¹ Ï€ÎµÏÎ¹Î¼ÎµÏ„ÏÎ¹ÎºÎ¬ Î¼Îµ Î¼Î¹Î± Ï€Î¿Î»Ï Î»ÎµÏ€Ï„Î®, Î±Ï…Ï„Î¿ÎºÏŒÎ»Î»Î·Ï„Î· Ï„Î±Î¹Î½Î¯Î± Ï‡Î±Î»ÎºÎ¿Ï. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Ï„Î± ÎºÎ¿Î¼Î¼Î¬Ï„Î¹Î± Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ Î¼Î±Î¶Î¯ ÎºÎ±Î¹ ÏƒÏ…Î³ÎºÎ¿Î»Î»ÏÎ½Ï„Î±Î¹ Î¼Îµ ÎºÎ±ÏƒÏƒÎ¯Ï„ÎµÏÎ¿. Î‘Ï…Ï„ÏŒ ÎµÏ€Î­Ï„ÏÎµÏˆÎµ Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Î»ÎµÏ€Ï„ÎµÏ€Î¯Î»ÎµÏ€Ï„Ï‰Î½ ÏƒÏ‡ÎµÎ´Î¯Ï‰Î½, Î¼Îµ Ï€Î¿Î»Ï Ï€Î¹Î¿ ÏƒÏ„ÎµÎ½Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Î½Ï‰ÏƒÎ·Ï‚, Î´Î¯Î½Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î¿ Î­ÏÎ³Î¿ Î¼Î¹Î± Ï€Î¹Î¿ Î±Î½Î¬Î»Î±Ï†ÏÎ· ÎºÎ±Î¹ Î¿ÏÎ³Î±Î½Î¹ÎºÎ® Î±Î¯ÏƒÎ¸Î·ÏƒÎ·.</p>`
                },
                {
                    id: 2,
                    date: "15 Î”ÎµÎº 2025",
                    image: "https://images.unsplash.com/photo-1621252179027-94459d27d3ee?auto=format&fit=crop&w=800&q=80",
                    title: "Î£Ï…Î½Ï„Î®ÏÎ·ÏƒÎ· Î’Î¹Ï„ÏÏŒ: Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÏƒÎ­Ï‡ÎµÏ„Îµ",
                    content: `<p class="mb-4">Î¤Î± Î²Î¹Ï„ÏÏŒ ÎµÎ¯Î½Î±Î¹ Î­ÏÎ³Î± Ï„Î­Ï‡Î½Î·Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Ï„Î­Î¾Î¿Ï…Î½ Î±Î¹ÏÎ½ÎµÏ‚, Î±ÏÎºÎµÎ¯ Î½Î± ÏƒÏ…Î½Ï„Î·ÏÎ¿ÏÎ½Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬. Î Î¿Î»Î»Î¿Î¯ Î½Î¿Î¼Î¯Î¶Î¿Ï…Î½ ÏŒÏ„Î¹ Ï„Î¿ Î³Ï…Î±Î»Î¯ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î¿ Î¼Î­ÏÎ¿Ï‚, Î±Î»Î»Î¬ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±, Î¿ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ ÎµÏ‡Î¸ÏÏŒÏ‚ ÎµÎ½ÏŒÏ‚ Î²Î¹Ï„ÏÏŒ ÎµÎ¯Î½Î±Î¹ Î¿ ÏƒÎºÎµÎ»ÎµÏ„ÏŒÏ‚ Ï„Î¿Ï… ÎºÎ±Î¹ Î¿ Ï‡ÏÏŒÎ½Î¿Ï‚. ÎŸ Î¼ÏŒÎ»Ï…Î²Î´Î¿Ï‚ (lead came) Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÏƒÏ„Î± Ï€Î±ÏÎ±Î´Î¿ÏƒÎ¹Î±ÎºÎ¬ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ±, ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¼Î±Î»Î±ÎºÏŒ Î¼Î­Ï„Î±Î»Î»Î¿. ÎœÎµ Ï„Î·Î½ Ï€Î¬ÏÎ¿Î´Î¿ Ï„Ï‰Î½ Î´ÎµÎºÎ±ÎµÏ„Î¹ÏÎ½, Î¿ Î¼ÏŒÎ»Ï…Î²Î´Î¿Ï‚ Î¿Î¾ÎµÎ¹Î´ÏÎ½ÎµÏ„Î±Î¹, Ï‡Î¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎ»Î±ÏƒÏ„Î¹ÎºÏŒÏ„Î·Ï„Î¬ Ï„Î¿Ï… ÎºÎ±Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎµÏÎ¸ÏÎ±Ï…ÏƒÏ„Î¿Ï‚. Î‘Ï…Ï„ÏŒ Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ "ÎºÏŒÏ€Ï‰ÏƒÎ· Î¼Ï„Î¬Î»Î»Î¿Ï…".</p>`
                },
                {
                    id: 3,
                    date: "10 ÎÎ¿Îµ 2025",
                    image: "https://images.unsplash.com/photo-1563293886-27154256621f?auto=format&fit=crop&w=800&q=80",
                    title: "Î¤Î¿ ÎœÏ…ÏƒÏ„Î®ÏÎ¹Î¿ Ï„Î¿Ï… ÎœÏ€Î»Îµ Ï„Î·Ï‚ Chartres",
                    content: `<p class="mb-4">ÎŸ ÎšÎ±Î¸ÎµÎ´ÏÎ¹ÎºÏŒÏ‚ ÎÎ±ÏŒÏ‚ Ï„Î·Ï‚ Chartres ÏƒÏ„Î· Î“Î±Î»Î»Î¯Î± Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ Î³Î¹Î± Ï„Î± Î²Î¹Ï„ÏÏŒ Ï„Î¿Ï… 12Î¿Ï… ÎºÎ±Î¹ 13Î¿Ï… Î±Î¹ÏÎ½Î±, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¸ÎµÏ‰ÏÎ¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± Ï‰ÏÎ±Î¹ÏŒÏ„ÎµÏÎ± ÎºÎ±Î¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ± Î´Î¹Î±Ï„Î·ÏÎ·Î¼Î­Î½Î± ÏƒÏ„Î¿Î½ ÎºÏŒÏƒÎ¼Î¿. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Î±Ï€Î±ÏƒÏ‡Î¿Î»Î®ÏƒÎµÎ¹ Ï„Î¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿ÏÏ‚ Ï„Î­Ï‡Î½Î·Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï…Ï‚ ÎµÏ€Î¹ÏƒÏ„Î®Î¼Î¿Î½ÎµÏ‚ Î³Î¹Î± Î±Î¹ÏÎ½ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€ÎµÏÎ¯Ï†Î·Î¼Î¿ "ÎœÏ€Î»Îµ Ï„Î·Ï‚ Chartres" (Bleu de Chartres). ÎˆÎ½Î± Î²Î±Î¸Ï, Ï†Ï‰Ï„ÎµÎ¹Î½ÏŒ, ÏƒÏ‡ÎµÎ´ÏŒÎ½ Ï…Ï€ÎµÏÏ†Ï…ÏƒÎ¹ÎºÏŒ Î¼Ï€Î»Îµ Ï‡ÏÏÎ¼Î± Ï€Î¿Ï… ÎºÏ…ÏÎ¹Î±ÏÏ‡ÎµÎ¯ ÏƒÏ„Î± Ï€Î±ÏÎ¬Î¸Ï…ÏÎ± ÎºÎ±Î¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î¼Î¹Î± Î¼Ï…ÏƒÏ„Î·ÏÎ¹Î±ÎºÎ® Î±Ï„Î¼ÏŒÏƒÏ†Î±Î¹ÏÎ± ÏƒÏ„Î¿ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒ Ï„Î¿Ï… Î½Î±Î¿Ï.</p>`
                },
                {
                    id: 4,
                    date: "05 ÎŸÎºÏ„ 2025",
                    image: "https://images.unsplash.com/photo-1518640467707-6811f4a6ab73?auto=format&fit=crop&w=800&q=80",
                    title: "Art Deco ÎºÎ±Î¹ Î’Î¹Ï„ÏÏŒ: Î“ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î± ÎºÎ±Î¹ Î£Ï„Ï…Î»",
                    content: `<p class="mb-4">Î— Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ Art Deco (1920-1940) Î­Ï†ÎµÏÎµ Î¼Î¹Î± Î´ÏÎ±Î¼Î±Ï„Î¹ÎºÎ® Î±Î»Î»Î±Î³Î® ÏƒÏ„Î·Î½ Î±Î¹ÏƒÎ¸Î·Ï„Î¹ÎºÎ® Ï„Î¿Ï… Î²Î¹Ï„ÏÏŒ. ÎÎµÏ†ÎµÏÎ³Î¿Î½Ï„Î±Ï‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ Ï†Ï…ÏƒÎ¹ÎºÎ­Ï‚, ÎºÎ±Î¼Ï€ÏÎ»ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎºÎ±Î¹ Ï„Î± Î»Î¿Ï…Î»Î¿Ï…Î´Î¬Ï„Î± Î¼Î¿Ï„Î¯Î²Î± Ï„Î·Ï‚ Art Nouveau, Ï„Î¿ Art Deco Î±Î³ÎºÎ¬Î»Î¹Î±ÏƒÎµ Ï„Î· Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î±, Ï„Î· ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¯Î± ÎºÎ±Î¹ Ï„Î¿Î½ Î¼Î¿Î½Ï„ÎµÏÎ½Î¹ÏƒÎ¼ÏŒ.</p>`
                }
            ];
        }

        function renderBlogList() {
            const container = document.getElementById('blog-list-container');
            container.innerHTML = '';
            blogPosts.forEach(post => {
                container.innerHTML += `<div class="glass-card p-8 rounded-2xl border-l-4 border-amber relative hover:bg-white/5 transition-all"><div class="flex flex-col md:flex-row gap-6"><div class="md:w-1/4 flex flex-col items-center md:items-start text-amber font-serif"><span class="text-gray-500 mt-1 text-sm font-sans">${post.date}</span><img src="${post.image}" alt="${post.title}" onclick="handleImageClick(this, 'blog', ${post.id})" class="admin-editable-img mt-4 rounded-lg w-full h-32 object-cover border border-white/10 shadow-lg" data-type="blog" data-id="${post.id}"></div><div class="md:w-3/4"><h3 class="text-2xl font-bold text-white mb-3 hover:text-amber transition cursor-pointer" onclick="openBlogPost(${post.id})">${post.title}</h3><div class="text-gray-300 leading-relaxed mb-4 line-clamp-6 text-sm md:text-base">${post.content}</div><button onclick="openBlogPost(${post.id})" class="text-amber text-sm font-bold hover:underline">Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± <i class="fas fa-arrow-right ml-1"></i></button></div></div></div>`;
            });
            enableImageDropZones(); // Re-enable drag zones after render
        }

        function openBlogPost(id) {
            const post = blogPosts.find(p => p.id === id);
            if (!post) return;
            const contentContainer = document.getElementById('blog-single-content');
            contentContainer.innerHTML = `<div class="border-b border-white/10 pb-6 mb-6"><span class="text-amber font-serif text-sm tracking-widest">${post.date}</span><h1 class="text-3xl md:text-5xl font-bold text-white mt-2 font-serif">${post.title}</h1></div><img src="${post.image}" alt="${post.title}" class="w-full h-64 md:h-96 object-cover rounded-xl mb-8 border border-white/10 shadow-2xl"><div class="text-gray-300 leading-loose text-lg space-y-6">${post.content}</div>`;
            document.getElementById('view-blog').classList.add('hidden');
            document.getElementById('view-blog-single').classList.remove('hidden');
            saveViewState('view-blog-single');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Updated Handle Add/Edit Product
        function handleAddProduct() {
            const idField = document.getElementById('prod-id').value;
            const name = document.getElementById('prod-name').value;
            const price = document.getElementById('prod-price').value;
            const category = document.getElementById('prod-category').value;
            const stock = document.getElementById('prod-stock').value;
            const image = document.getElementById('prod-image').value;
            const desc = document.getElementById('prod-desc').value;
            const discount = document.getElementById('prod-discount').value || 0; // Get discount

            if (idField) {
                // EDIT EXISTING
                const index = products.findIndex(p => p.id == idField);
                if (index !== -1) {
                    products[index] = {
                        ...products[index], // keep existing props
                        name, price, category, stock, image, desc, discount
                    };
                    showToast('Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!');
                }
            } else {
                // ADD NEW
                const newProd = {
                    id: Date.now(),
                    name, price, category, stock, image, desc, discount
                };
                products.unshift(newProd);
                showToast('Î¤Î¿ Ï€ÏÎ¿ÏŠÏŒÎ½ Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!');
            }

            saveProducts();
            renderProducts();
            updatePromoText(); // Check if text needs to show/hide
            closeAddProductModal();
            
            // Check where to return: dashboard or catalog
            const activeView = localStorage.getItem('vitro_active_view');
            if (activeView === 'view-admin-dashboard') {
                showAdminDashboard(null);
            } else {
                // Stay on catalog
            }
        }

        function handleAddBlogPost() { /* ... existing add logic ... */ const title=document.getElementById('blog-title').value; const date=document.getElementById('blog-date').value; const image=document.getElementById('blog-image').value; const content=document.getElementById('blog-content').value; const newPost={id:Date.now(), title, date, image, content}; blogPosts.unshift(newPost); saveBlogPosts(); renderBlogList(); closeAddBlogModal(); showAdminDashboard(null); showToast('Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ Î´Î·Î¼Î¿ÏƒÎ¹ÎµÏÏ„Î·ÎºÎµ!'); }

        function applyStaticImages() {
            for (const [id, url] of Object.entries(staticImages)) {
                // Prefer exact id match; fallback to data-id match (useful when an element must keep a different semantic id).
                const el = document.getElementById(id) || document.querySelector(`[data-id="${id}"]`);
                if (el) {
                    if (id.endsWith('-bg') || el.classList.contains('admin-editable-bg')) {
                        el.style.backgroundImage = `url('${url}')`;
                    } else {
                        el.src = url;
                    }
                }
            }
        }

        // --- SERVER SYNC (public) ---
        // Pull the latest content saved from the admin panel so everyone sees the same site.
        async function loadPublicFromServer() {
            try {
                const r = await fetch('/api/site');
                const j = await r.json();
                if (j?.ok && j?.data) {
                    const d = j.data;
                    if (Array.isArray(d.products)) products = d.products;
                    if (Array.isArray(d.blogPosts)) blogPosts = d.blogPosts;
                    if (d.staticImages && typeof d.staticImages === 'object') staticImages = d.staticImages;
                    if (d.globalTexts && typeof d.globalTexts === 'object') globalTexts = d.globalTexts;
                    if (d.globalGraphics && typeof d.globalGraphics === 'object') globalGraphics = d.globalGraphics;
                    if (typeof d.isMaintenance === 'boolean') isMaintenance = d.isMaintenance;
                }
            } catch (e) {
                console.warn('Public server sync failed:', e);
            }
        }

        window.onload = async function() {
            await loadPublicFromServer();
            applyStaticImages();
            applyGlobalSettings();
            try { renderProducts(); } catch(e) {}
            try { renderBlogList(); } catch(e) {}
            initDragAndDrop();
            initEmptyLinks();
            
            // Check Maintenance First
            checkMaintenance();

            // Then check view state if maintenance is not blocking (or if admin)
            const lastView = localStorage.getItem('vitro_active_view');
            
            // If in maintenance and not admin, force maintenance view regardless of stored view
            if (isMaintenance && !isAdmin) {
                // checkMaintenance already handles hiding views and showing maintenance
            } else {
                if (lastView) {
                    if (lastView === 'view-admin-dashboard' && isAdmin) showAdminDashboard(null);
                    else if (lastView === 'view-catalog') showCatalog(null);
                    else if (lastView === 'view-blog') showBlog(null);
                    else showLanding(false);
                } else showLanding();
            }
            
            checkWeeklyAI();
            updatePromoText(); // Initial check for promo text
        };
    </script>
</body>
</html>
